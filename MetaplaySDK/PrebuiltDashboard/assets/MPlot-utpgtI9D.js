import{cQ as K,cR as x,cS as rt,cT as st,cU as ht,cV as ot,cW as ct,cX as q,cY as mt,cZ as yt,c_ as gt,c$ as vt,d0 as xt,d1 as wt,d2 as V,d3 as _t,d4 as bt,d5 as at,d6 as M,d7 as C,d8 as At,d9 as it,da as k,db as O,dc as kt,dd as T,de as Mt,df as Ct,dg as Ot,dh as St,di as Et,dj as It,dk as G,dl as $t,dm as jt,dn as zt,dp as Ft,dq as Tt,dr as H,ds as Xt,dt as N,du as Q,d as Rt,f as j,h as z,bf as Z,c as F,dv as J,C as Y,o as Ut,a as Bt,_ as Dt}from"./index-B7jvAjdE.js";function Lt(r,t){var n=0;return Float64Array.from(r,e=>n+=+e||0)}function X(r,t,n){return(t.length!==2?K(rt(r,t,n),([e,s],[o,c])=>x(s,c)||x(e,o)):K(st(r,n),([e,s],[o,c])=>t(s,c)||x(e,o))).map(([e])=>e)}function ut(r,t=x){let n,e=!1;if(t.length===1){let s;for(const o of r){const c=t(o);(e?x(c,s)>0:x(c,c)===0)&&(n=o,s=c,e=!0)}}else for(const s of r)(e?t(s,n)>0:t(s,s)===0)&&(n=s,e=!0);return n}function Pt(r={}){return ht(r)?r:{...r,y:ot}}function Wt(r,t){if(t.length===1)return{data:r,facets:t};const n=ct(r),e=new Uint8Array(n);let s=0;for(const a of t)for(const i of a)e[i]&&++s,e[i]=1;if(s===0)return{data:r,facets:t};r=q(r);const o=r[mt]=new Uint32Array(n+s);t=t.map(a=>q(a,Uint32Array));let c=n;e.fill(0);for(const a of t)for(let i=0,u=a.length;i<u;++i){const d=a[i];e[d]?(a[i]=c,r[c]=r[d],o[c]=d,++c):o[d]=d,e[d]=1}return{data:r,facets:t}}function Kt(r={},t={}){arguments.length===1&&([r,t]=Vt(r));const{x1:n,x:e=n,y:s,...o}=t,[c,a,i,u]=Ht(e,s,"x","y",r,o);return{...c,x1:n,x:a,y1:i,y2:u,y:vt(i,u)}}function qt({y:r,y1:t,y2:n,...e}={}){return e=yt(e,"x"),t===void 0&&n===void 0?Kt({y:r,...e}):([t,n]=gt(r,t,n),{...e,y1:t,y2:n})}function Vt(r){const{offset:t,order:n,reverse:e,...s}=r;return[{offset:t,order:n,reverse:e},s]}const Gt={length:!0};function Ht(r,t=bt,n,e,{offset:s,order:o,reverse:c},a){if(t===null)throw new Error(`stack requires ${e}`);const i=xt(a),[u,d]=wt(r),[f,h]=V(t),[l,m]=V(t);return f.hint=l.hint=Gt,s=Nt(s),o=Jt(o,s,e),[_t(a,(p,g,w)=>{({data:p,facets:g}=Wt(p,g));const E=r==null?void 0:d(kt(k(p,r),w?.[n])),R=k(p,t,Float64Array),U=k(p,i),B=o&&o(p,E,R,U),D=ct(p),_=h(new Float64Array(D)),b=m(new Float64Array(D)),L=[];for(const P of g){const I=E?Array.from(st(P,v=>E[v]).values()):[P];if(B)for(const v of I)v.sort(B);for(const v of I){let W=0,$=0;c&&v.reverse();for(const y of v){const A=R[y];A<0?W=b[y]=(_[y]=W)+A:A>0?$=b[y]=(_[y]=$)+A:b[y]=_[y]=$}}L.push(I)}return s&&s(L,_,b,U),{data:p,facets:g}}),u,f,l]}function Nt(r){if(r!=null){if(typeof r=="function")return r;switch(`${r}`.toLowerCase()){case"expand":case"normalize":return Qt;case"center":case"silhouette":return Zt;case"wiggle":return lt}throw new Error(`unknown offset: ${r}`)}}function ft(r,t){let n=0,e=0;for(const s of r){const o=t[s];o<n&&(n=o),o>e&&(e=o)}return[n,e]}function Qt(r,t,n){for(const e of r)for(const s of e){const[o,c]=ft(s,n);for(const a of s){const i=1/(c-o||1);t[a]=i*(t[a]-o),n[a]=i*(n[a]-o)}}}function Zt(r,t,n){for(const e of r){for(const s of e){const[o,c]=ft(s,n);for(const a of s){const i=(c+o)/2;t[a]-=i,n[a]-=i}}dt(e,t,n)}pt(r,t,n)}function lt(r,t,n,e){for(const s of r){const o=new at;let c=0;for(const a of s){let i=-1;const u=a.map(l=>Math.abs(n[l]-t[l])),d=a.map(l=>{i=e?e[l]:++i;const m=n[l]-t[l],p=o.has(i)?m-o.get(i):0;return o.set(i,m),p}),f=[0,...Lt(d)];for(const l of a)t[l]+=c,n[l]+=c;const h=M(u);h&&(c-=M(u,(l,m)=>(d[m]/2+f[m])*l)/h)}dt(s,t,n)}pt(r,t,n)}function dt(r,t,n){const e=C(r,s=>C(s,o=>t[o]));for(const s of r)for(const o of s)t[o]-=e,n[o]-=e}function pt(r,t,n){const e=r.length;if(e===1)return;const s=r.map(a=>a.flat()),o=s.map(a=>(C(a,i=>t[i])+At(a,i=>n[i]))/2),c=C(o);for(let a=0;a<e;a++){const i=c-o[a];for(const u of s[a])t[u]+=i,n[u]+=i}}function Jt(r,t,n){if(r===void 0&&t===lt)return tt(O);if(r!=null){if(typeof r=="string"){const e=r.startsWith("-"),s=e?Mt:O;switch((e?r.slice(1):r).toLowerCase()){case"value":case n:return Yt(s);case"z":return te(s);case"sum":return ee(s);case"appearance":return ne(s);case"inside-out":return tt(s)}return et(Ct(r))}if(typeof r=="function")return(r.length===1?et:re)(r);if(it(r))return se(r);throw new Error(`invalid order: ${r}`)}}function Yt(r){return(t,n,e)=>(s,o)=>r(e[s],e[o])}function te(r){return(t,n,e,s)=>(o,c)=>r(s[o],s[c])}function ee(r){return S(r,(t,n,e,s)=>X(T(t),o=>M(o,c=>e[c]),o=>s[o]))}function ne(r){return S(r,(t,n,e,s)=>X(T(t),o=>n[ut(o,c=>e[c])],o=>s[o]))}function tt(r){return S(r,(t,n,e,s)=>{const o=T(t),c=X(o,f=>n[ut(f,h=>e[h])],f=>s[f]),a=rt(o,f=>M(f,h=>e[h]),f=>s[f]),i=[],u=[];let d=0;for(const f of c)d<0?(d+=a.get(f),i.push(f)):(d-=a.get(f),u.push(f));return u.reverse().concat(i)})}function et(r){return t=>{const n=k(t,r);return(e,s)=>O(n[e],n[s])}}function re(r){return t=>it(t)?(n,e)=>r(t[n],t[e]):(n,e)=>r(t.get(n),t.get(e))}function se(r){return S(O,()=>r)}function S(r,t){return(n,e,s,o)=>{if(!o)throw new Error("missing channel: z");const c=new at(t(n,e,s,o).map((a,i)=>[a,i]));return(a,i)=>r(c.get(o[a]),c.get(o[i]))}}const oe={ariaLabel:"bar"};class ce extends $t{constructor(t,n,e={},s=oe){super(t,n,e,s),jt(this,e),zt(this,e)}render(t,n,e,s,o){const{rx:c,ry:a,rx1y1:i,rx1y2:u,rx2y1:d,rx2y2:f}=this,h=this._x(n,e,s),l=this._y(n,e,s),m=this._width(n,e,s),p=this._height(n,e,s);return Ft("svg:g",o).call(Tt,this,s,o).call(this._transform,this,n).call(g=>g.selectAll().data(t).enter().call(i||u||d||f?w=>w.append("path").call(H,this).call(Xt,h,l,nt(h,m),nt(l,p),this).call(N,this,e):w=>w.append("rect").call(H,this).attr("x",h).attr("width",m).attr("y",l).attr("height",p).call(Q,"rx",c).call(Q,"ry",a).call(N,this,e))).node()}_x(t,{x:n},{marginLeft:e}){const{insetLeft:s}=this;return n?o=>n[o]+s:e+s}_y(t,{y:n},{marginTop:e}){const{insetTop:s}=this;return n?o=>n[o]+s:e+s}_width({x:t},{x:n},{marginRight:e,marginLeft:s,width:o}){const{insetLeft:c,insetRight:a}=this,i=n&&t?t.bandwidth():o-e-s;return Math.max(0,i-c-a)}_height({y:t},{y:n},{marginTop:e,marginBottom:s,height:o}){const{insetTop:c,insetBottom:a}=this,i=n&&t?t.bandwidth():o-e-s;return Math.max(0,i-c-a)}}function nt(r,t){return typeof r=="function"&&typeof t=="function"?n=>r(n)+t(n):typeof r=="function"?n=>r(n)+t:typeof t=="function"?n=>r+t(n):r+t}class ae extends ce{constructor(t,n={},e){const{x:s,y1:o,y2:c}=n;super(t,{y1:{value:o,scale:"y"},y2:{value:c,scale:"y"},x:{value:s,scale:"x",type:"band",optional:!0}},n,e)}_transform(t,n,{y:e}){t.call(It,n,{y:e},0,0)}_y({y:t},{y1:n,y2:e},{marginTop:s}){const{insetTop:o}=this;return G(t)?s+o:c=>Math.min(n[c],e[c])+o}_height({y:t},{y1:n,y2:e},{marginTop:s,marginBottom:o,height:c}){const{insetTop:a,insetBottom:i}=this;return G(t)?c-s-o-a-i:u=>Math.max(0,Math.abs(e[u]-n[u])-a-i)}}function de(r,t={}){return Ot(t)||(t={...t,x:St,y2:ot}),new ae(r,qt(Et(Pt(t))))}const ie=Rt({__name:"MPlot",props:{options:{}},setup(r,{expose:t}){t();const n=r,e=j(),s=j();let o;z(()=>{e.value&&(s.value=e.value.clientWidth,o=new ResizeObserver(()=>{s.value=e.value?.clientWidth}),o.observe(e.value))}),Z(()=>{o&&o.disconnect()});const c=F(()=>{const u={};return u.width=s.value,u.style={fill:"#737373",fontFamily:'ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'},{...u,...n.options}}),a=F(()=>J(c.value));Y(a,u=>{e.value&&(e.value.innerHTML="",e.value.append(u))}),z(()=>{e.value?.append(a.value)});const i={props:n,container:e,width:s,get resizeObserver(){return o},set resizeObserver(u){o=u},modifiedOptions:c,renderedPlot:a,computed:F,onMounted:z,onUnmounted:Z,ref:j,watch:Y,get plot(){return J}};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}}),ue={ref:"container"};function fe(r,t,n,e,s,o){return Ut(),Bt("div",ue,null,512)}const pe=Dt(ie,[["render",fe],["__file","MPlot.vue"]]);export{pe as M,de as b};
