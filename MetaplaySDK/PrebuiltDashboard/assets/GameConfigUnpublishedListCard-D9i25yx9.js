import{d as E,aj as B,c as A,x as w,ad as G,M as I,v as N,a8 as R,a9 as T,b as x,o as r,e as g,w as a,k as s,p as o,l,a as u,n as p,t as b,_ as U}from"./index-B7jvAjdE.js";import{M as c,a as m,c as d,b as y}from"./metaListUtils-B-xQ0HnD.js";import{G as V}from"./GameConfigActionArchive-Bt_4NQ2E.js";import{G as K}from"./GameConfigActionPublish-R7B0H1nr.js";import{g as C}from"./gameConfigs-DlpfRS5r.js";import"./MActionModal-coQLkvWs.js";import"./index-fVjXqxSF.js";import"./MInputSwitch-C-Z-JJsG.js";import"./index-B_QkKjtG.js";const W=1,j=E({__name:"GameConfigUnpublishedListCard",setup(O,{expose:n}){n();const L=G(),t=B(),v=A(()=>t.path),{data:f}=w(C()),S=A(()=>{if(f.value!==void 0)return f.value.filter(i=>!(i.publishedAt!==null||i.unpublishedAt!==null||i.isActive))});function _(i){const M=v.value,P=M.endsWith("/")?"":"/";return M+P+i}function e(i){return i.id}const k=[new c("Build Time","buildStartedAt",m.Ascending),new c("Build Time","buildStartedAt",m.Descending),new c("Name","name",m.Ascending),new c("Name","name",m.Descending)],F=["id","name","description"],D=[new y("status",[new d("Building",i=>i.bestEffortStatus==="Building"),new d("Success",i=>i.bestEffortStatus==="Success"),new d("Failed",i=>i.bestEffortStatus==="Failed")]),new y("archived",[new d("Archived",i=>i.isArchived),new d("Not archived",i=>!i.isArchived,!0)])],h={gameServerApi:L,route:t,detailsRoute:v,allGameConfigsDataRaw:f,allGameConfigsData:S,getDetailPagePath:_,getItemKey:e,defaultSortOption:W,sortOptions:k,searchFields:F,filterSets:D,computed:A,get useRoute(){return B},get useGameServerApi(){return G},get MetaListFilterOption(){return d},get MetaListFilterSet(){return y},get MetaListSortDirection(){return m},get MetaListSortOption(){return c},get MBadge(){return I},get MListItem(){return N},get MTextButton(){return R},get maybePluralString(){return T},get useSubscription(){return w},GameConfigActionArchive:V,GameConfigActionPublish:K,get getAllGameConfigsSubscriptionOptions(){return C}};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}}),q={key:0,class:"tw-space-x-1"},z={key:1},H={key:0,class:"tw-text-red-500"},J={key:1,class:"tw-text-orange-500"},Q={key:0};function X(O,n,L,t,v,f){const S=x("meta-time"),_=x("meta-list-card");return r(),g(_,{title:"Unpublished Configs",itemList:t.allGameConfigsData,getItemKey:t.getItemKey,searchFields:t.searchFields,filterSets:t.filterSets,sortOptions:t.sortOptions,defaultSortOption:t.defaultSortOption,icon:"table","data-testid":"game-config-unpublished-list-card"},{"item-card":a(({item:e})=>[s(t.MListItem,null,{badge:a(()=>[e.isActive?(r(),g(t.MBadge,{key:0,variant:"success"},{default:a(()=>n[0]||(n[0]=[o("Active")]),void 0,!0),_:1})):l("",!0),e.isArchived?(r(),g(t.MBadge,{key:1,variant:"neutral"},{default:a(()=>n[1]||(n[1]=[o("Archived")]),void 0,!0),_:1})):l("",!0),e.bestEffortStatus==="Failed"?(r(),g(t.MBadge,{key:2,variant:"danger"},{default:a(()=>n[2]||(n[2]=[o("Failed")]),void 0,!0),_:1})):l("",!0)]),"top-right":a(()=>[e.bestEffortStatus!=="Building"?(r(),u("div",q,[p("span",null,[n[3]||(n[3]=o("Built ")),s(S,{date:e.buildStartedAt},null,8,["date"])]),s(t.GameConfigActionArchive,{gameConfigId:e.id,"trigger-style":"icon"},null,8,["gameConfigId"])])):(r(),u("div",z,[s(t.MBadge,{variant:"primary"},{default:a(()=>n[4]||(n[4]=[o("Building...")]),void 0,!0),_:1})]))]),"bottom-left":a(()=>[e.buildReportSummary?.totalLogLevelCounts.Error?(r(),u("div",H,b(t.maybePluralString(e.buildReportSummary.totalLogLevelCounts.Error,"build error")),1)):e.buildReportSummary?.totalLogLevelCounts.Warning?(r(),u("div",J,b(t.maybePluralString(e.buildReportSummary.totalLogLevelCounts.Warning,"build warning")),1)):l("",!0),p("div",null,b(e.description||"No description available"),1)]),"bottom-right":a(()=>[e.bestEffortStatus!=="Building"?(r(),u("span",Q,[p("div",null,[s(t.MTextButton,{to:`gameConfigs/diff?newRoot=${e.id}`,"disabled-tooltip":e.bestEffortStatus==="Failed"?"Unable to diff because this game config failed to build.":void 0,"data-testid":"diff-config"},{default:a(()=>n[5]||(n[5]=[o("Diff to active")]),void 0,!0),_:2},1032,["to","disabled-tooltip"])]),p("div",null,[s(t.MTextButton,{to:t.getDetailPagePath(e.id),"data-testid":"view-config"},{default:a(()=>n[6]||(n[6]=[o("View config")]),void 0,!0),_:2},1032,["to"])]),s(t.GameConfigActionPublish,{gameConfigId:e.id,"text-button":""},null,8,["gameConfigId"])])):l("",!0)]),default:a(()=>[o(b(e.name||"No name available"),1)],void 0,!0),_:2},1024)]),_:1},8,["itemList"])}const ot=U(j,[["render",X],["__file","GameConfigUnpublishedListCard.vue"]]);export{ot as default};
