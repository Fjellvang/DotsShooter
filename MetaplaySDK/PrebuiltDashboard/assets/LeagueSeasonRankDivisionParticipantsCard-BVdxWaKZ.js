import{d as Y,aj as A,x,al as O,f as D,c as L,ad as B,M as J,q as Q,bN as W,v as X,L as Z,a8 as $,ae as F,dz as ee,b as u,o,e as y,w as n,k as r,l as b,n as m,p as l,t as S,a as s,F as te,r as ie,m as ae,_ as ne}from"./index-B7jvAjdE.js";import{M as oe}from"./MActionModal-coQLkvWs.js";import{M as f,a as g,c as R,b as V}from"./metaListUtils-B-xQ0HnD.js";import{c as E}from"./leagues-DnPkib1L.js";import"./index-fVjXqxSF.js";const re=Y({__name:"LeagueSeasonRankDivisionParticipantsCard",props:{divisionId:{}},setup(I,{expose:a}){a();const P=A(),e=B(),h=I,{data:d,refresh:p}=x(E(h.divisionId)),_=O(P.params.leagueId),v=D(),w=D(),C=L(()=>d.value?Object.values(d.value.model.participants).sort((H,U)=>H.sortOrderIndex-U.sortOrderIndex):[]),M=L(()=>d.value?!d.value.model.isConcluded:!1);function i(t){return t.playerAvatar.displayName}const{showSuccessNotification:c,showErrorNotification:N}=F();function j(t){v.value=t,w.value?.open(t)}async function K(){const t=await e.post(`/leagues/${_}/participant/${v.value.participantId}/remove`);t.data.success?c("Participant successfully removed from division."):N(t.data.errorMessage),p()}function T(t){return t!=="None"}function G(t){return M.value?T(t)?void 0:"This is a placeholder player that cannot be removed.":"Cannot remove participant since season has concluded."}const q=[new f("Position","sortOrderIndex",g.Ascending),new f("Position","sortOrderIndex",g.Descending),new f("Name","playerAvatar.displayName",g.Ascending),new f("Name","playerAvatar.displayName",g.Descending)],z=[new V("resolvedDivisionRewards",[new R("Reward claimed",t=>t.resolvedDivisionRewards?.isClaimed===!0,!1),new R("Reward unclaimed",t=>t.resolvedDivisionRewards?.isClaimed===!1,!1),new R("Reward not received",t=>t.resolvedDivisionRewards===null,!1)])],k={route:P,gameServerApi:e,props:h,singleDivisionData:d,singleDivisionRefresh:p,leagueId:_,participantToRemove:v,removeParticipantModal:w,participants:C,isCurrentSeason:M,getItemKey:i,showSuccessNotification:c,showErrorNotification:N,onRemoveParticipantClick:j,removeParticipant:K,isRealParticipant:T,deleteButtonTooltipContent:G,sortOptions:q,filterSets:z,computed:L,ref:D,get useRoute(){return A},get useGameServerApi(){return B},get MetaListFilterOption(){return R},get MetaListFilterSet(){return V},get MetaListSortDirection(){return g},get MetaListSortOption(){return f},get MActionModal(){return oe},get MBadge(){return J},get MCollapse(){return Q},get MIconButton(){return W},get MListItem(){return X},get MTooltip(){return Z},get MTextButton(){return $},get useNotifications(){return F},get useSubscription(){return x},get isEpochTime(){return ee},get routeParamToSingleValue(){return O},get getSingleDivisionSubscriptionOptions(){return E}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),se={class:"tw-space-x-1"},le={key:1,class:"tw-ml-1"},de={key:0},ce={key:0},ue={key:1},me={key:0},pe={key:1},ve={class:"code-box border rounded bg-light"};function fe(I,a,P,e,h,d){const p=u("fa-icon"),_=u("meta-ordinal-number"),v=u("meta-time"),w=u("meta-reward-badge"),C=u("meta-no-seatbelts"),M=u("meta-list-card");return o(),y(M,ae(I.$attrs,{title:"All Participants",icon:"users",itemList:e.participants,getItemKey:e.getItemKey,searchFields:["playerAvatar.displayName"],sortOptions:e.sortOptions,filterSets:e.filterSets}),{"item-card":n(({item:i})=>[r(e.MCollapse,{extraMListItemMargin:""},{header:n(()=>[r(e.MListItem,{noLeftPadding:""},{badge:n(()=>[e.isRealParticipant(i.participantId)?b("",!0):(o(),y(e.MTooltip,{key:0,content:"Placeholder player that will get automatically deleted once a real player joins.",noUnderline:""},{default:n(()=>[r(p,{icon:"robot"})],void 0,!0),_:1}))]),"top-right":n(()=>[m("div",se,[a[1]||(a[1]=l("Position: ")),r(_,{number:i.sortOrderIndex+1},null,8,["number"]),r(e.MIconButton,{permission:"api.leagues.participant_edit","disabled-tooltip":e.deleteButtonTooltipContent(i.participantId),variant:"danger","aria-label":"Remove this participant.",onClick:c=>e.onRemoveParticipantClick(i)},{default:n(()=>[r(p,{icon:"trash-alt"})],void 0,!0),_:2},1032,["disabled-tooltip","onClick"])])]),"bottom-left":n(()=>[m("div",null,S(i.participantInfo),1),m("div",null,[a[2]||(a[2]=l("Last action:")),e.isEpochTime(i.divisionScore.lastActionAt)?(o(),s("span",le,"No actions")):(o(),y(v,{key:0,class:"tw-ml-1",date:i.divisionScore.lastActionAt},null,8,["date"]))]),e.isCurrentSeason?b("",!0):(o(),s("div",de,[i.resolvedDivisionRewards?i.resolvedDivisionRewards?(o(),s("div",ue,[(o(!0),s(te,null,ie(i.resolvedDivisionRewards.rewards,c=>(o(),s("div",null,[r(w,{reward:c},null,8,["reward"])]))),256)),i.resolvedDivisionRewards.isClaimed?(o(),s("span",me,"Reward claimed")):(o(),s("span",pe,"Reward unclaimed"))])):b("",!0):(o(),s("div",ce,a[3]||(a[3]=[m("span",null,"No reward received.",-1)])))]))]),"bottom-right":n(()=>[e.isRealParticipant(i.participantId)?(o(),y(e.MTextButton,{key:0,to:`/players/${i.participantId}`,permission:"api.players.view","data-testid":"view-participant"},{default:n(()=>a[4]||(a[4]=[l("View participant")]),void 0,!0),_:2},1032,["to"])):b("",!0)]),default:n(()=>[l(S(i.playerAvatar.displayName),1)],void 0,!0),_:2},1024)]),default:n(()=>[m("pre",ve,S(i),1)],void 0,!0),_:2},1024),r(e.MActionModal,{ref:"removeParticipantModal",title:"Remove Participant",action:e.removeParticipant,onHidden:a[0]||(a[0]=c=>e.participantToRemove=void 0)},{default:n(()=>[m("p",null,[a[5]||(a[5]=l("You are about to remove ")),r(e.MBadge,null,{default:n(()=>[l(S(e.participantToRemove.playerAvatar.displayName),1)],void 0,!0),_:1}),a[6]||(a[6]=l(" from the division."))]),r(C,{message:" The participant will lose all their progress in the league, and will have to start again from scratch. This action can't be undone.",name:e.participantToRemove.playerAvatar.displayName},null,8,["name"])],void 0,!0),_:1},512)]),_:1},16,["itemList"])}const be=ne(re,[["render",fe],["__file","LeagueSeasonRankDivisionParticipantsCard.vue"]]);export{be as default};
