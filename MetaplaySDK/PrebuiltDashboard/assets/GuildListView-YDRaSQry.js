import{d as V,aa as M,x as A,c as G,ab as S,f as x,a0 as I,ac as E,dz as R,b as a,o as n,e as _,w as l,k as s,n as v,p as L,a as r,t as w,l as T,_ as F}from"./index-B7jvAjdE.js";import{M as B}from"./MSingleColumnLayout-B4K0ZAFA.js";import{a as O}from"./MViewContainer-BTeE2xDT.js";import{a as D}from"./guilds-LGK3Q8Wf.js";const P=V({__name:"GuildListView",setup(N,{expose:o}){o();const k=M(),{data:e,error:C}=A(D()),h=G(()=>{const t=[{key:"entityId",label:"ID"},{key:"displayName",label:"Name"},{key:"numMembers",label:"Members"},{key:"lastLoginAt",label:"Last Active"}];return Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)<576?c(t,["entityId","displayName"]):t});function c(t,i){return t.filter(b=>{let g;return typeof b=="string"?g=b:g=b.key,i.includes(g)})}const d=S(),u=x();async function p(t){u.value=t,await d.push(`/guilds/${t.entityId}`)}async function f(t){await d.push(`/guilds/${t.entityId}`)}function y(t,i){if(!(!t||i!=="row"))return t.phase==="Closed"?"text-danger table-row-link":"table-row-link"}const m={uiStore:k,allActiveGuildsData:e,allActiveGuildsError:C,tableFields:h,filterTableFields:c,router:d,selectedGuild:u,onGuildSelected:p,rowClicked:f,rowClass:y,computed:G,ref:x,get useRouter(){return S},get useUiStore(){return M},get MCallout(){return I},get MCard(){return E},get MSingleColumnLayout(){return B},get MViewContainer(){return O},get useSubscription(){return A},get isEpochTime(){return R},get getActiveGuildsSubscriptionOptions(){return D}};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}}),U={class:"tw-mb-1 tw-ml-2","data-testid":"guild-search"},j={key:0},W={key:0,class:"pt-5 tw-w-full tw-text-center"},z={key:1},q={key:0},H={key:1},J={key:1};function K(N,o,k,e,C,h){const c=a("fa-icon"),d=a("meta-input-guild-select"),u=a("b-col"),p=a("b-row"),f=a("b-spinner"),y=a("meta-time"),m=a("b-table"),t=a("MetaRawData");return n(),_(e.MViewContainer,{"is-loading":!e.allActiveGuildsData,error:e.allActiveGuildsError},{default:l(()=>[s(p,{class:"justify-content-center",style:{"margin-top":"8rem","margin-bottom":"7rem"}},{default:l(()=>[s(u,{md:"10",lg:"7",xl:"5"},{default:l(()=>[v("h4",U,[s(c,{icon:"search"}),o[0]||(o[0]=L(" Find a guild"))]),s(d,{value:e.selectedGuild,onInput:e.onGuildSelected},null,8,["value"])],void 0,!0),_:1})],void 0,!0),_:1}),e.uiStore.showDeveloperUi?(n(),r("div",j,[e.allActiveGuildsData?(n(),r("div",z,[s(e.MSingleColumnLayout,null,{default:l(()=>[s(e.MCard,{title:"Recently Active Guilds","data-testid":"active-guilds-list"},{default:l(()=>[e.allActiveGuildsData.length===0?(n(),_(e.MCallout,{key:0,title:"No recently active guilds",variant:"neutral"},{default:l(()=>o[1]||(o[1]=[L("No guilds have been active since last server reboot.")]),void 0,!0),_:1})):(n(),_(m,{key:1,class:"table-fixed-column",small:"",striped:"",hover:"",responsive:"",items:e.allActiveGuildsData,fields:e.tableFields,"primary-key":"entityId","sort-by":"startAt","sort-desc":"","tbody-tr-class":e.rowClass,onRowClicked:e.rowClicked},{"cell(entityId)":l(i=>[v("span",null,w(i.item.entityId),1)]),"cell(displayName)":l(i=>[i.item.phase==="Closed"?(n(),r("span",q,"☠️")):(n(),r("span",H,w(i.item.displayName),1))]),"cell(numMembers)":l(i=>[v("span",null,w(i.item.numMembers),1)]),"cell(lastLoginAt)":l(i=>[e.isEpochTime(i.item.lastLoginAt)?(n(),r("span",J,"Closed")):(n(),_(y,{key:0,date:i.item.lastLoginAt,disableTooltip:"",showAs:"timeagoSentenceCase"},null,8,["date"]))]),_:1},8,["items","fields"]))],void 0,!0),_:1})],void 0,!0),_:1})])):(n(),r("div",W,[s(f,{class:"mt-5",label:"Loading..."})]))])):T("",!0),s(t,{kvPair:e.allActiveGuildsData,name:"allActiveGuilds"},null,8,["kvPair"])],void 0,!0),_:1},8,["is-loading","error"])}const $=F(P,[["render",K],["__file","GuildListView.vue"]]);export{$ as default};
