import{d as k,aj as h,f as C,c as u,M,al as g,b as d,o as f,e as v,w as t,k as r,n as S,p as s,t as T,a as V,l as _,_ as P}from"./index-B7jvAjdE.js";import{M as x,a as I}from"./MViewContainer-BTeE2xDT.js";import A from"./EntityEventLogCard-C6zvgJwz.js";import"./MetaEventStreamCard-D_xDm3jw.js";import"./MInputMultiSelectCheckbox-D_9f7ub1.js";import"./MInputCheckbox-BqateWtE.js";import"./index-B_QkKjtG.js";import"./MInputHintMessage-DbuBS4Kn.js";import"./MInputSingleSelectSwitch-CuptGC6e.js";import"./index-CDBqmjrS.js";import"./MInputSimpleSelectDropdown-DIlBEFcs.js";import"./index-qTA83-by.js";import"./MInputText-CzhsT8yb.js";import"./debounce-B8gTqdZO.js";import"./isSymbol-B7ZrWRtH.js";import"./apiPoller-8-xtB3Lu.js";import"./analyticsEvents-CRLHbRhO.js";import"./keyBy-D62UaquR.js";import"./_baseEach-BTXG47Wn.js";import"./_baseIteratee-BXhw53re.js";import"./toString-DMHXP3G8.js";import"./identity-DKeuBCMA.js";const F=k({__name:"EntityEventLogView",setup(E,{expose:n}){n();const a=h(),e=C(null),w=u(()=>g(a.params.type)),b=u(()=>g(a.params.id)),c=u(()=>a.query.search??""),o=u(()=>{if(a.query.keywords){const i=a.query.keywords;if(typeof i=="string")return decodeURIComponent(i).split(",");if(Array.isArray(i))return i.map(m=>decodeURIComponent(String(m)))}return[]}),l=u(()=>{if(a.query.eventTypes){const i=a.query.eventTypes;if(typeof i=="string")return decodeURIComponent(i).split(",");if(Array.isArray(i))return i.map(m=>decodeURIComponent(String(m)))}return[]});function p(i){e.value=i}const y={route:a,eventStreamStats:e,entityType:w,entityId:b,initialSearchString:c,keywordFilters:o,eventTypeFilters:l,onStats:p,computed:u,ref:C,get useRoute(){return h},get MBadge(){return M},get MPageOverviewCard(){return x},get MViewContainer(){return I},EntityEventLogCard:A,get routeParamToSingleValue(){return g}};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),q={key:0},B={class:"tw-mb-1 tw-font-bold"};function R(E,n,a,e,w,b){const c=d("fa-icon"),o=d("b-td"),l=d("b-tr"),p=d("meta-time"),y=d("meta-duration"),i=d("b-tbody"),m=d("b-table-simple");return f(),v(e.MViewContainer,null,{overview:t(()=>[r(e.MPageOverviewCard,{title:e.entityType+" Event Timeline",id:e.entityId,"data-testid":"overview"},{subtitle:t(()=>[S("p",null,[n[0]||(n[0]=s("A timeline of most recent events for ")),r(e.MBadge,null,{default:t(()=>[s(T(e.entityId),1)],void 0,!0),_:1}),n[1]||(n[1]=s("."))]),n[2]||(n[2]=S("p",null,"The amount of cached events on this page is limited to keep the database impact small. The full history of events has been sent to your analytics pipeline!",-1))]),default:t(()=>[e.eventStreamStats?(f(),V("div",q,[S("div",B,[r(c,{icon:"chart-line"}),n[3]||(n[3]=s(" Statistics"))]),r(m,{small:"",responsive:""},{default:t(()=>[r(i,null,{default:t(()=>[r(l,null,{default:t(()=>[r(o,null,{default:t(()=>n[4]||(n[4]=[s("Total events")]),void 0,!0),_:1}),r(o,{class:"tw-text-right"},{default:t(()=>[s(T(e.eventStreamStats.numEvents),1)],void 0,!0),_:1})],void 0,!0),_:1}),e.eventStreamStats.newestEventTime?(f(),v(l,{key:0},{default:t(()=>[r(o,null,{default:t(()=>n[5]||(n[5]=[s("Most recent event")]),void 0,!0),_:1}),r(o,{class:"tw-text-right"},{default:t(()=>[r(p,{date:e.eventStreamStats.newestEventTime,showAs:"timeagoSentenceCase"},null,8,["date"])],void 0,!0),_:1})],void 0,!0),_:1})):_("",!0),e.eventStreamStats.oldestEventTime?(f(),v(l,{key:1},{default:t(()=>[r(o,null,{default:t(()=>n[6]||(n[6]=[s("Oldest event")]),void 0,!0),_:1}),r(o,{class:"tw-text-right"},{default:t(()=>[r(p,{date:e.eventStreamStats.oldestEventTime,showAs:"timeagoSentenceCase"},null,8,["date"])],void 0,!0),_:1})],void 0,!0),_:1})):_("",!0),e.eventStreamStats.duration?(f(),v(l,{key:2},{default:t(()=>[r(o,null,{default:t(()=>n[7]||(n[7]=[s("Range of events")]),void 0,!0),_:1}),r(o,{class:"tw-text-right"},{default:t(()=>[r(y,{duration:e.eventStreamStats.duration,showAs:"humanizedSentenceCase"},null,8,["duration"])],void 0,!0),_:1})],void 0,!0),_:1})):_("",!0)],void 0,!0),_:1})],void 0,!0),_:1})])):_("",!0)],void 0,!0),_:1},8,["title","id"])]),default:t(()=>[r(e.EntityEventLogCard,{class:"h-100",entityKind:e.entityType,entityId:e.entityId,searchPreHighlight:String(e.initialSearchString),keywordPreFilters:e.keywordFilters,eventTypePreFilters:e.eventTypeFilters,utilitiesMode:"highlight",utilitiesCondition:"or",showViewMoreLink:!1,maxHeight:"inherit",onStats:e.onStats},null,8,["entityKind","entityId","searchPreHighlight","keywordPreFilters","eventTypePreFilters"])],void 0,!0),_:1})}const oe=P(F,[["render",R],["__file","EntityEventLogView.vue"]]);export{oe as default};
