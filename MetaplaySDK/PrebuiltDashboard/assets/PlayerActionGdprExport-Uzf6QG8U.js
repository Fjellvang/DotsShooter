import{d as k,x as y,f as x,c as _,ad as h,M,a0 as A,bn as v,b as w,o as l,a as p,k as o,w as n,n as a,t as f,p as s,e as P,l as B,_ as E}from"./index-B7jvAjdE.js";import{M as O}from"./MActionModalButton-CvWVuTB-.js";import{r as D}from"./utils-Dwlepb3M.js";import{a as S}from"./players-CydHenLG.js";import"./MActionModal-coQLkvWs.js";import"./index-fVjXqxSF.js";const z=3e5,C=k({__name:"PlayerActionGdprExport",props:{playerId:{}},setup(g,{expose:t}){t();const u=g,e=h(),{data:d}=y(S(u.playerId)),i=x(),r=_(()=>D(i.value));async function c(){i.value=void 0,i.value=(await e.get(`/players/${d.value.id}/gdprExport`)).data}async function m(){v(i.value,d.value.id)}const b={props:u,gameServerApi:e,playerData:d,exportData:i,exportSize:r,sizeLimit:z,fetchData:c,downloadData:m,computed:_,ref:x,get useGameServerApi(){return h},get roughSizeOfObject(){return D},get MActionModalButton(){return O},get MBadge(){return M},get MCallout(){return A},get useSubscription(){return y},get downloadDataAsJson(){return v},get getSinglePlayerSubscriptionOptions(){return S}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),G={key:0},I={class:"tw-mb-1"},N={key:0},V={class:"code-box tw-h-[10rem] tw-rounded-md tw-border tw-border-neutral-200 tw-bg-neutral-100 tw-text-neutral-600"},Y={key:0,"data-testid":"export-payload"},j={key:1};function L(g,t,u,e,d,i){const r=w("b-skeleton"),c=w("meta-abbreviate-number"),m=w("fa-icon");return e.playerData?(l(),p("div",G,[o(e.MActionModalButton,{"modal-title":"GDPR Data Export",action:e.downloadData,"trigger-button-label":"GDPR Export","ok-button-label":"Download","ok-button-disabled-tooltip":e.exportData?void 0:"No data to download.","disable-safety-lock":"",permission:"api.players.gdpr_export",onShow:t[0]||(t[0]=b=>e.fetchData()),"data-testid":"gdpr-export"},{default:n(()=>[a("h6",I,"Personal Data of "+f(e.playerData.model.playerName||"n/a"),1),a("p",null,[t[1]||(t[1]=s("You can use this function to download personal data associated to player ID ")),o(e.MBadge,null,{default:n(()=>[s(f(e.playerData.id),1)],void 0,!0),_:1}),t[2]||(t[2]=s(" stored in this deployment's database."))])]),"right-panel":n(()=>[o(e.MCallout,{title:"Other Data Source"},{default:n(()=>t[3]||(t[3]=[a("p",null,"Your company might have other personal data associated with this ID in third party tools like analytics. You'll need to export those separately.",-1),a("p",null,"The player ID might also show up in short lived system logs like automatic error reports. Those logs do not contain any personal information in addition to this ID and will be automatically deleted according to your retention policies.",-1)]),void 0,!0),_:1})]),"bottom-panel":n(()=>[t[7]||(t[7]=a("h6",{class:"tw-mb-2"},"Export Preview",-1)),e.exportSize<e.sizeLimit?(l(),p("div",N,[a("pre",V,[e.exportData?(l(),p("span",Y,f(e.exportData),1)):(l(),p("span",j,[o(r,{width:"85%"}),o(r,{width:"55%"}),o(r,{width:"70%"}),o(r,{class:"tw-mt-4",width:"80%"}),o(r,{width:"65%"})]))])])):(l(),P(e.MCallout,{key:1,title:"Export Preview Disabled"},{default:n(()=>[a("p",null,[t[4]||(t[4]=s("Export preview disabled because of its large size of ")),o(c,{value:e.exportSize},null,8,["value"]),t[5]||(t[5]=s("b! You can still download the data 👍"))]),t[6]||(t[6]=a("p",{class:"tw-text-sm tw-text-orange-800"},"Some OS & browser combinations are known to have performance issues parsing large blobs of data. Let us know if you are one of them and we'll figure it out!",-1))],void 0,!0),_:1}))]),"ok-button-icon":n(()=>[o(m,{class:"tw-mb-[0.05rem] tw-h-3.5 tw-w-4",icon:"file-download"})]),_:1},8,["ok-button-disabled-tooltip"])])):B("",!0)}const K=E(C,[["render",L],["__file","PlayerActionGdprExport.vue"]]);export{K as default};
