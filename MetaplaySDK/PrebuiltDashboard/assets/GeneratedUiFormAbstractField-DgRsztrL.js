import{d as K,I as V,J as _,K as I,f as N,h as M,c as o,a0 as W,E as P,a1 as U,D as w,a as y,k,w as d,e as C,l as v,m as H,F as R,b as x,o as l,p as D,t as c,n as G,_ as J}from"./index-B7jvAjdE.js";import{L as q}from"./LabelWithLogicVersion-C_mqRCIw.js";import{G as z}from"./GeneratedUiFormDynamicComponent-DrqrTIRR.js";const Q=K({__name:"GeneratedUiFormAbstractField",props:{...V,value:{type:Object,default:()=>({})}},emits:_,setup(n,{expose:g,emit:u}){g();const e=n,p=u,{dataTestid:h,displayName:m,update:s}=I(e,p),r=N({});M(()=>{"$type"in e.value&&(r.value={...r.value,[e.value.$type]:e.value})});function T(t){if(t.jsonType in r.value)return!0;if(e.fieldInfo.excludedAbstractTypes?.includes(t.typeName))return!1;const a=e.abstractTypeFilter?.(e.fieldSchema.typeName);return a?a(t):!t.isDeprecated}const L=o(()=>{const t={...e.fieldInfo};return t.addedInVersion=i.value?.addedInVersion,t.removedInVersion=void 0,t.fieldType=i.value?.typeName??"",t.typeKind=P.Class,t}),f=o(()=>{if(!e.fieldSchema.derived)throw new Error("Derived schema not defined");return e.fieldSchema.derived.filter(T).map(t=>({value:t,id:(t.isDeprecated?"(deprecated) ":"")+t.typeName.split(".").at(-1),disabled:!w(t,e.logicVersion)}))}),i=o(()=>{if("$type"in e.value){if(!e.fieldSchema.derived)throw new Error("Derived schema not defined");return e.fieldSchema.derived.find(t=>t.jsonType===e.value.$type)}else return f.value[0]?.value??""}),S=o(()=>i.value?.typeName),E=o(()=>i.value===void 0||!e.isTargetingMultiplePlayers?!1:U(i.value)),O=o(()=>i.value?.addedInVersion!==void 0?`${i.value.typeName} is only supported in logic versions ${i.value.addedInVersion} and higher. While the server supports a larger range, a subsection of your users might not support this feature.`:"");function j(t){const a=t.jsonType;a in r.value?s(r.value[a]):s({$type:a})}const A=o(()=>f.value.length>1);function B(t){const a=i.value?.jsonType;if(!a)throw new Error("Type not defined");const b={...t,$type:a};r.value={...r.value,[a]:b},s(b)}const F={props:e,emit:p,dataTestid:h,displayName:m,emitUpdate:s,typeCache:r,includeTypeOption:T,abstractFieldInfo:L,typeOptions:f,selectedType:i,selectedTypeName:S,typeHasPotentialLogicVersionMismatch:E,logicVersionMismatchDescription:O,updateSelectedType:j,showPicker:A,update:B,computed:o,onMounted:M,ref:N,get MCallout(){return W},LabelWithLogicVersion:q,get generatedUiFieldFormEmits(){return _},get generatedUiFieldFormProps(){return V},get useGeneratedUiFieldForm(){return I},get EGeneratedUiTypeKind(){return P},get hasPotentialLogicVersionMismatch(){return U},get isVersionInRange(){return w},GeneratedUiFormDynamicComponent:z};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}}),X={key:0},Y={key:0,class:"tw-mb-2"};function Z(n,g,u,e,p,h){const m=x("meta-input-select");return e.typeOptions&&e.typeOptions.length===0?(l(),y("div",X,"No types available.")):(l(),y(R,{key:1},[e.showPicker?(l(),y("div",Y,[k(e.LabelWithLogicVersion,{fieldInfo:e.abstractFieldInfo,isTargetingMultiplePlayers:n.isTargetingMultiplePlayers},{default:d(()=>[D(c(e.displayName)+" Type",1)],void 0,!0),_:1},8,["fieldInfo","isTargetingMultiplePlayers"]),k(m,{value:e.selectedType,options:e.typeOptions,"no-clear":"",searchable:"",disabled:n.disabled,onInput:e.updateSelectedType,"data-testid":e.dataTestid+"-type-input"},{option:d(({option:s})=>[G("div",null,c(s?.typeName.split(".").at(-1)),1)]),selectedOption:d(()=>[G("div",null,c(e.selectedType?.typeName.split(".").at(-1)),1)]),_:1},8,["value","options","disabled","data-testid"]),e.typeHasPotentialLogicVersionMismatch?(l(),C(e.MCallout,{key:0,class:"tw-mt-3",title:"Potential Logic Version Mismatch",variant:"danger"},{default:d(()=>[D(c(e.logicVersionMismatchDescription),1)],void 0,!0),_:1})):v("",!0)])):v("",!0),e.selectedTypeName?(l(),C(e.GeneratedUiFormDynamicComponent,H({key:1},e.props,{key:e.selectedTypeName},{fieldInfo:{...n.fieldInfo,fieldType:e.selectedTypeName},value:u.value,"logic-version":n.logicVersion,disabled:n.disabled,isTargetingMultiplePlayers:n.isTargetingMultiplePlayers,onInput:e.update}),null,16,["fieldInfo","value","logic-version","disabled","isTargetingMultiplePlayers"])):v("",!0)],64))}const ie=J(Q,[["render",Z],["__file","GeneratedUiFormAbstractField.vue"]]);export{ie as default};
