import{d as U,aj as L,al as S,x as F,c as b,M as R,v as I,a8 as j,L as E,b as o,o as d,e as u,w as e,k as t,n as w,p as i,t as f,l as W,B as q,_ as z}from"./index-B7jvAjdE.js";import{a as C}from"./numberUtils-CkF0oMe2.js";import{M as H,a as J}from"./MViewContainer-BTeE2xDT.js";import{M as P,a as T,c as k,b as A}from"./metaListUtils-B-xQ0HnD.js";import{r as G}from"./rewardUtils-BIwy3Xgi.js";import{P as K}from"./PlayerConditionsCard-DQet32jq.js";import{S as Q}from"./SegmentsCard-jcRkLMcQ.js";import{b as V}from"./offers-DYY0Z2EJ.js";import"./MetaAudienceSizeEstimate-CCTh_xY2.js";const X=U({__name:"OfferDetailView",setup(B,{expose:n}){n();const D=L(),r=S(D.params.id),{data:m,error:N}=F(V(r)),v=b(()=>{const l=m.value.statistics.numActivatedForFirstTime,g=m.value.statistics.numPurchasedForFirstTime;return l===0?0:g/l*100}),a=b(()=>{const l=m.value.statistics.numActivatedForFirstTime,g=m.value.statistics.numPurchasedForFirstTime;return l===0?"Not activated by any players yet.":`Activated by ${C(l)} players and purchased by ${C(g)}.`}),s=b(()=>G(m.value.config.rewards||[])),O=b(()=>m.value.usedBy.map(l=>{switch(l.type){case"OfferGroup":return{type:l.type,displayName:l.displayName,icon:"tags",linkUrl:`/offerGroups/offerGroup/${l.id}`,linkText:"Offer Group"};case"Offer":return{type:l.type,displayName:l.displayName,icon:"tags",linkUrl:`/offerGroups/offer/${l.id}`,linkText:"Offer"};default:return{type:l.type,displayName:l.displayName,icon:"question-circle",linkUrl:"",linkText:""}}})),x=[new P("Type","type",T.Ascending),new P("Type","type",T.Descending),new P("Name","displayName",T.Ascending),new P("Name","displayName",T.Descending)],y=b(()=>[new A("type",[new k("Offer Groups",l=>l.type==="OfferGroup"),new k("Offers",l=>l.type==="Offer")].sort((l,g)=>{const _=l.displayName.toUpperCase(),M=g.displayName.toUpperCase();return _<M?-1:_>M?1:0}))]),c={route:D,offerId:r,singleOfferData:m,singleOfferError:N,conversionRate:v,conversionTooltip:a,rewards:s,referenceList:O,referencesSortOptions:x,filterSets:y,computed:b,get useRoute(){return L},get MetaListFilterOption(){return k},get MetaListFilterSet(){return A},get MetaListSortDirection(){return T},get MetaListSortOption(){return P},get rewardsWithMetaData(){return G},get MBadge(){return R},get MListItem(){return I},get MPageOverviewCard(){return H},get MTextButton(){return j},get MTooltip(){return E},get MViewContainer(){return J},get abbreviateNumber(){return C},get useSubscription(){return F},PlayerConditionsCard:K,SegmentsCard:Q,get routeParamToSingleValue(){return S},get getSingleOfferSubscriptionOptions(){return V}};return Object.defineProperty(c,"__isScriptSetup",{enumerable:!1,value:!0}),c}}),Y={class:"font-weight-bold"},Z={class:"font-weight-bold tw-mb-1"},h={class:"font-weight-bold tw-mb-1"},$={class:"tw-ml-1"};function ee(B,n,D,r,m,N){const v=o("fa-icon"),a=o("b-td"),s=o("b-tr"),O=o("b-tbody"),x=o("b-table-simple"),y=o("meta-plural-label"),c=o("b-row"),l=o("meta-reward-badge"),g=o("meta-list-card"),_=o("b-col"),M=o("meta-raw-data");return d(),u(r.MViewContainer,{"is-loading":!r.singleOfferData,error:r.singleOfferError,permission:"api.activables.view"},{overview:e(()=>[t(r.MPageOverviewCard,{id:r.singleOfferData.config.offerId,title:r.singleOfferData.config.displayName,subtitle:r.singleOfferData.config.description,"data-testid":"offer-detail-overview-card"},{default:e(()=>[w("span",Y,[t(v,{icon:"chart-bar"}),n[0]||(n[0]=i(" Overview"))]),t(x,{small:"",responsive:""},{default:e(()=>[t(O,null,{default:e(()=>[t(s,null,{default:e(()=>[t(a,null,{default:e(()=>n[1]||(n[1]=[i("In App Product")]),void 0,!0),_:1}),r.singleOfferData.config.inAppProduct!==null?(d(),u(a,{key:0,class:"text-right"},{default:e(()=>[i(f(r.singleOfferData.config.inAppProduct),1)],void 0,!0),_:1})):(d(),u(a,{key:1,class:"text-right text-muted tw-italic"},{default:e(()=>n[2]||(n[2]=[i("None")]),void 0,!0),_:1}))],void 0,!0),_:1}),r.singleOfferData.referencePrice!==null?(d(),u(s,{key:0},{default:e(()=>[t(a,null,{default:e(()=>n[3]||(n[3]=[i("Reference Price")]),void 0,!0),_:1}),t(a,{class:"text-right"},{default:e(()=>[i(f(r.singleOfferData.referencePrice),1)],void 0,!0),_:1})],void 0,!0),_:1})):W("",!0)],void 0,!0),_:1})],void 0,!0),_:1}),w("div",Z,[t(v,{icon:"times"}),n[4]||(n[4]=i(" Limits"))]),t(x,{small:"",responsive:""},{default:e(()=>[t(O,null,{default:e(()=>[t(s,null,{default:e(()=>[t(a,null,{default:e(()=>n[5]||(n[5]=[i("Max Activations")]),void 0,!0),_:1}),r.singleOfferData.config.maxActivationsPerPlayer===null?(d(),u(a,{key:0,class:"text-right text-muted tw-italic"},{default:e(()=>n[6]||(n[6]=[i("Unlimited")]),void 0,!0),_:1})):(d(),u(a,{key:1,class:"text-right"},{default:e(()=>[i(f(r.singleOfferData.config.maxActivationsPerPlayer),1)],void 0,!0),_:1}))],void 0,!0),_:1}),t(s,null,{default:e(()=>[t(a,null,{default:e(()=>n[7]||(n[7]=[i("Max Total Purchases")]),void 0,!0),_:1}),r.singleOfferData.config.maxPurchasesPerPlayer===null?(d(),u(a,{key:0,class:"text-right text-muted tw-italic"},{default:e(()=>n[8]||(n[8]=[i("Unlimited")]),void 0,!0),_:1})):(d(),u(a,{key:1,class:"text-right"},{default:e(()=>[i(f(r.singleOfferData.config.maxPurchasesPerPlayer),1)],void 0,!0),_:1}))],void 0,!0),_:1}),t(s,null,{default:e(()=>[t(a,null,{default:e(()=>n[9]||(n[9]=[i("Max Total Purchases Per Offer Group")]),void 0,!0),_:1}),r.singleOfferData.config.maxPurchasesPerOfferGroup===null?(d(),u(a,{key:0,class:"text-right text-muted tw-italic"},{default:e(()=>n[10]||(n[10]=[i("Unlimited")]),void 0,!0),_:1})):(d(),u(a,{key:1,class:"text-right"},{default:e(()=>[i(f(r.singleOfferData.config.maxPurchasesPerOfferGroup),1)],void 0,!0),_:1}))],void 0,!0),_:1}),t(s,null,{default:e(()=>[t(a,null,{default:e(()=>n[11]||(n[11]=[i("Max Purchases Per Activation")]),void 0,!0),_:1}),r.singleOfferData.config.maxPurchasesPerActivation===null?(d(),u(a,{key:0,class:"text-right text-muted tw-italic"},{default:e(()=>n[12]||(n[12]=[i("Unlimited")]),void 0,!0),_:1})):(d(),u(a,{key:1,class:"text-right"},{default:e(()=>[i(f(r.singleOfferData.config.maxPurchasesPerActivation),1)],void 0,!0),_:1}))],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),w("div",h,[t(v,{icon:"chart-line"}),n[13]||(n[13]=i(" Statistics"))]),t(x,{small:"",responsive:""},{default:e(()=>[t(O,null,{default:e(()=>[t(s,null,{default:e(()=>[t(a,null,{default:e(()=>[t(r.MTooltip,{content:"Total value across all offer groups."},{default:e(()=>n[14]||(n[14]=[i("Global")]),void 0,!0),_:1}),n[15]||(n[15]=i(" Seen by"))],void 0,!0),_:1}),t(a,{class:"text-right"},{default:e(()=>[t(y,{value:r.singleOfferData.statistics.numActivatedForFirstTime,label:"player"},null,8,["value"])],void 0,!0),_:1})],void 0,!0),_:1}),t(s,null,{default:e(()=>[t(a,null,{default:e(()=>[t(r.MTooltip,{content:"Total value across all offer groups."},{default:e(()=>n[16]||(n[16]=[i("Global")]),void 0,!0),_:1}),n[17]||(n[17]=i(" Purchased by"))],void 0,!0),_:1}),t(a,{class:"text-right"},{default:e(()=>[t(y,{value:r.singleOfferData.statistics.numPurchasedForFirstTime,label:"player"},null,8,["value"])],void 0,!0),_:1})],void 0,!0),_:1}),t(s,null,{default:e(()=>[t(a,null,{default:e(()=>[t(r.MTooltip,{content:"Total value across all offer groups."},{default:e(()=>n[18]||(n[18]=[i("Global")]),void 0,!0),_:1}),n[19]||(n[19]=i(" Conversion"))],void 0,!0),_:1}),t(a,{class:"text-right"},{default:e(()=>[t(r.MTooltip,{content:r.conversionTooltip},{default:e(()=>[i(f(r.conversionRate.toFixed(0))+"%",1)],void 0,!0),_:1},8,["content"])],void 0,!0),_:1})],void 0,!0),_:1}),t(s,null,{default:e(()=>[t(a,null,{default:e(()=>[n[21]||(n[21]=i("Total ")),t(r.MTooltip,{content:"Total value across all offer groups."},{default:e(()=>n[20]||(n[20]=[i("Global")]),void 0,!0),_:1}),n[22]||(n[22]=i(" Seen Count"))],void 0,!0),_:1}),t(a,{class:"text-right"},{default:e(()=>[t(y,{value:r.singleOfferData.statistics.numActivated,label:"time"},null,8,["value"])],void 0,!0),_:1})],void 0,!0),_:1}),t(s,null,{default:e(()=>[t(a,null,{default:e(()=>[n[24]||(n[24]=i("Total ")),t(r.MTooltip,{content:"Total value across all offer groups."},{default:e(()=>n[23]||(n[23]=[i("Global")]),void 0,!0),_:1}),n[25]||(n[25]=i(" Purchased Count"))],void 0,!0),_:1}),t(a,{class:"text-right"},{default:e(()=>[t(y,{value:r.singleOfferData.statistics.numPurchased,label:"time"},null,8,["value"])],void 0,!0),_:1})],void 0,!0),_:1}),t(s,null,{default:e(()=>[t(a,null,{default:e(()=>[n[27]||(n[27]=i("Total ")),t(r.MTooltip,{content:"Total value across all offer groups."},{default:e(()=>n[26]||(n[26]=[i("Global")]),void 0,!0),_:1}),n[28]||(n[28]=i(" Revenue"))],void 0,!0),_:1}),t(a,{class:"text-right"},{default:e(()=>[i("$"+f(r.singleOfferData.statistics.revenue.toFixed(2)),1)],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1},8,["id","title","subtitle"])]),default:e(()=>[t(c,{class:"mb-2 tw-mt-4","no-gutters":"","align-v":"center"},{default:e(()=>n[29]||(n[29]=[w("h3",null,"Configuration",-1)]),void 0,!0),_:1}),t(c,{class:"mb-2 tw-mt-4"},{default:e(()=>[t(_,{class:"tw-mb-4",md:"6"},{default:e(()=>[t(g,{title:"Contents",itemList:r.rewards,listLayout:"flex","data-testid":"offer-detail-contents-card"},{"item-card":e(p=>[t(l,{reward:p.item},null,8,["reward"])]),_:1},8,["itemList"])],void 0,!0),_:1}),t(_,{class:"tw-mb-4",md:"6"},{default:e(()=>[t(g,{title:"Referenced by",icon:"exchange-alt",itemList:r.referenceList,filterSets:r.filterSets,sortOptions:r.referencesSortOptions,searchFields:["displayName","type"],emptyMessage:"No offer groups or other offers reference this offer.","data-testid":"offer-detail-references-card"},{"item-card":e(({item:p})=>[t(r.MListItem,null,q({default:e(()=>[t(r.MBadge,null,{icon:e(()=>[t(v,{icon:p.icon},null,8,["icon"])]),default:e(()=>[i(f(p.type),1)],void 0,!0),_:2},1024),w("span",$,f(p.displayName),1)],void 0,!0),_:2},[p.linkUrl?{name:"top-right",fn:e(()=>[t(r.MTextButton,{to:p.linkUrl},{default:e(()=>[i("View "+f(`${p.linkText.toLocaleLowerCase()}`),1)],void 0,!0),_:2},1032,["to"])]),key:"0"}:void 0]),1024)]),_:1},8,["itemList","filterSets"])],void 0,!0),_:1})],void 0,!0),_:1}),t(c,{class:"mb-2 tw-mt-4","no-gutters":"","align-v":"center"},{default:e(()=>n[30]||(n[30]=[w("h3",null,"Targeting",-1)]),void 0,!0),_:1}),t(c,{"align-h":"center"},{default:e(()=>[t(_,{class:"tw-mb-4",md:"6"},{default:e(()=>[t(r.SegmentsCard,{segments:r.singleOfferData.config.segments,ownerTitle:"This event"},null,8,["segments"])],void 0,!0),_:1}),t(_,{class:"tw-mb-4",md:"6"},{default:e(()=>[t(r.PlayerConditionsCard,{playerConditions:r.singleOfferData.config.additionalConditions},null,8,["playerConditions"])],void 0,!0),_:1})],void 0,!0),_:1}),t(M,{kvPair:r.singleOfferData,name:"offer"},null,8,["kvPair"])]),_:1},8,["is-loading","error"])}const oe=z(X,[["render",ee],["__file","OfferDetailView.vue"]]);export{oe as default};
