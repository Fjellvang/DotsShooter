import{d as I,x as y,ad as L,M as B,ae as T,b as O,o as i,e as o,w as s,n,p as r,k as a,t as h,_ as N,aj as S,al as k,c as f,N as b,e9 as D,ck as F,ac as U,a as d,l as w,bd as x}from"./index-B7jvAjdE.js";import{M as z,a as Y}from"./MViewContainer-BTeE2xDT.js";import{M as q}from"./MTwoColumnLayout-C4tHp69a.js";import{M as H}from"./MDateTime-BN0QPwIm.js";import J from"./MetaRawData-CedjqGjJ.js";import{M as K}from"./MetaGeneratedContent-DU2kF4fJ.js";import{P as Q}from"./PlayerListCard-CmEr-veR.js";import{M as W}from"./MActionModalButton-CvWVuTB-.js";import{c as E,a as C}from"./liveOpsEvents-jq8FGsN5.js";import{L as X,a as Z}from"./LiveOpsEventFormModalButton-B_dbraRU.js";import{T as $}from"./TargetingCard-DNNkYW_r.js";import{C as ee}from"./CoreUiPlacement-CPf1fwrN.js";import{l as te}from"./liveOpsEventUtils-DTi4aG6g.js";import{B as ne,a as ie}from"./progress-GKvrz8Gh.js";import"./utils-Dwlepb3M.js";import"./MActionModal-coQLkvWs.js";import"./index-fVjXqxSF.js";import"./MInputTextArea-BMdoSBpm.js";import"./MInputHintMessage-DbuBS4Kn.js";import"./debounce-B8gTqdZO.js";import"./isSymbol-B7ZrWRtH.js";import"./MetaListCard-CSSWUW2Z.js";import"./MInputMultiSelectCheckbox-D_9f7ub1.js";import"./MInputCheckbox-BqateWtE.js";import"./index-B_QkKjtG.js";import"./MInputSingleSelectRadio-BukGu4ZH.js";import"./index-CDBqmjrS.js";import"./MInputText-CzhsT8yb.js";import"./metaListUtils-B-xQ0HnD.js";import"./_baseIteratee-BXhw53re.js";import"./toString-DMHXP3G8.js";import"./identity-DKeuBCMA.js";import"./button-group-BUOztpby.js";import"./actionDebouncer-CJRtFyZn.js";import"./axiosActionHandler-rx_q8iFy.js";import"./MInputDateTime-DL6Zd7-d.js";import"./MInputSwitch-C-Z-JJsG.js";import"./index-DZuvHjnn.js";import"./MInputDuration-C704TlZG.js";import"./MInputNumber-BOzPEn49.js";import"./MInputSingleSelectDropdown-D7-YpE7w.js";import"./index-qTA83-by.js";import"./MInputSingleSelectSwitch-CuptGC6e.js";import"./MInputSimpleSelectDropdown-DIlBEFcs.js";import"./MetaGeneratedForm-BcVgOIy3.js";import"./GeneratedUiFormDynamicComponent-DrqrTIRR.js";import"./MessageAudienceForm-Bn0DOLdW.js";import"./numberUtils-CkF0oMe2.js";import"./_arrayIncludes-B3ShBz6l.js";import"./MetaAudienceSizeEstimate-CCTh_xY2.js";const ae=I({__name:"LiveOpsEventActionConclude",props:{eventId:{}},setup(_,{expose:t}){t();const m=L(),e=_,{data:l,refresh:g}=y(E(e.eventId)),{showSuccessNotification:v}=T();async function u(){await m.post(`/concludeLiveOpsEvent/${e.eventId}`),v("Event concluded."),g()}const c={gameServerApi:m,props:e,singleLiveOpsEventData:l,singleLiveOpsEventRefresh:g,showSuccessNotification:v,onOk:u,get useGameServerApi(){return L},get MActionModalButton(){return W},get MBadge(){return B},get useNotifications(){return T},get useSubscription(){return y},get getSingleLiveOpsEventsSubscriptionOptions(){return E}};return Object.defineProperty(c,"__isScriptSetup",{enumerable:!1,value:!0}),c}});function se(_,t,m,e,l,g){const v=O("meta-no-seatbelts");return i(),o(e.MActionModalButton,{"modal-title":"Conclude Event",action:e.onOk,"trigger-button-label":"Conclude","trigger-button-disabled-tooltip":e.singleLiveOpsEventData?.currentPhase==="Ended"?"This event has already ended.":void 0,"trigger-button-full-width":"",variant:"warning","ok-button-label":"Conclude",permission:"api.liveops_events.edit"},{default:s(()=>[n("p",null,[t[0]||(t[0]=r("Concluding ")),a(e.MBadge,null,{default:s(()=>[r(h(e.singleLiveOpsEventData?.eventParams.displayName),1)],void 0,!0),_:1}),t[1]||(t[1]=r(" will force it to end immediately, regardless of its schedule."))]),a(v)],void 0,!0),_:1},8,["trigger-button-disabled-tooltip"])}const oe=N(ae,[["render",se],["__file","LiveOpsEventActionConclude.vue"]]),re=I({__name:"LiveOpsEventDetailView",setup(_,{expose:t}){t();const m=S(),e=k(m.params.id),{data:l,error:g,refresh:v}=y(E(e)),{data:u}=y(C()),c=f(()=>l.value?.eventParams.schedule??null),P=f(()=>{if(l.value?.eventParams.schedule){const p=b.fromISO(l.value.eventParams.schedule.enabledEndTime??"").diff(b.fromISO(l.value.eventParams.schedule.enabledStartTime??"")).toISO()??"PT0S";return D(p)}else return 0}),A=f(()=>l.value?.eventParams.schedule?D(l.value.eventParams.schedule.previewDuration??"PT0S")+P.value+D(l.value.eventParams.schedule.reviewDuration??"PT0S"):0),V=f(()=>{const p=l.value?.eventParams.content.$type;return(u.value??[]).find(R=>{const G=R.contentClass.split(",")[0];return p===G})?.eventTypeName??p}),j=f(()=>{const p=[];return l.value?.currentPhase==="Ended"&&p.push({title:"Past Event",message:"You are currently viewing an event that has already ended.",variant:"neutral"}),p}),M={route:m,eventId:e,singleLiveOpsEventData:l,singleLiveOpsEventError:g,singleLiveOpsEventRefresh:v,liveOpsEventTypesData:u,schedule:c,enabledDurationInMilliseconds:P,totalDurationInSeconds:A,eventTypeDisplayName:V,alerts:j,get BProgress(){return ne},get BProgressBar(){return ie},get DateTime(){return b},get Duration(){return F},computed:f,get useRoute(){return S},get MetaRawData(){return J},get MBadge(){return B},get MCard(){return U},get MDateTime(){return H},get MPageOverviewCard(){return z},get MViewContainer(){return Y},get MTwoColumnLayout(){return q},get useSubscription(){return y},MetaGeneratedContent:K,PlayerListCard:Q,LiveOpsEventActionConclude:oe,LiveOpsEventActionExport:X,LiveOpsEventFormModalButton:Z,TargetingCard:$,CoreUiPlacement:ee,get routeParamToSingleValue(){return k},get durationToMilliseconds(){return D},get liveOpsEventPhaseInfos(){return te},get getLiveOpsEventTypesSubscriptionOptions(){return C},get getSingleLiveOpsEventsSubscriptionOptions(){return E}};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),le={class:"tw-m-0 tw-mb-4 tw-divide-y tw-divide-neutral-200",role:"list"},de={class:"tw-mb-1 tw-font-semibold"},ve={class:"tw-block tw-py-1"},ue={class:"tw-flex tw-justify-between"},ce={class:"tw-block tw-py-1"},me={class:"tw-flex tw-justify-between"},pe={class:"tw-m-0 tw-divide-y tw-divide-neutral-200",role:"list"},ge={class:"tw-mb-1 tw-font-semibold"},fe={class:"tw-block tw-py-1"},we={class:"tw-flex tw-justify-between"},he={key:0,class:"tw-italic tw-text-neutral-500"},ye={class:"tw-block tw-py-1"},_e={class:"tw-flex tw-justify-between"},De={key:0,class:"tw-italic tw-text-neutral-500"},Oe={class:"tw-block tw-py-1"},Ee={class:"tw-flex tw-justify-between"},be={key:0,class:"tw-italic tw-text-neutral-500"},Pe={class:"tw-block tw-py-1"},Me={class:"tw-flex tw-justify-between"},Le={key:0,class:"tw-italic tw-text-neutral-500"},Te={class:"tw-block tw-py-1"},Se={class:"tw-flex tw-justify-between"},ke={key:0,class:"tw-italic tw-text-neutral-500"},xe={class:"tw-block tw-py-1"},Ce={class:"tw-flex tw-justify-between"},Ie={key:0,class:"tw-italic tw-text-neutral-500"},Be={class:"tw-block tw-py-1"},Ne={class:"tw-flex tw-justify-between"},Ae={key:0,class:"tw-italic tw-text-neutral-500"},Ve={key:0},je={class:"tw-my-5"},Re={key:0,class:"tw-m-0 tw-divide-y tw-divide-neutral-200",role:"list"},Ge={class:"tw-flex tw-justify-between"},Fe={class:"small"},Ue={key:0},ze={class:"small"},Ye={key:0};function qe(_,t,m,e,l,g){const v=O("fa-icon"),u=O("meta-duration"),c=O("meta-time");return i(),o(e.MViewContainer,{"is-loading":!e.singleLiveOpsEventData,"meta-api-error":e.singleLiveOpsEventError,alerts:e.alerts,permission:"api.liveops_events.view"},{overview:s(()=>[e.singleLiveOpsEventData?(i(),o(e.MPageOverviewCard,{key:0,title:e.singleLiveOpsEventData.eventParams.displayName,subtitle:e.singleLiveOpsEventData.eventParams.description,id:e.eventId,"data-testid":"live-ops-event-detail-overview-card"},{buttons:s(()=>[a(e.LiveOpsEventActionConclude,{eventId:e.eventId},null,8,["eventId"]),a(e.LiveOpsEventFormModalButton,{"form-mode":"edit","current-phase":e.singleLiveOpsEventData?.currentPhase,"prefill-data":e.singleLiveOpsEventData?.eventParams,"event-id":e.singleLiveOpsEventData?.eventId,onRefresh:e.singleLiveOpsEventRefresh},null,8,["current-phase","prefill-data","event-id","onRefresh"]),a(e.LiveOpsEventFormModalButton,{"form-mode":"duplicate","prefill-data":e.singleLiveOpsEventData?.eventParams},null,8,["prefill-data"]),a(e.LiveOpsEventActionExport,{"prefill-text":e.singleLiveOpsEventData?.eventId},null,8,["prefill-text"])]),default:s(()=>[n("ul",le,[n("div",de,[a(v,{icon:"bar-chart"}),t[0]||(t[0]=r(" Overview"))]),n("li",ve,[n("span",ue,[t[1]||(t[1]=n("span",null,"Event Type",-1)),a(e.MBadge,null,{default:s(()=>[r(h(e.eventTypeDisplayName),1)],void 0,!0),_:1})])]),n("li",ce,[n("span",me,[t[2]||(t[2]=n("span",null,"Total Participants",-1)),n("span",null,h(e.singleLiveOpsEventData.participantCount),1)])])]),n("ul",pe,[n("div",ge,[a(v,{icon:"calendar-alt"}),t[3]||(t[3]=r(" Scheduling"))]),n("li",fe,[n("span",we,[t[4]||(t[4]=n("span",null,"Time Mode",-1)),e.schedule?(i(),o(e.MBadge,{key:1},{default:s(()=>[r(h(e.schedule.isPlayerLocalTime?"Player Local":"UTC"),1)],void 0,!0),_:1})):(i(),d("span",he,"None"))])]),n("li",ye,[n("span",_e,[t[5]||(t[5]=n("span",null,"Start Time",-1)),e.schedule?(i(),o(e.MDateTime,{key:1,instant:e.DateTime.fromISO(e.schedule.enabledStartTime),"disable-tooltip":e.schedule?.isPlayerLocalTime},null,8,["instant","disable-tooltip"])):(i(),d("span",De,"None"))])]),n("li",Oe,[n("span",Ee,[t[6]||(t[6]=n("span",null,"End Time",-1)),e.schedule?(i(),o(e.MDateTime,{key:1,instant:e.DateTime.fromISO(e.schedule.enabledEndTime),"disable-tooltip":e.schedule?.isPlayerLocalTime},null,8,["instant","disable-tooltip"])):(i(),d("span",be,"None"))])]),n("li",Pe,[n("span",Me,[t[7]||(t[7]=n("span",null,"Preview Duration",-1)),!e.schedule||e.Duration.fromISO(e.schedule.previewDuration).toMillis()===0?(i(),d("span",Le,"None")):(i(),o(u,{key:1,duration:e.schedule.previewDuration,showAs:"exactDuration",hideMilliseconds:""},null,8,["duration"]))])]),n("li",Te,[n("span",Se,[t[8]||(t[8]=n("span",null,"Ending Soon Duration",-1)),!e.schedule||e.Duration.fromISO(e.schedule.endingSoonDuration).toMillis()===0?(i(),d("span",ke,"None")):(i(),o(u,{key:1,duration:e.schedule.endingSoonDuration,showAs:"exactDuration",hideMilliseconds:""},null,8,["duration"]))])]),n("li",xe,[n("span",Ce,[t[9]||(t[9]=n("span",null,"Review Duration",-1)),!e.schedule||e.Duration.fromISO(e.schedule.reviewDuration).toMillis()===0?(i(),d("span",Ie,"None")):(i(),o(u,{key:1,duration:e.schedule?.reviewDuration,showAs:"exactDuration",hideMilliseconds:""},null,8,["duration"]))])]),n("li",Be,[n("span",Ne,[t[10]||(t[10]=n("span",null,"Total Duration",-1)),e.schedule?(i(),o(u,{key:1,duration:e.totalDurationInSeconds,showAs:"exactDuration",hideMilliseconds:""},null,8,["duration"])):(i(),d("span",Ae,"None"))])])]),e.schedule?.isPlayerLocalTime===!1&&e.singleLiveOpsEventData?.currentPhase!=="Ended"?(i(),d("span",Ve,[n("div",je,[e.schedule?(i(),d("ul",Re,[n("div",Ge,[n("span",null,[t[11]||(t[11]=r("Current Phase: ")),e.singleLiveOpsEventData?.currentPhase?(i(),o(e.MBadge,{key:0,variant:e.liveOpsEventPhaseInfos[e.singleLiveOpsEventData.currentPhase].badgeVariant},{default:s(()=>[r(h(e.liveOpsEventPhaseInfos[e.singleLiveOpsEventData.currentPhase].displayString),1)],void 0,!0),_:1},8,["variant"])):w("",!0)]),n("span",null,[t[13]||(t[13]=r("Next Phase: ")),e.singleLiveOpsEventData?.nextPhase?(i(),o(e.MBadge,{key:0,variant:e.liveOpsEventPhaseInfos[e.singleLiveOpsEventData.nextPhase].badgeVariant},{default:s(()=>[r(h(e.liveOpsEventPhaseInfos[e.singleLiveOpsEventData.nextPhase].displayString),1)],void 0,!0),_:1},8,["variant"])):w("",!0),n("span",null,[t[12]||(t[12]=r(" ")),e.singleLiveOpsEventData?.nextPhaseTime?(i(),o(c,{key:0,date:e.singleLiveOpsEventData.nextPhaseTime},null,8,["date"])):w("",!0)])])])])):w("",!0)]),n("div",{class:"pb-3 pl-2 border-left border-dark",style:x(`margin-left: ${e.durationToMilliseconds(e.schedule?.previewDuration??"0")/e.totalDurationInSeconds*100}%; position: relative; left: -1px`)},[t[14]||(t[14]=n("div",{class:"small font-weight-bold"},"Start",-1)),n("div",Fe,[e.schedule===null?(i(),d("span",Ue,"No schedule")):(i(),o(c,{key:1,date:e.schedule?.enabledStartTime??""},null,8,["date"]))])],4),e.schedule?(i(),o(e.BProgress,{key:0,class:"font-weight-bold",max:e.totalDurationInSeconds,height:"3rem"},{default:s(()=>[a(e.BProgressBar,{value:e.durationToMilliseconds(e.schedule?.previewDuration??"0"),variant:"info"},{default:s(()=>t[15]||(t[15]=[r("Preview")]),void 0,!0),_:1},8,["value"]),a(e.BProgressBar,{value:e.schedule.endingSoonDuration?e.enabledDurationInMilliseconds-e.durationToMilliseconds(e.schedule.endingSoonDuration):e.enabledDurationInMilliseconds,variant:"success"},{default:s(()=>t[16]||(t[16]=[r("Active")]),void 0,!0),_:1},8,["value"]),a(e.BProgressBar,{value:e.durationToMilliseconds(e.schedule.endingSoonDuration??"0"),variant:"warning"},{default:s(()=>t[17]||(t[17]=[r("Ending soon")]),void 0,!0),_:1},8,["value"]),a(e.BProgressBar,{value:e.durationToMilliseconds(e.schedule.reviewDuration??"0"),variant:"info"},{default:s(()=>t[18]||(t[18]=[r("Review")]),void 0,!0),_:1},8,["value"])],void 0,!0),_:1},8,["max"])):(i(),o(e.BProgress,{key:1,class:"font-weight-bold",max:1,height:"3rem"},{default:s(()=>[a(e.BProgressBar,{value:1,variant:"success"},{default:s(()=>t[19]||(t[19]=[r("Active")]),void 0,!0),_:1})],void 0,!0),_:1})),n("div",{class:"pt-3 pr-2 pb-1 border-right border-dark text-right",style:x(`margin-right: ${e.durationToMilliseconds(e.schedule?.reviewDuration??"0")/e.totalDurationInSeconds*100}%; position: relative; right: -1px`)},[t[20]||(t[20]=n("div",{class:"small font-weight-bold"},"End",-1)),n("div",ze,[e.schedule===null?(i(),d("span",Ye,"No schedule")):(i(),o(c,{key:1,date:e.schedule?.enabledEndTime??""},null,8,["date"]))])],4)])):w("",!0)],void 0,!0),_:1},8,["title","subtitle","id"])):w("",!0)]),default:s(()=>[a(e.MTwoColumnLayout,null,{default:s(()=>[a(e.MCard,{title:"Event Configuration","data-testid":"live-ops-event-detail-configuration-card"},{default:s(()=>[a(e.MetaGeneratedContent,{value:e.singleLiveOpsEventData?.eventParams.content,"is-targeting-multiple-players":""},null,8,["value"])],void 0,!0),_:1}),a(e.TargetingCard,{targetCondition:e.singleLiveOpsEventData?.eventParams.targetCondition??null,ownerTitle:"This event"},null,8,["targetCondition"]),a(e.PlayerListCard,{playerIds:e.singleLiveOpsEventData?.eventParams.targetPlayers??[],title:"Individual Players",emptyMessage:"No individual players targeted."},null,8,["playerIds"])],void 0,!0),_:1}),a(e.CoreUiPlacement,{placementId:"LiveOpsEvents/Details",liveOpsEventId:e.eventId},null,8,["liveOpsEventId"]),a(e.MetaRawData,{kvPair:e.singleLiveOpsEventData,name:"singleLiveOpsEventData"},null,8,["kvPair"])],void 0,!0),_:1},8,["is-loading","meta-api-error","alerts"])}const zt=N(re,[["render",qe],["__file","LiveOpsEventDetailView.vue"]]);export{zt as default};
