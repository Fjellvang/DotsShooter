import{d as x,aj as g,al as m,x as D,c as p,N as f,a0 as C,a8 as P,b as h,o as y,e as w,w as i,n as a,p as r,k as n,l as T,t as s,_ as V}from"./index-B7jvAjdE.js";import{M as A,a as S}from"./MViewContainer-BTeE2xDT.js";import k from"./MetaRawData-CedjqGjJ.js";import N from"./MetaTime-D0iYB_lr.js";import{C as O}from"./CoreUiPlacement-CPf1fwrN.js";import{g as v}from"./incidents-CceQLPcP.js";import"./utils-Dwlepb3M.js";const R=x({__name:"PlayerIncidentDetailView",setup(M,{expose:t}){t();const o=g(),e=m(o.params.playerId),l=m(o.params.incidentId),{data:d,error:u}=D(v(e,l)),b=p(()=>{const c=[];return e?l||c.push({title:"No incident ID parameter detected!",message:"Fetching incident reports requires an incident ID",variant:"warning",dataTest:"incident-no-incidentId"}):c.push({title:"No player ID parameter detected!",message:"Fetching incident reports requires a player ID.",variant:"danger",dataTest:"incident-no-playerId"}),c}),_=p(()=>d.value&&f.fromISO(d.value.deletionDateTime).diffNow("days").days<=3),I={route:o,playerId:e,incidentId:l,playerIncidentData:d,playerIncidentError:u,alerts:b,isCloseToDeletionDate:_,get DateTime(){return f},computed:p,get useRoute(){return g},get MetaRawData(){return k},get MetaTime(){return N},get MCallout(){return C},get MTextButton(){return P},get MPageOverviewCard(){return A},get MViewContainer(){return S},get useSubscription(){return D},CoreUiPlacement:O,get routeParamToSingleValue(){return m},get getPlayerIncidentSubscriptionOptions(){return v}};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}}),B={class:"tw-font-semibold"},U={class:"text-danger"},E={class:"tw-mb-1 tw-font-semibold"},j={class:"tw-w-full"},q={class:"tw-divide-y tw-divide-neutral-200 tw-border-t tw-border-neutral-200 *:*:tw-py-1"},F={class:"tw-text-right"},z={class:"tw-text-right"},G={class:"tw-text-right"},H={class:"tw-text-right"},J={class:"tw-text-right"},K={class:"tw-text-right"};function L(M,t,o,e,l,d){const u=h("fa-icon");return y(),w(e.MViewContainer,{"is-loading":!e.playerIncidentData,error:e.playerIncidentError,alerts:e.alerts,variant:e.isCloseToDeletionDate?"warning":void 0,permission:"api.incident_reports.view"},{alerts:i(()=>[e.isCloseToDeletionDate?(y(),w(e.MCallout,{key:0,title:"This incident will be deleted soon!"},{default:i(()=>[a("div",null,[t[0]||(t[0]=r("This incident report will be deleted")),a("span",B,[n(e.MetaTime,{date:e.playerIncidentData.deletionDateTime,showAs:"timeago"},null,8,["date"])]),t[1]||(t[1]=r(" at ")),n(e.MetaTime,{date:e.playerIncidentData.deletionDateTime,showAs:"time",disableTooltip:""},null,8,["date"]),t[2]||(t[2]=r(" on ")),n(e.MetaTime,{date:e.playerIncidentData.deletionDateTime,showAs:"date",disableTooltip:""},null,8,["date"]),t[3]||(t[3]=r("."))]),t[4]||(t[4]=a("div",{class:"tw-mt-1"},"Incidents are deleted every now and then, we recommend saving the data elsewhere if it is important.",-1))],void 0,!0),_:1})):T("",!0)]),overview:i(()=>[n(e.MPageOverviewCard,{id:e.playerIncidentData.incidentId,title:"Player Incident Report"},{subtitle:i(()=>[a("span",U,s(e.playerIncidentData.exceptionMessage),1),e.playerIncidentData.subType==="NullReferenceException"?(y(),w(e.MCallout,{key:0,class:"tw-mt-4",title:"Did you know?"},{default:i(()=>t[5]||(t[5]=[a("div",null,"Null reference exceptions are a very common category of errors in Unity that do not cause the game crash outright, but often cause the game to appear stuck or otherwise 'broken' for the players.",-1)]),void 0,!0),_:1})):T("",!0)]),default:i(()=>[a("div",E,[n(u,{icon:"chart-bar"}),t[6]||(t[6]=r(" Overview"))]),a("table",j,[a("tbody",q,[a("tr",null,[t[7]||(t[7]=a("td",null,"Type",-1)),a("td",F,s(e.playerIncidentData.type),1)]),a("tr",null,[t[8]||(t[8]=a("td",null,"Subtype",-1)),a("td",z,s(e.playerIncidentData.subType),1)]),a("tr",null,[t[9]||(t[9]=a("td",null,"Uploaded At",-1)),a("td",G,[n(e.MetaTime,{date:e.playerIncidentData.uploadedAt,showAs:"datetime"},null,8,["date"])])]),a("tr",null,[t[10]||(t[10]=a("td",null,"Occurred At (device time)",-1)),a("td",H,[n(e.MetaTime,{date:e.playerIncidentData.occurredAt,showAs:"datetime"},null,8,["date"])])]),a("tr",null,[t[11]||(t[11]=a("td",null,"Deletion Time",-1)),a("td",J,[n(e.MetaTime,{date:e.playerIncidentData.deletionDateTime,showAs:"datetime"},null,8,["date"])])]),a("tr",null,[t[12]||(t[12]=a("td",null,"Player ID",-1)),a("td",K,[n(e.MTextButton,{to:`/players/${e.route.params.playerId}`},{default:i(()=>[r(s(e.route.params.playerId),1)],void 0,!0),_:1},8,["to"])])])])])],void 0,!0),_:1},8,["id"])]),default:i(()=>[n(e.CoreUiPlacement,{placementId:"PlayerIncidents/Details",incidentId:e.incidentId,playerId:e.playerId},null,8,["incidentId","playerId"]),n(e.MetaRawData,{kvPair:e.playerIncidentData,name:"incident"},null,8,["kvPair"])]),_:1},8,["is-loading","error","alerts","variant"])}const te=V(R,[["render",L],["__file","PlayerIncidentDetailView.vue"]]);export{te as default};
