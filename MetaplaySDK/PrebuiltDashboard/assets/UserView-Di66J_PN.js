import{d as G,a6 as U,aa as x,dF as O,c as S,f as C,C as V,dG as F,M as E,s as H,v as K,aU as B,a9 as T,b as l,o as d,e as z,w as s,k as r,p as o,t as m,a as c,F as Y,r as j,n as M,l as q,bd as J,_ as Q}from"./index-B7jvAjdE.js";import{M as W}from"./MInputSwitch-C-Z-JJsG.js";import{M as X}from"./MInputMultiSelectCheckbox-D_9f7ub1.js";import{a as Z}from"./MViewContainer-BTeE2xDT.js";import{M as u,a as f,c as _,b as D}from"./metaListUtils-B-xQ0HnD.js";import"./index-B_QkKjtG.js";import"./MInputCheckbox-BqateWtE.js";import"./MInputHintMessage-DbuBS4Kn.js";const $=G({__name:"UserView",setup(N,{expose:i}){i();const P=U(),e=x(),a=O(),y=B(),g=S(()=>a.auth.serverPermissions.map(t=>({permissionDetails:t,hasPermission:y.doesHavePermission(t.name)}))),w=[u.asUnsorted(),new u("Name","permissionDetails.name",f.Ascending),new u("Name","permissionDetails.name",f.Descending),new u("Group","permissionDetails.group",f.Ascending),new u("Group","permissionDetails.group",f.Descending),new u("Type","permissionDetails.type",f.Ascending),new u("Type","permissionDetails.type",f.Descending)],L=S(()=>[new D("hasPermission",[new _("Has permission",t=>t.hasPermission,!0),new _("Does not have permission",t=>!t.hasPermission)]),new D("group",g.value.map(t=>t.permissionDetails.group).filter((t,p,A)=>A.indexOf(t)===p).map(t=>new _(t,p=>p.permissionDetails.group===t))),new D("type",g.value.map(t=>t.permissionDetails.type).filter((t,p,A)=>A.indexOf(t)===p).map(t=>new _(t,p=>p.permissionDetails.type===t)))]);function h(t){return t.permissionDetails.name}const I=[...a.auth.serverRoles].sort().map(t=>({label:t,value:t})),v=S(()=>[...a.auth.userRoles].sort()),k=S(()=>{const t=a.auth.userAssumedRoles.length>0?"Assumed Role":"Role";return T(v.value.length,t,!1)}),b=a.auth.canAssumeRoles,n=C(a.auth.userAssumedRoles);V(n,async t=>{await F(t)});const R={staticInfos:P,uiStore:e,gameServerApiStore:a,permissions:y,decoratedPermissions:g,permissionListSortOptions:w,permissionListFilterSets:L,getPermissionsItemKey:h,allRolesSorted:I,allUserRolesSorted:v,roleLabel:k,canAssumeRoles:b,rolesToAssume:n,computed:S,ref:C,watch:V,get assumeRoles(){return F},get useGameServerApiStore(){return O},get useStaticInfos(){return U},get useUiStore(){return x},get MetaListFilterOption(){return _},get MetaListFilterSet(){return D},get MetaListSortDirection(){return f},get MetaListSortOption(){return u},get MBadge(){return E},get MList(){return H},get MListItem(){return K},get MInputSwitch(){return W},get MInputMultiSelectCheckbox(){return X},get usePermissions(){return B},get MViewContainer(){return Z},get maybePluralString(){return T}};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}}),ee={key:0,class:"text-right"},te={key:1},se={class:"font-weight-bold mr-2",style:{"padding-top":"0.1rem"}},ie={key:0,class:"tw-italic"},re={key:0,class:"tw-mb-4"},ne={key:1,class:"text-muted mt-4 tw-text-center tw-italic"};function oe(N,i,P,e,a,y){const g=l("b-avatar"),w=l("b-row"),L=l("fa-icon"),h=l("b-card"),I=l("meta-list-card"),v=l("b-col"),k=l("b-card-title"),b=l("meta-raw-data");return d(),z(e.MViewContainer,null,{overview:s(()=>[r(h,{class:"shadow-sm mb-3","data-testid":"user-overview-card"},{default:s(()=>[r(w,{class:"mb-5","align-h":"center"},{default:s(()=>[r(g,{src:e.gameServerApiStore.auth.userDetails.picture,variant:"light",size:"7em"},null,8,["src"])],void 0,!0),_:1}),r(e.MList,{showBorder:""},{default:s(()=>[r(e.MListItem,null,{"top-right":s(()=>[o(m(e.gameServerApiStore.auth.userDetails.name),1)]),default:s(()=>[i[3]||(i[3]=o("Name"))],void 0,!0),_:1}),r(e.MListItem,null,{"top-right":s(()=>[o(m(e.gameServerApiStore.auth.userDetails.email),1)]),default:s(()=>[i[4]||(i[4]=o("Email"))],void 0,!0),_:1}),r(e.MListItem,null,{"top-right":s(()=>[o(m(e.gameServerApiStore.auth.userDetails.id),1)]),default:s(()=>[i[5]||(i[5]=o("ID"))],void 0,!0),_:1}),r(e.MListItem,null,{"top-right":s(()=>[e.allUserRolesSorted.length>0?(d(),c("span",ee,[(d(!0),c(Y,null,j(e.allUserRolesSorted,n=>(d(),c("div",{key:n},m(n),1))),128))])):(d(),c("span",te,i[6]||(i[6]=[M("span",{class:"text-warning"},"None ðŸ˜¢",-1)])))]),default:s(()=>[o(m(e.roleLabel),1)],void 0,!0),_:1}),r(e.MListItem,null,{default:s(()=>[M("div",se,[r(L,{icon:e.uiStore.isSafetyLockOn?"lock":"lock-open",style:{width:"1rem"}},null,8,["icon"]),i[7]||(i[7]=o(" Engage Safety Locks by Default"))])]),"top-right":s(()=>[r(e.MInputSwitch,{class:"tw-relative tw-top-1.5","model-value":e.uiStore.isSafetyLockOn,name:"safetyToggleEnabled","onUpdate:modelValue":i[0]||(i[0]=n=>e.uiStore.toggleSafetyLock(n))},null,8,["model-value"])]),_:1}),r(e.MListItem,null,{"top-right":s(()=>[r(e.MInputSwitch,{class:"tw-relative tw-top-1.5","model-value":e.uiStore.showDeveloperUi,disabled:!e.permissions.doesHavePermission("dashboard.developer_mode"),name:"isDeveloperUiShown",permission:"dashboard.developer_mode","onUpdate:modelValue":i[1]||(i[1]=n=>e.uiStore.toggleDeveloperUi(n))},null,8,["model-value","disabled"])]),default:s(()=>[i[9]||(i[9]=o("Show Developer UI")),r(e.MBadge,{class:"tw-ml-1",tooltip:"Adds advanced technical information onto most pages.",shape:"pill"},{default:s(()=>i[8]||(i[8]=[o("?")]),void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})]),default:s(()=>[r(w,{"align-h":"center"},{default:s(()=>[r(v,{lg:"6"},{default:s(()=>[r(I,{title:"Permissions",description:"These are the combined permissions granted by all your roles.",emptyMessage:"You have no permissions on this user account!",searchFields:["permissionDetails.group","permissionDetails.name","permissionDetails.description"],itemList:e.decoratedPermissions,getItemKey:e.getPermissionsItemKey,sortOptions:e.permissionListSortOptions,defaultSortOption:1,filterSets:e.permissionListFilterSets,"data-testid":"user-permissions-card"},{"item-card":s(n=>[r(e.MListItem,null,{"bottom-left":s(()=>[n.item.hasPermission?q("",!0):(d(),c("div",ie,"You do not have this permission.")),M("div",null,m(n.item.permissionDetails.description),1)]),"top-right":s(()=>[o(m(n.item.permissionDetails.group),1)]),default:s(()=>[r(e.MBadge,{variant:n.item.hasPermission?"success":"neutral"},{default:s(()=>[o(m(n.item.permissionDetails.name),1)],void 0,!0),_:2},1032,["variant"])],void 0,!0),_:2},1024)]),_:1},8,["itemList","filterSets"])],void 0,!0),_:1}),r(v,{lg:"6"},{default:s(()=>[r(h,{class:"shadow-sm mb-3",style:J(e.canAssumeRoles?"":"bg-light"),"data-testid":"assume-role-card"},{default:s(()=>[r(k,null,{default:s(()=>i[10]||(i[10]=[o("Assume Roles")]),void 0,!0),_:1}),e.canAssumeRoles?(d(),c("div",re,[i[11]||(i[11]=M("div",{class:"small mb-3"},"This is an advanced developer feature for quickly testing different roles.",-1)),r(e.MInputMultiSelectCheckbox,{"model-value":e.rolesToAssume,options:e.allRolesSorted,vertical:"","onUpdate:modelValue":i[2]||(i[2]=n=>e.rolesToAssume=n)},null,8,["model-value","options"])])):(d(),c("div",ne,"Assuming roles is disabled in this environment."))],void 0,!0),_:1},8,["style"])],void 0,!0),_:1})],void 0,!0),_:1}),r(b,{kvPair:e.gameServerApiStore.auth.userDetails,name:"userDetails"},null,8,["kvPair"]),r(b,{kvPair:e.staticInfos.liveOpsDashboardInfo.authConfig,name:"authConfig"},null,8,["kvPair"])],void 0,!0),_:1})}const ge=Q($,[["render",oe],["__file","UserView.vue"]]);export{ge as default};
