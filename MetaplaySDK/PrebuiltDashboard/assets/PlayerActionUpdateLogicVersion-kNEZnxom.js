import{d as M,z as S,x as c,f,a3 as V,c as d,ad as v,ae as b,o as x,e as k,w as C,n as u,k as A,l as O,_ as B}from"./index-B7jvAjdE.js";import{M as N}from"./MActionModalButton-CvWVuTB-.js";import{M as P}from"./MInputSingleSelectRadio-BukGu4ZH.js";import{a as y}from"./players-CydHenLG.js";import"./MActionModal-coQLkvWs.js";import"./index-fVjXqxSF.js";import"./index-CDBqmjrS.js";import"./index-B_QkKjtG.js";import"./MInputHintMessage-DbuBS4Kn.js";const I=M({__name:"PlayerActionUpdateLogicVersion",props:{playerId:{}},setup(p,{expose:i}){i();const{showSuccessNotification:r}=b(),e=p,n=S(),s=v(),{data:t,refresh:g}=c(y(e.playerId)),a=f(t.value.model.logicVersion),{data:l}=c(V());function L(){a.value=t.value.model.logicVersion}const w=d(()=>a.value!==t.value.model.logicVersion),_=d(()=>n.supportedLogicVersionOptions?n.supportedLogicVersionOptions.filter(o=>l.value.clientCompatibilitySettings.activeLogicVersionRange.minVersion<=o&&l.value.clientCompatibilitySettings.activeLogicVersionRange.maxVersion>=o||o===t.value.model.logicVersion).map(o=>({label:o===t.value.model.logicVersion?`${o} (current)`:String(o),value:o,disabled:o<t.value.model.logicVersion})):[]);async function h(){await s.post(`/players/${t.value.id}/updateLogicVersion`,{newLogicVersion:a.value}),r(`${t.value.model.playerName||"n/a"} update to ${a.value}.`),g()}const m={showSuccessNotification:r,props:e,coreStore:n,gameServerApi:s,playerData:t,playerRefresh:g,selectedLogicVersion:a,backendStatusData:l,resetModal:L,isStatusChanged:w,logicVersionOptions:_,updateLogicVersion:h,computed:d,ref:f,get useGameServerApi(){return v},get MInputSingleSelectRadio(){return P},get MActionModalButton(){return N},get useNotifications(){return b},get useSubscription(){return c},get useCoreStore(){return S},get getBackendStatusSubscriptionOptions(){return V},get getSinglePlayerSubscriptionOptions(){return y}};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}}),R={class:"tw-flex tw-justify-between"};function U(p,i,r,e,n,s){return e.playerData?(x(),k(e.MActionModalButton,{key:0,"modal-title":"Update Logic Version",action:e.updateLogicVersion,"trigger-button-label":"Update Logic Version",variant:"warning","ok-button-label":"Save Settings","ok-button-disabled-tooltip":e.isStatusChanged?void 0:"Select a different logic version to update the player.","trigger-button-disabled-tooltip":e.playerData.model.logicVersion==e.coreStore.supportedLogicVersions.maxVersion?"Player is already at the highest active logic version.":void 0,permission:"api.players.update_logic_version",onShow:e.resetModal,"data-testid":"action-update-logic-version-player"},{default:C(()=>[u("div",R,[i[1]||(i[1]=u("span",{class:"tw-font-semibold"},"Logic Version",-1)),A(e.MInputSingleSelectRadio,{class:"tw-relative","model-value":e.selectedLogicVersion,name:"logicVersionInput",size:"small",options:e.logicVersionOptions,"onUpdate:modelValue":i[0]||(i[0]=t=>e.selectedLogicVersion=t),"data-testid":"player-logic-version-input"},null,8,["model-value","options"])]),i[2]||(i[2]=u("span",{class:"tw-text-xs+ tw-text-neutral-500"},"Changing the player's logic version will disconnect the player and force them to update to a newer version of the game client before they can reconnect.",-1))],void 0,!0),_:1},8,["ok-button-disabled-tooltip","trigger-button-disabled-tooltip"])):O("",!0)}const K=B(I,[["render",U],["__file","PlayerActionUpdateLogicVersion.vue"]]);export{K as default};
