import{d as b,ac as A,b as M,o as s,e as u,w as a,k as l,n,_,z as y,x as v,a8 as x,p as m,l as p,aj as S,c as f,al as G,af as I,ah as O,a0 as P,ai as k,B as T}from"./index-B7jvAjdE.js";import{M as V,a as z}from"./MViewContainer-BTeE2xDT.js";import B from"./MetaRawData-CedjqGjJ.js";import{C as D}from"./CoreUiPlacement-CPf1fwrN.js";import{g as w}from"./guilds-LGK3Q8Wf.js";import{O as E}from"./OverviewList-9VTc2d9x.js";import"./utils-Dwlepb3M.js";import"./MetaCountryCode-OZPd0ilg.js";import"./MetaTime-D0iYB_lr.js";import"./MetaLanguageLabel-CAF0iIvu.js";const N=b({__name:"GuildAdminActionsCard",props:{guildId:{}},setup(g,{expose:t}){t();const r={get MCard(){return A},CoreUiPlacement:D};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}}),j={class:"tw-flex tw-flex-wrap tw-justify-center tw-gap-y-3 tw-@container"},L={class:"tw-basis-full tw-pr-1.5 tw-@container @sm:tw-basis-1/2"},U={class:"tw-basis-full tw-pl-1.5 tw-@container @sm:tw-basis-1/2"};function F(g,t,r,e,i,o){const c=M("fa-icon");return s(),u(e.MCard,{title:"Admin Tools",id:"guild-admin-actions-card"},{icon:a(()=>[l(c,{icon:"wrench"})]),default:a(()=>[n("div",j,[n("div",L,[t[0]||(t[0]=n("div",{class:"tw-mb-1 tw-font-bold tw-leading-6"},"Gentle Actions",-1)),l(e.CoreUiPlacement,{placementId:"Guilds/Details/AdminActions:Gentle",guildId:r.guildId,alwaysFullWidth:"",smallBottomMargin:""},null,8,["guildId"])]),n("div",U,[t[1]||(t[1]=n("div",{class:"tw-mb-1 tw-font-bold tw-leading-6"},"Disruptive Actions",-1)),l(e.CoreUiPlacement,{placementId:"Guilds/Details/AdminActions:Disruptive",guildId:r.guildId,alwaysFullWidth:"",smallBottomMargin:""},null,8,["guildId"])])])],void 0,!0),_:1})}const R=_(N,[["render",F],["__file","GuildAdminActionsCard.vue"]]),W=b({__name:"GuildOverviewCard",props:{guildId:{}},setup(g,{expose:t}){t();const r=y(),e=g,{data:i}=v(w(e.guildId)),o={coreStore:r,props:e,guildData:i,get MPageOverviewCard(){return V},get MTextButton(){return x},get useSubscription(){return v},get useCoreStore(){return y},get getSingleGuildSubscriptionOptions(){return w},OverviewList:E};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}});function H(g,t,r,e,i,o){const c=M("meta-abbreviate-number");return e.guildData?(s(),u(e.MPageOverviewCard,{key:0,id:e.guildData.model.guildId,title:e.guildData.model.displayName||"☠️ Closed","sub-title":e.guildData.model.description},{caption:a(()=>[t[0]||(t[0]=m("Save file size: ")),l(e.MTextButton,{permission:"api.database.inspect_entity",to:`/entities/${e.guildData.model.guildId}/dbinfo`,"data-testid":"model-size-link"},{default:a(()=>[l(c,{value:e.guildData.persistedSize,unit:"byte"},null,8,["value"])],void 0,!0),_:1},8,["to"])]),default:a(()=>[l(e.OverviewList,{listTitle:"Overview",icon:"chart-bar",sourceObject:e.guildData,items:e.coreStore.overviewLists.guild},null,8,["sourceObject","items"])],void 0,!0),_:1},8,["id","title","sub-title"])):p("",!0)}const q=_(W,[["render",H],["__file","GuildOverviewCard.vue"]]),J=b({__name:"GuildDetailView",setup(g,{expose:t}){t();const r=S(),e=f(()=>G(r.params.id)),{data:i,error:o}=v(w(e.value)),c=f(()=>{if(o.value){const d=o.value;return d.response?.status===400?"error-bad-id":d.response?.status===404?"error-not-found":"error-unknown"}else return i.value?.isInitialized===!1?"error-entity-uninitialized":i.value?"success":"loading"});I().setDynamicTitle(i,d=>`Manage ${d.value?.model.displayName||"Guild"}`);const h=f(()=>{const d=[];return i.value?.model&&(i.value.model.lifecyclePhase==="Closed"?d.push({title:"☠️ Guild Closed",message:"This guild has no players and has been closed.",variant:"danger",dataTest:"guild-closed-alert"}):(i.value.model.lifecyclePhase==="WaitingForSetup"||i.value.model.lifecyclePhase==="WaitingForLeader")&&d.push({title:"Guild-in-Progress",message:"All our actors are busy creating this guild and will be with you momentarily, please hold.",variant:"warning",dataTest:"guild-in-progress-alert"})),d}),C={route:r,guildId:e,singleGuildData:i,singleGuildError:o,fetchStatus:c,alerts:h,get AxiosError(){return O},computed:f,get useRoute(){return S},get MetaRawData(){return B},get MCallout(){return P},get MErrorCallout(){return k},get MTextButton(){return x},get MViewContainer(){return z},get useHeaderbar(){return I},get useSubscription(){return v},GuildAdminActionsCard:R,GuildOverviewCard:q,CoreUiPlacement:D,get routeParamToSingleValue(){return G},get getSingleGuildSubscriptionOptions(){return w}};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}}),K={class:"tw-mx-auto tw-mb-10 tw-max-w-2xl tw-@container"};function Q(g,t,r,e,i,o){return s(),u(e.MViewContainer,{alerts:e.alerts,"is-loading":e.fetchStatus==="loading"},T({overview:a(()=>[l(e.GuildOverviewCard,{guildId:e.guildId},null,8,["guildId"])]),default:a(()=>[n("div",K,[l(e.GuildAdminActionsCard,{guildId:e.guildId},null,8,["guildId"])]),t[6]||(t[6]=n("h3",{class:"tw-my-5"},"Game State",-1)),l(e.CoreUiPlacement,{placementId:"Guilds/Details/GameState",guildId:e.guildId},null,8,["guildId"]),t[7]||(t[7]=n("h3",{class:"tw-my-5"},"Guild & Admin Logs",-1)),l(e.CoreUiPlacement,{placementId:"Guilds/Details/GuildAdminLogs",guildId:e.guildId},null,8,["guildId"]),l(e.MetaRawData,{kvPair:e.singleGuildData,name:"guild"},null,8,["kvPair"])]),_:2},[e.fetchStatus.includes("error")?{name:"errors",fn:a(()=>[e.fetchStatus==="error-bad-id"||e.fetchStatus==="error-unknown"?(s(),u(e.MErrorCallout,{key:0,error:e.singleGuildError},null,8,["error"])):e.fetchStatus==="error-not-found"?(s(),u(e.MCallout,{key:1,title:"Guild Not Found",variant:"danger"},{default:a(()=>t[0]||(t[0]=[m("This guild does not exist. Are you looking in the correct deployment?")]),void 0,!0),_:1})):e.fetchStatus==="error-entity-uninitialized"?(s(),u(e.MCallout,{key:2,title:"Guild Not Initialized",variant:"danger"},{default:a(()=>t[1]||(t[1]=[m("This guild has not yet been initialized. This is likely a temporary state for a new guild, but indicates a problem if the state persists.")]),void 0,!0),_:1})):p("",!0),e.fetchStatus==="error-unknown"||e.fetchStatus==="error-entity-uninitialized"?(s(),u(e.MCallout,{key:3,class:"tw-mt-3",title:"Debugging",variant:"danger"},{default:a(()=>[t[5]||(t[5]=n("p",null,"The following tool may be able to give you more information about this error:",-1)),n("ul",null,[n("li",null,[t[3]||(t[3]=m("Use ")),l(e.MTextButton,{to:`/entities/${e.guildId}/dbinfo`,permission:"api.database.inspect_entity","data-testid":"model-size-link"},{default:a(()=>t[2]||(t[2]=[m("save file inspector")]),void 0,!0),_:1},8,["to"]),t[4]||(t[4]=m(" to inspect entity data saved on the database."))])])],void 0,!0),_:1})):p("",!0)]),key:"0"}:void 0]),1032,["alerts","is-loading"])}const ne=_(J,[["render",Q],["__file","GuildDetailView.vue"]]);export{ne as default};
