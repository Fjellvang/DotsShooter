import{d as H,z as E,aj as I,al as U,x,cn as z,cH as F,A as q,c as C,M as R,s as J,v as Q,a8 as W,b as r,o as d,e as D,w as e,k as n,n as o,p as l,a as p,F as B,r as A,t as u,l as V,B as X,_ as Y}from"./index-B7jvAjdE.js";import{M as Z,a as $}from"./MViewContainer-BTeE2xDT.js";import{M,a as N,c,b as j}from"./metaListUtils-B-xQ0HnD.js";import{M as tt}from"./MetaAudienceSizeEstimate-CCTh_xY2.js";const et=H({__name:"SegmentDetailView",setup(K,{expose:i}){i();const k=E(),a=I(),L=U(a.params.id),{data:S}=x(z()),{data:g,error:f}=x(F(L)),{data:_}=x(q());function h(t){return S.value?.segments?Object.values(S.value.segments).find(m=>m.info.configKey===t).info.displayName:"Loading..."}const y=C(()=>_.value?.activablesMetadata),P=C(()=>{if(!(!g.value||!y.value))return g.value.details.usedBy.map(t=>{switch(t.type){case"Activable":{const m=t.subtype,s=y.value.kinds[m].category,v=y.value?.categories[s].shortSingularDisplayName,G="/"+(k.gameSpecific.activableCustomization[s]?.pathName||`activables/${s}`);return{type:t.type,displayType:v,displayName:t.displayName,icon:k.gameSpecific.activableCustomization[s]?.icon||"calendar-alt",linkUrl:`${G}/${m}/${t.id}`,linkText:v,activableCategory:s}}case"Offer":return{type:t.type,displayType:t.type,displayName:t.displayName,icon:"tags",linkUrl:`/offerGroups/offer/${t.id}`,linkText:t.type};case"Broadcast":return{type:t.type,displayType:t.type,displayName:t.displayName,icon:"broadcast-tower",linkUrl:`/broadcasts/${t.id}`,linkText:t.type};case"Experiment":return{type:t.type,displayType:t.type,displayName:t.displayName,icon:"flask",linkUrl:`/experiments/${t.id}`,linkText:t.type};case"Notification":return{type:t.type,displayType:t.type,displayName:t.displayName,icon:"comment-alt",linkUrl:`/notifications/${t.id}`,linkText:t.type};case"Segment":return{type:t.type,displayType:t.type,displayName:t.displayName,icon:"user-tag",linkUrl:`/segments/${t.id}`,linkText:t.type};case"LiveOpsEvent":return{type:t.type,displayType:t.type,displayName:t.displayName,icon:"calendar-alt",linkUrl:`/liveOpsEvents/${t.id}`,linkText:"event"};default:return{type:t.type,displayType:t.type,displayName:t.displayName,icon:"question-circle",linkUrl:"",linkText:""}}})});function b(){const t=[];for(const m in y.value?.categories){const s=y.value.categories[m];t.push(new c(s.displayName,v=>v.type==="Activable"&&v.activableCategory===m))}return t}const T=C(()=>[new j("type",[new c("Segments",t=>t.type==="Segment"),new c("Broadcasts",t=>t.type==="Broadcast"),new c("Experiments",t=>t.type==="Experiment"),new c("Notifications",t=>t.type==="Notification"),new c("Offers",t=>t.type==="Offer"),new c("LiveOps Events",t=>t.type==="LiveOpsEvent"),...b()].sort((t,m)=>t.displayName.localeCompare(m.displayName)))]),O=[new M("Type","type",N.Ascending),new M("Type","type",N.Descending),new M("Name","displayName",N.Ascending),new M("Name","displayName",N.Descending)],w={coreStore:k,route:a,segmentId:L,allPlayerSegmentsData:S,singlePlayerSegmentData:g,singlePlayerSegmentError:f,staticConfigData:_,getSegmentNameById:h,activablesMetadata:y,referenceList:P,activableKindFilters:b,filterSets:T,referencesSortOptions:O,computed:C,get useRoute(){return I},get MetaListFilterOption(){return c},get MetaListFilterSet(){return j},get MetaListSortDirection(){return N},get MetaListSortOption(){return M},get MBadge(){return R},get MList(){return J},get MListItem(){return Q},get MPageOverviewCard(){return Z},get MTextButton(){return W},get MViewContainer(){return $},get useSubscription(){return x},MetaAudienceSizeEstimate:tt,get useCoreStore(){return E},get routeParamToSingleValue(){return U},get getPlayerSegmentsSubscriptionOptions(){return z},get getSinglePlayerSegmentSubscriptionOptions(){return F},get getStaticConfigSubscriptionOptions(){return q}};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),at={class:"font-weight-bold"},nt={key:0},it={class:"pl-2 pr-2 pt-1 pb-1 bg-light rounded border mb-3"},st={key:1},lt={class:"tw-mb-1"},ot={key:0,class:"font-weight-bold"},dt={key:1,class:"font-weight-bold"},rt={key:2},mt={class:"tw-mb-1"},pt={key:0,class:"font-weight-bold"},yt={key:1,class:"font-weight-bold"},gt={class:"tw-ml-1"};function ut(K,i,k,a,L,S){const g=r("fa-icon"),f=r("b-td"),_=r("b-tr"),h=r("b-tbody"),y=r("b-table-simple"),P=r("b-row"),b=r("b-th"),T=r("b-thead"),O=r("b-card"),w=r("b-col"),t=r("meta-list-card"),m=r("meta-raw-data");return d(),D(a.MViewContainer,{permission:"api.segmentation.view","is-loading":!a.singlePlayerSegmentData,error:a.singlePlayerSegmentError},{overview:e(()=>[n(a.MPageOverviewCard,{id:a.singlePlayerSegmentData.details.info.segmentId,title:a.singlePlayerSegmentData.details.info.displayName,subtitle:a.singlePlayerSegmentData.details.info.description,"data-testid":"player-segment-detail-overview-card"},{default:e(()=>[o("div",at,[n(g,{icon:"chart-bar"}),i[0]||(i[0]=l(" Overview"))]),n(y,{small:"",responsive:""},{default:e(()=>[n(h,null,{default:e(()=>[n(_,null,{default:e(()=>[n(f,null,{default:e(()=>i[1]||(i[1]=[l("Audience Size Estimate")]),void 0,!0),_:1}),n(f,{class:"text-right"},{default:e(()=>[n(a.MetaAudienceSizeEstimate,{sizeEstimate:a.singlePlayerSegmentData.details.sizeEstimate},null,8,["sizeEstimate"])],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1},8,["id","title","subtitle"])]),default:e(()=>[n(P,{class:"mb-2 tw-mt-4","no-gutters":"","align-v":"center"},{default:e(()=>i[2]||(i[2]=[o("h3",null,"Configuration",-1)]),void 0,!0),_:1}),n(P,{"align-h":"center"},{default:e(()=>[n(w,{class:"tw-mb-4",lg:"6"},{default:e(()=>[n(O,{class:"h-100 shadow-sm",title:"Conditions","data-testid":"player-segment-detail-conditions-card"},{default:e(()=>[a.singlePlayerSegmentData.details.info.playerCondition.propertyRequirements?(d(),p("span",nt,[i[6]||(i[6]=o("div",null,[o("span",{class:"font-weight-bold"},[l("Must match "),o("span",{class:"font-weight-bold tw-italic"},"all"),l(" properties")])],-1)),o("div",it,[n(y,{class:"m-0",small:"",responsive:""},{default:e(()=>[n(T,null,{default:e(()=>[n(_,null,{default:e(()=>[n(b,{class:"border-0 pl-0"},{default:e(()=>i[3]||(i[3]=[l("Property")]),void 0,!0),_:1}),n(b,{class:"border-0 tw-text-center"},{default:e(()=>i[4]||(i[4]=[l("Min")]),void 0,!0),_:1}),n(b,{class:"border-0 tw-text-center"},{default:e(()=>i[5]||(i[5]=[l("Max")]),void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),n(h,null,{default:e(()=>[(d(!0),p(B,null,A(a.singlePlayerSegmentData.details.info.playerCondition.propertyRequirements,s=>(d(),D(_,{key:s.id.displayName},{default:e(()=>[n(f,{class:"small",style:{"padding-left":"0.1rem"}},{default:e(()=>[l(u(s.id.displayName),1)],void 0,!0),_:2},1024),n(f,{class:"small tw-text-center"},{default:e(()=>[l(u(s.min?.constantValue),1)],void 0,!0),_:2},1024),n(f,{class:"small tw-text-center"},{default:e(()=>[l(u(s.max?.constantValue),1)],void 0,!0),_:2},1024)],void 0,!0),_:2},1024))),128))],void 0,!0),_:1})],void 0,!0),_:1})])])):V("",!0),a.singlePlayerSegmentData.details.info.playerCondition.requireAnySegment&&a.singlePlayerSegmentData.details.info.playerCondition.requireAnySegment.length>0?(d(),p("span",st,[o("div",lt,[a.singlePlayerSegmentData.details.info.playerCondition.propertyRequirements?(d(),p("span",ot,i[7]||(i[7]=[l("And must match "),o("span",{class:"font-weight-bold tw-italic"},"any",-1),l(" segments from")]))):(d(),p("span",dt,i[8]||(i[8]=[l("Must match "),o("span",{class:"font-weight-bold tw-italic"},"at least one",-1),l(" of these segments:")])))]),n(a.MList,{showBorder:""},{default:e(()=>[(d(!0),p(B,null,A(a.singlePlayerSegmentData.details.info.playerCondition.requireAnySegment,s=>(d(),D(a.MListItem,{class:"tw-px-3",key:s,condensed:""},{"top-right":e(()=>[n(a.MTextButton,{to:`/segments/${s}`},{default:e(()=>i[9]||(i[9]=[l("View segment")]),void 0,!0),_:2},1032,["to"])]),default:e(()=>[o("span",null,[n(g,{class:"tw-mr-1",icon:"user-tag"}),l(" "+u(a.getSegmentNameById(s)),1)])],void 0,!0),_:2},1024))),128))],void 0,!0),_:1})])):V("",!0),a.singlePlayerSegmentData.details.info.playerCondition.requireAllSegments&&a.singlePlayerSegmentData.details.info.playerCondition.requireAllSegments.length>0?(d(),p("span",rt,[o("div",mt,[a.singlePlayerSegmentData.details.info.playerCondition.propertyRequirements||a.singlePlayerSegmentData.details.info.playerCondition.requireAnySegment?(d(),p("span",pt,i[10]||(i[10]=[l("And must match "),o("span",{class:"font-weight-bold tw-italic"},"all",-1),l(" segments from")]))):(d(),p("span",yt,i[11]||(i[11]=[l("Must match "),o("span",{class:"font-weight-bold tw-italic"},"all",-1),l(" of these segments:")])))]),n(a.MList,{showBorder:""},{default:e(()=>[(d(!0),p(B,null,A(a.singlePlayerSegmentData.details.info.playerCondition.requireAllSegments,s=>(d(),D(a.MListItem,{class:"tw-px-3",key:s,condensed:""},{"top-right":e(()=>[n(a.MTextButton,{to:`/segments/${s}`},{default:e(()=>i[12]||(i[12]=[l("View segment")]),void 0,!0),_:2},1032,["to"])]),default:e(()=>[o("span",null,[n(g,{class:"tw-mr-1",icon:"user-tag"}),l(" "+u(a.getSegmentNameById(s)),1)])],void 0,!0),_:2},1024))),128))],void 0,!0),_:1})])):V("",!0)],void 0,!0),_:1})],void 0,!0),_:1}),n(w,{lg:"6"},{default:e(()=>[n(t,{class:"h-100",title:"Referenced by",icon:"exchange-alt",tooltip:"Other game systems that reference this segment in their conditions or targeting.",itemList:a.referenceList,searchFields:["displayName","type"],filterSets:a.filterSets,sortOptions:a.referencesSortOptions,emptyMessage:"No game systems reference this segment.","data-testid":"player-segment-detail-references-card"},{"item-card":e(({item:s})=>[n(a.MListItem,null,X({default:e(()=>[n(a.MBadge,null,{icon:e(()=>[n(g,{icon:s.icon},null,8,["icon"])]),default:e(()=>[l(u(s.displayType),1)],void 0,!0),_:2},1024),o("span",gt,u(s.displayName),1)],void 0,!0),_:2},[s.linkUrl?{name:"top-right",fn:e(()=>[n(a.MTextButton,{to:s.linkUrl},{default:e(()=>[l("View "+u(`${s.linkText.toLocaleLowerCase()}`),1)],void 0,!0),_:2},1032,["to"])]),key:"0"}:void 0,s.type==="Activable"?{name:"bottom-right",fn:e(()=>[]),key:"1"}:void 0]),1024)]),_:1},8,["itemList","filterSets"])],void 0,!0),_:1})],void 0,!0),_:1}),n(m,{kvPair:a.singlePlayerSegmentData,name:"segment"},null,8,["kvPair"])],void 0,!0),_:1},8,["is-loading","error"])}const wt=Y(et,[["render",ut],["__file","SegmentDetailView.vue"]]);export{wt as default};
