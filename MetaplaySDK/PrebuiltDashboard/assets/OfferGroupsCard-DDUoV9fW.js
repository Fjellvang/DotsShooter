import{d as A,x as C,A as P,c as f,v as L,b,o as i,e as y,w as r,p as d,n as N,$ as B,t as p,a as s,l as v,k as m,F as R,r as F,_ as G}from"./index-B7jvAjdE.js";import{M as o,a as l}from"./metaListUtils-B-xQ0HnD.js";import{g as k,a as M}from"./offers-DYY0Z2EJ.js";import{M as T}from"./MetaActivablePhaseBadge-DS0XHNhH.js";import{M as E}from"./MetaActivablesBaseCard-4tvZk2v-.js";const I=A({__name:"OfferGroupsCard",props:{title:{},emptyMessage:{},hideDisabled:{type:Boolean},hideConversion:{type:Boolean},hidePlacement:{type:Boolean},hidePriority:{type:Boolean},hideRevenue:{type:Boolean},playerId:{},customEvaluationIsoDateTime:{},placement:{},longList:{type:Boolean},hideCollapse:{type:Boolean},defaultSortOption:{}},setup(w,{expose:a}){a();const t=w,{data:n}=C(P()),_=f(()=>n.value?.activablesMetadata),x=f(()=>_.value?.categories.OfferGroup.shortSingularDisplayName),{data:g,refresh:O}=C(()=>t.playerId?k(t.playerId,t.customEvaluationIsoDateTime):M(t.customEvaluationIsoDateTime)),h=f(()=>g.value?{OfferGroup:{activables:Object.fromEntries(Object.entries(g.value.offerGroups).filter(([ee,D])=>!t.placement||D.config.placement===t.placement))}}:null),S=["activable.config.displayName","activable.config.description","phaseDisplayString"],e=f(()=>{const c=[o.asUnsorted(),new o("Priority","activable.config.priority",l.Ascending),new o("Priority","activable.config.priority",l.Descending),new o("Phase","phaseSortOrder",l.Ascending),new o("Phase","phaseSortOrder",l.Descending),new o("Name","activable.config.displayName",l.Ascending),new o("Name","activable.config.displayName",l.Descending)];return t.hideConversion||(c.push(new o("Conversion","conversion",l.Ascending)),c.push(new o("Conversion","conversion",l.Descending))),t.hideRevenue||(c.push(new o("Revenue","activable.revenue",l.Ascending)),c.push(new o("Revenue","activable.revenue",l.Descending))),c}),u={props:t,staticConfig:n,activablesMetadata:_,categoryDisplayName:x,offersData:g,offersRefresh:O,activables:h,searchFields:S,sortOptions:e,computed:f,get MetaListSortDirection(){return l},get MetaListSortOption(){return o},get MListItem(){return L},get useSubscription(){return C},get getStaticConfigSubscriptionOptions(){return P},get getAllOffersSubscriptionOptions(){return M},get getAllOffersForPlayerSubscriptionOptions(){return k},MetaActivablePhaseBadge:T,MetaActivablesBaseCard:E};return Object.defineProperty(u,"__isScriptSetup",{enumerable:!1,value:!0}),u}}),V={key:0},j={key:1},z={key:1,class:"ml-1"},U={key:2},W={key:0,class:"text-muted tw-italic"},q={key:1},H={key:2,class:"text-muted tw-italic"},J={key:3,class:"text-muted tw-italic"},K={key:1,class:"text-muted tw-italic"},Q={key:2,class:"text-muted tw-italic"},X={key:1,class:"text-muted tw-italic"},Y={key:2,class:"text-muted tw-italic"},Z={key:0,class:"text-muted"};function $(w,a,t,n,_,x){const g=b("meta-ordinal-number"),O=b("meta-time"),h=b("meta-duration"),S=b("meta-plural-label");return i(),y(n.MetaActivablesBaseCard,{hideDisabled:t.hideDisabled,hideConversion:t.hideConversion,activables:n.activables,playerId:t.playerId,category:"OfferGroup",longList:t.longList,emptyMessage:t.emptyMessage,title:t.title,hideCollapse:t.hideCollapse,linkUrlPrefix:"/offerGroups",searchFields:n.searchFields,sortOptions:n.sortOptions,defaultSortOption:t.defaultSortOption,permission:"api.activables.view",onRefreshActivables:n.offersRefresh},{displayShortInfo:r(({item:e})=>[a[0]||(a[0]=d("(")),N("span",{class:B(e.activable.config.displayShortInfo.startsWith("0")?"text-warning":"text-muted")},p(e.activable.config.displayShortInfo),3),a[1]||(a[1]=d(")"))]),additionalTexts:r(({item:e})=>[t.hidePlacement?v("",!0):(i(),s("div",V,"Placement: "+p(e.activable.config.placement),1)),t.hidePriority?v("",!0):(i(),s("div",j,[a[2]||(a[2]=d("Priority:")),e.activable.config.priority>0?(i(),y(g,{key:0,class:"ml-1",number:e.activable.config.priority},null,8,["number"])):(i(),s("span",z,p(e.activable.config.priority),1))])),t.hideRevenue?v("",!0):(i(),s("div",U,"Revenue: $"+p(e.activable.revenue.toFixed(2)),1))]),collapseContents:r(({item:e})=>[m(n.MListItem,{condensed:""},{"top-right":r(()=>[e.activable.config.activableParams.isEnabled?e.nextPhase?(i(),s("span",q,[m(n.MetaActivablePhaseBadge,{activable:e.activable,phase:e.nextPhase,playerId:t.playerId,typeName:`${n.categoryDisplayName?.toLocaleLowerCase()}`},null,8,["activable","phase","playerId","typeName"]),a[3]||(a[3]=d()),e.nextPhaseStartTime?(i(),y(O,{key:0,date:e.nextPhaseStartTime},null,8,["date"])):v("",!0)])):e.scheduleStatus?(i(),s("span",H,"None")):(i(),s("span",J,"No schedule")):(i(),s("span",W,"Disabled"))]),default:r(()=>[a[4]||(a[4]=d("Next Schedule Phase"))],void 0,!0),_:2},1024),m(n.MListItem,{condensed:""},{"top-right":r(()=>[e.activable.state.hasOngoingActivation&&e.activable.state.activationRemaining!==null?(i(),y(h,{key:0,duration:e.activable.state.activationRemaining,showAs:"humanizedSentenceCase"},null,8,["duration"])):e.activable.state.hasOngoingActivation?(i(),s("span",K,"Forever")):(i(),s("span",Q,"n/a"))]),default:r(()=>[a[5]||(a[5]=d("Lifetime Left"))],void 0,!0),_:2},1024),m(n.MListItem,{condensed:""},{"top-right":r(()=>[e.activable.state.isInCooldown&&e.activable.state.cooldownRemaining!==null?(i(),y(h,{key:0,duration:e.activable.state.cooldownRemaining,showAs:"humanizedSentenceCase"},null,8,["duration"])):e.activable.state.isInCooldown?(i(),s("span",X,"Forever")):(i(),s("span",Y,"n/a"))]),default:r(()=>[a[6]||(a[6]=d("Cooldown Left"))],void 0,!0),_:2},1024),m(n.MListItem,{condensed:""},{"top-right":r(()=>[(i(!0),s(R,null,F(e.activable.offers,(u,c)=>(i(),s("div",{key:c},[d(p(u.config.displayName)+" ",1),u.referencePrice!==null?(i(),s("span",Z,"("+p(u.referencePrice)+")",1)):v("",!0),a[7]||(a[7]=d(" - ")),m(S,{value:u.state.numPurchasedInGroup,label:"purchase"},null,8,["value"])]))),128))]),default:r(()=>[a[8]||(a[8]=d("Individual Offers"))],void 0,!0),_:2},1024)]),_:1},8,["hideDisabled","hideConversion","activables","playerId","longList","emptyMessage","title","hideCollapse","sortOptions","defaultSortOption","onRefreshActivables"])}const oe=G(I,[["render",$],["__file","OfferGroupsCard.vue"]]);export{oe as O};
