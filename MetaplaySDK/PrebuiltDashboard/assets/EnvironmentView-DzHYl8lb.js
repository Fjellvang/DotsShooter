import{d as H,f as z,ac as je,bM as rt,o as f,e as _,B as at,w as b,a2 as ge,a as y,$ as L,n as l,k as S,p as T,l as I,_ as Z,x as N,dw as U,c as D,C as De,ab as Ie,dx as Ne,ad as Le,O as it,b as B,F as $,r as j,t as x,M as ue,v as ke,dy as G,N as qe,bb as He,a8 as Ze,Z as be,i as re,dz as Fe,q as ot,ci as lt,ca as ie,dA as Re,s as ct,bd as ut,a6 as Ee,a3 as Oe,a4 as Pe,ai as dt}from"./index-B7jvAjdE.js";import{M as pt,a as ht}from"./MViewContainer-BTeE2xDT.js";import{M as gt}from"./MSingleColumnLayout-B4K0ZAFA.js";import{M as ft}from"./MTabLayout-CxB_BuXt.js";import{M as mt}from"./MTwoColumnLayout-C4tHp69a.js";import{M as bt}from"./MActionModalButton-CvWVuTB-.js";import{M as Ue}from"./MModal-CihxrIfO.js";import{M as wt}from"./MInputText-CzhsT8yb.js";import Ge from"./MetaListCard-CSSWUW2Z.js";import{M as ne,a as fe,b as me,c as V}from"./metaListUtils-B-xQ0HnD.js";import"./MInputSimpleSelectDropdown-DIlBEFcs.js";import"./index-qTA83-by.js";import"./MInputHintMessage-DbuBS4Kn.js";import"./MActionModal-coQLkvWs.js";import"./index-fVjXqxSF.js";import"./debounce-B8gTqdZO.js";import"./isSymbol-B7ZrWRtH.js";import"./MInputMultiSelectCheckbox-D_9f7ub1.js";import"./MInputCheckbox-BqateWtE.js";import"./index-B_QkKjtG.js";import"./MInputSingleSelectRadio-BukGu4ZH.js";import"./index-CDBqmjrS.js";import"./utils-Dwlepb3M.js";import"./_baseIteratee-BXhw53re.js";import"./toString-DMHXP3G8.js";import"./identity-DKeuBCMA.js";import"./button-group-BUOztpby.js";const kt=H({__name:"MCollapseCard",props:{title:{},subtitle:{},badge:{}},setup(u,{expose:e}){e();const t={isOpen:z(!1),ref:z,MCard:je,MTransitionCollapse:rt};return Object.defineProperty(t,"__isScriptSetup",{enumerable:!1,value:!0}),t}}),xt={key:0};function yt(u,e,n,t,s,i){return f(),_(t.MCard,{title:n.title,subtitle:n.subtitle,badge:n.badge,badgeVariant:t.isOpen?"primary":"neutral",clickableHeader:"",noBodyPadding:"",onHeaderClick:e[0]||(e[0]=r=>t.isOpen=!t.isOpen)},at({subtitle:b(()=>[ge(u.$slots,"subtitle")]),icon:b(()=>[(f(),y("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:L(["tw-w-5 tw-h-5 tw-transition-transform tw-relative",{"tw-rotate-90":t.isOpen}]),style:{bottom:"1px"}},e[1]||(e[1]=[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"},null,-1)]),2))]),default:b(()=>[S(t.MTransitionCollapse,null,{default:b(()=>[t.isOpen?(f(),y("div",xt,[ge(u.$slots,"default",{},()=>[e[2]||(e[2]=T("Content TBD"))])])):I("",!0)],void 0,!0),_:3})],void 0,!0),_:2},[u.$slots["header-right"]?{name:"header-right",fn:b(()=>[ge(u.$slots,"header-right")]),key:"0"}:void 0]),1032,["title","subtitle","badge","badgeVariant"])}const St=Z(kt,[["render",yt],["__file","MCollapseCard.vue"]]),_t=H({__name:"DatabaseItemsCard",setup(u,{expose:e}){e();const n=Le(),{data:t,hasPermission:s,error:i}=N(U()),r=D(()=>t.value?.options.values),a=z(),c=D(()=>{if(!t.value)return{};const M={};for(const P of Object.keys(t.value.shardItemCounts)){const Y=t.value.shardItemCounts[P];M[P]=Y.reduce((ee,te)=>ee+te,0)}return M}),o=z(""),h=z(!1),p=z(""),g=z("default");De(o,()=>{h.value=null,p.value="",o.value?Ne(o.value)?(g.value="loading",n.get(`/entities/${o.value}/exists`).then(M=>{const P=M.data;h.value=P,g.value=P?"success":"danger",p.value=P?"":"Entity does not exist."})):(h.value=!1,p.value="Not a valid entity ID.",g.value="danger"):(h.value=null,p.value="",g.value="default")});function w(){o.value="",h.value=null,p.value=""}const d=Ie();async function m(){d.push(`/entities/${o.value}/dbinfo`)}const k={gameServerApi:n,databaseStatusData:t,databaseStatusPermission:s,databaseStatusError:i,databaseOptions:r,databaseStatusModal:a,totalItemCounts:c,entityId:o,isEntityIdValid:h,isEntityIdValidReason:p,variant:g,resetModal:w,router:d,inspectEntity:m,computed:D,ref:z,watch:De,get useRouter(){return Ie},get useGameServerApi(){return Le},get MActionModalButton(){return bt},get MButton(){return it},get MCard(){return je},get MInputText(){return wt},get MModal(){return Ue},get useSubscription(){return N},get isValidEntityId(){return Ne},get getDatabaseStatusSubscriptionOptions(){return U}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),vt={class:"tw-flex tw-justify-end tw-space-x-2"},Ct={class:"tw-divide-y tw-divide-neutral-200 tw-rounded-md tw-border tw-border-neutral-300",style:{"font-size":"0.8rem"}},Tt={key:0},Mt={class:"tw-text-base tw-font-semibold"},Dt={class:"tw-grid tw-gap-x-6 tw-space-y-0.5 sm:tw-grid-cols-2 lg:tw-grid-cols-3"},It={class:"tw-break-word"},Nt={class:"text-monospace tw-flex-none"},Lt={key:1,class:"tw-text-sm tw-font-semibold tw-text-neutral-500"};function Rt(u,e,n,t,s,i){const r=B("b-td"),a=B("meta-abbreviate-number"),c=B("b-tr"),o=B("b-tbody"),h=B("b-table-simple");return f(),_(t.MCard,{title:"Database Items","data-testid":"database-items"},{default:b(()=>[e[4]||(e[4]=l("span",{class:"tw-font-semibold"},"Totals",-1)),S(h,{class:"tw-mt-1",small:""},{default:b(()=>[S(o,null,{default:b(()=>[(f(!0),y($,null,j(t.totalItemCounts,(p,g)=>(f(),_(c,{key:g},{default:b(()=>[S(r,null,{default:b(()=>[T(x(g),1)],void 0,!0),_:2},1024),S(r,{class:"tw-text-right"},{default:b(()=>[S(a,{value:p},null,8,["value"])],void 0,!0),_:2},1024)],void 0,!0),_:2},1024))),128))],void 0,!0),_:1})],void 0,!0),_:1}),l("div",vt,[t.databaseStatusData?(f(),_(t.MButton,{key:0,onClick:t.databaseStatusModal?.open},{default:b(()=>e[1]||(e[1]=[T("Show Items per Shard")]),void 0,!0),_:1},8,["onClick"])):I("",!0),S(t.MModal,{ref:"databaseStatusModal",title:"Database Items per Shard","modal-size":"large"},{default:b(()=>[l("ul",Ct,[(f(!0),y($,null,j(t.databaseOptions.shards,(p,g)=>(f(),y("li",{class:"tw-px-3 tw-py-3 even:tw-bg-neutral-100",key:g},[g<t.databaseStatusData.numShards?(f(),y("div",Tt,[l("div",Mt,"Shard #"+x(g),1),l("div",Dt,[(f(!0),y($,null,j(t.databaseStatusData.shardItemCounts,(w,d)=>(f(),y("div",{key:`counts-${d}`},[l("div",{class:L(["tw-flex tw-flex-wrap tw-justify-between tw-gap-x-2",w[g]>0?"":"text-muted"])},[l("span",It,x(d),1),l("span",Nt,[S(a,{value:w[g]},null,8,["value"])])],2)]))),128))])])):(f(),y("div",Lt,"Shard #"+x(g)+" inactive",1))]))),128))])],void 0,!0),_:1},512),S(t.MActionModalButton,{"modal-title":"Inspect an Entity",action:t.inspectEntity,"trigger-button-label":"Inspect Entity","ok-button-label":"Inspect","ok-button-disabled-tooltip":t.isEntityIdValid?void 0:"Enter a valid Entity ID to proceed.","disable-safety-lock":"",permission:"api.database.inspect_entity",onShow:t.resetModal,"data-testid":"inspect-entity"},{default:b(()=>[e[2]||(e[2]=l("p",{class:"tw-mb-3"},"Entity inspection loads the stored data for the chosen entity and deserializes it into a human readable form without affecting the actual data.",-1)),e[3]||(e[3]=l("span",{class:"tw-text-xs+ tw-text-neutral-500"},"Inspecting the raw data of an entity may help you spot problems with the related actor, as you can see the data before any potential mutations during wake-up.",-1)),S(t.MInputText,{class:"tw-mt-4",label:"Entity ID","model-value":t.entityId,variant:t.variant,"hint-message":t.isEntityIdValid===!1?t.isEntityIdValidReason:void 0,placeholder:"Player:000000003v",debounce:300,"onUpdate:modelValue":e[0]||(e[0]=p=>t.entityId=p),"data-testid":"entity-id-input"},null,8,["model-value","variant","hint-message"])],void 0,!0),_:1},8,["ok-button-disabled-tooltip"])])],void 0,!0),_:1})}const Et=Z(_t,[["render",Rt],["__file","DatabaseItemsCard.vue"]]),Ot=H({__name:"DatabaseShardsCard",setup(u,{expose:e}){e();const{data:n,hasPermission:t,error:s}=N(U()),i=D(()=>n.value?.options.values),r=D(()=>i.value?.shards),a={databaseStatusData:n,databaseStatusPermission:t,databaseStatusError:s,databaseOptions:i,databaseShards:r,computed:D,get MetaListCard(){return Ge},get MBadge(){return ue},get MListItem(){return ke},get useSubscription(){return N},get getDatabaseStatusSubscriptionOptions(){return U}};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}}),Pt={key:0},At={key:1};function zt(u,e,n,t,s,i){return f(),_(t.MetaListCard,{title:"Database Shards",icon:"database",itemList:t.databaseShards,permission:"api.database.status","data-testid":"database-shards"},{description:b(()=>[e[0]||(e[0]=T("The database type for this environment is ")),S(t.MBadge,{variant:"primary"},{default:b(()=>[T(x(t.databaseOptions.backend),1)],void 0,!0),_:1}),e[1]||(e[1]=T("."))]),"item-card":b(({item:r,index:a})=>[S(t.MListItem,null,{"top-right":b(()=>[T(x(r.userId),1)]),"bottom-left":b(()=>[t.databaseOptions.backend==="MySql"?(f(),y("div",Pt,[l("div",null,"Database: "+x(r.databaseName),1),l("div",null,"RW host: "+x(r.readWriteHost),1),l("div",null,"RO host: "+x(r.readOnlyHost),1)])):I("",!0),t.databaseOptions.backend==="Sqlite"?(f(),y("div",At,[l("div",null,"File path: "+x(r.filePath),1)])):I("",!0)]),default:b(()=>[T("#"+x(a),1)],void 0,!0),_:2},1024)]),_:1},8,["itemList"])}const Bt=Z(Ot,[["render",zt],["__file","DatabaseShardsCard.vue"]]),$t=H({__name:"ManageNodeButton",props:{nodeSetIndex:{},nodeName:{},dataTestid:{}},setup(u,{expose:e}){e();const n=u,{data:t}=N(G()),s=D(()=>t.value?.nodeSets[n.nodeSetIndex]),i=D(()=>s.value?.nodes.find(g=>g.name===n.nodeName)),r=z(),a=D(()=>Object.fromEntries(Object.entries(i.value?.rawNodeData.liveEntityCounts??{}).sort((g,w)=>g[0].localeCompare(w[0]))));function c(g){return g==="HardLimit"||g==="NotConnected"||g==="unknown"?"tw-text-red-500":g==="ExpectedNotConnected"?"tw-text-neutral-400":void 0}function o(g){return g==="NotConnected"?"Failed to connect":g==="ExpectedNotConnected"?"Inactive":re(g)}function h(g){return s.value?.scalingMode==="Static"?"None":g.nodeStatus==="NotConnected"||g.nodeStatus==="ExpectedNotConnected"?"Idle":re(g.nodeScalingState)}const p={props:n,clusterData:t,nodeSetData:s,nodeData:i,nodeManageModal:r,sortedLiveEntityList:a,getStatusVariant:c,getNodeStatus:o,getNodeScalingState:h,get DateTime(){return qe},computed:D,ref:z,get MClipboardCopy(){return He},get MTextButton(){return Ze},get MModal(){return Ue},get camelCaseToTitleCase(){return be},get camelCaseToSentenceCase(){return re},get useSubscription(){return N},get isEpochTime(){return Fe},get getClusterSubscriptionOptions(){return G}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),Vt={class:"tw-mb-2 tw-text-neutral-500"},jt={class:"tw-w-full tw-table-auto"},qt={class:"tw-divide-y tw-divide-neutral-200 tw-border-t tw-border-neutral-200 *:*:tw-py-1"},Ht={class:"tw-text-right"},Zt={class:"tw-text-right"},Ft={class:"tw-text-right"},Ut={key:1},Gt={class:"tw-text-right"},Qt={class:"tw-text-right"},Wt={key:0},Kt={class:"tw-grid tw-grid-flow-row tw-gap-x-6 @md:tw-grid-cols-2"},Xt={class:"tw-break-word"},Jt={class:"text-monospace tw-flex-none"},Yt={key:1,class:"tw-text-neutral-400"},en={class:"tw-font-semibold"},tn={class:"tw-space-y-2"},nn={class:"tw-mt-2 tw-max-h-72 tw-overflow-scroll tw-rounded-md tw-border tw-border-neutral-300 tw-bg-neutral-100 tw-p-3 tw-text-xs"},sn={key:0,class:"tw-font-mono tw-text-neutral-500"},rn={key:1,class:"tw-text-neutral-500"};function an(u,e,n,t,s,i){const r=B("meta-duration");return t.nodeData?(f(),_(t.MTextButton,{key:0,onClick:t.nodeManageModal?.open,"data-testid":`${n.dataTestid}-button`},{default:b(()=>[e[16]||(e[16]=T("View node")),S(t.MModal,{ref:"nodeManageModal",title:`View ${t.camelCaseToTitleCase(n.nodeName)} Node`,"data-testid":`${n.dataTestid}-modal`},{"right-panel":b(()=>[l("div",en,[e[11]||(e[11]=T("Workload Data ")),S(t.MClipboardCopy,{contents:t.nodeData.rawNodeData.rawWorkload?JSON.stringify(t.nodeData.rawNodeData.rawWorkload):void 0},null,8,["contents"])]),e[13]||(e[13]=l("div",{class:"tw-text-xs+ tw-text-neutral-500"},"The raw workload data for this node. This provides details about how the system's autoscaling is configured.",-1)),l("div",tn,[l("div",nn,[t.nodeData.rawNodeData.rawWorkload?(f(),y("pre",sn,x(t.nodeData.rawNodeData.rawWorkload),1)):(f(),y("div",rn,e[12]||(e[12]=[l("span",{class:"tw-mx-auto tw-text-xs+"},"No data available.",-1)])))])])]),default:b(()=>[l("div",Vt,[e[1]||(e[1]=T("View a summary of the systems currently running on this node.")),e[2]||(e[2]=l("span",{class:"tw-mx-1"},"For detailed insights into the performance and workload, check the",-1)),S(t.MTextButton,{to:t.nodeData.grafanaLogUrl?t.nodeData.grafanaLogUrl:void 0,permission:"dashboard.grafana.view","disabled-tooltip":t.nodeData.grafanaLogUrl?void 0:"Grafana is not enabled for this environment.",target:"_blank","data-testid":"view-grafana-logs-button"},{default:b(()=>e[0]||(e[0]=[T("Grafana logs")]),void 0,!0),_:1},8,["to","disabled-tooltip"]),e[3]||(e[3]=l("span",null,".",-1))]),l("table",jt,[l("tbody",qt,[l("tr",null,[e[4]||(e[4]=l("td",null,"Status",-1)),l("td",{class:L(["tw-text-right",t.getStatusVariant(t.nodeData.nodeStatus)])},x(t.getNodeStatus(t.nodeData.nodeStatus)),3)]),l("tr",null,[e[5]||(e[5]=l("td",null,"Scaling",-1)),l("td",Ht,x(t.getNodeScalingState(t.nodeData)),1)]),l("tr",null,[e[6]||(e[6]=l("td",null,"Phase",-1)),l("td",Zt,x(t.nodeData.rawNodeData.clusterLocalPhase||"Unknown"),1)]),l("tr",null,[e[7]||(e[7]=l("td",null,"Uptime",-1)),l("td",Ft,[t.isEpochTime(t.nodeData.serverStartedAt)?(f(),y("span",Ut,"Not available")):(f(),_(r,{key:0,duration:t.DateTime.now().diff(t.DateTime.fromISO(t.nodeData.serverStartedAt)),hideMilliseconds:"",showAs:"humanizedSentenceCase"},null,8,["duration"]))])]),l("tr",null,[e[8]||(e[8]=l("td",null,"Public IP",-1)),l("td",Gt,[T(x(t.nodeData.publicIp||"Not available")+" ",1),t.nodeData.publicIp?(f(),_(t.MClipboardCopy,{key:0,contents:JSON.stringify(t.nodeData.publicIp)},null,8,["contents"])):I("",!0)])]),l("tr",null,[e[9]||(e[9]=l("td",null,"Host",-1)),l("td",Qt,[T(x(t.nodeData.nodeAddress)+" ",1),t.nodeData.nodeAddress?(f(),_(t.MClipboardCopy,{key:0,contents:t.nodeData.nodeAddress},null,8,["contents"])):I("",!0)])])])]),e[14]||(e[14]=l("div",{class:"tw-mt-2 tw-font-semibold"},"Hosted Entities",-1)),e[15]||(e[15]=l("p",{class:"tw-mb-2 tw-text-neutral-500"},"The entities of each type currently running on this node.",-1)),t.nodeData.rawNodeData.liveEntityCounts?(f(),y("ul",Wt,[l("div",Kt,[(f(!0),y($,null,j(t.sortedLiveEntityList,(a,c)=>(f(),y("div",{key:c},[l("div",{class:L(["tw-flex tw-flex-wrap tw-justify-between tw-gap-x-2",{"tw-text-neutral-400":a===0}])},[l("span",Xt,x(c),1),l("span",Jt,x(a),1)],2)]))),128))])])):(f(),y("div",Yt,e[10]||(e[10]=[l("span",{class:"tw-m-auto tw-text-xs+"},"No data available",-1)])))],void 0,!0),_:1},8,["title","data-testid"])],void 0,!0),_:1},8,["onClick","data-testid"])):I("",!0)}const on=Z($t,[["render",an],["__file","ManageNodeButton.vue"]]),ln=H({__name:"NodeSetsCard",setup(u,{expose:e}){e();const{data:n}=N(G()),t=D(()=>n.value?n.value.nodeSets:[]);function s(d){let m,k,M;return d.mostSevereStatus==="NotConnected"?(m="Failed to connect",k="One or more nodes in this set are no longer reachable. Please investigate the issue and contact your DevOps team for assistance.",M="tw-text-red-500"):d.mostSevereStatus==="HardLimit"?(m="Hard limit reached",k="This node set is operating as expected but one or more nodes have reached their hard limit. Consider adjusting resources or provisioning additional nodes.",M="tw-text-red-500"):d.mostSevereStatus==="SoftLimit"?(m="Soft limit reached",k="This node set is operating as expected but one or more nodes have reached their soft limit.",M="tw-text-neutral-500"):d.mostSevereStatus==="Perfect"?(m="Perfect",k="All nodes in this set are operating as expected.",M="tw-text-neutral-500"):d.mostSevereStatus==="ExpectedNotConnected"?(m="Inactive",k="This node set is currently inactive.",M="tw-text-neutral-400"):(m="Unknown Status",k="This node set is in an unknown state. This is unexpected and should be investigated. Contact your DevOps team for support.",M="tw-text-red-500"),{title:m,description:k,textVariant:M}}function i(d){let m,k,M;return d.mostSevereStatus==="NotConnected"?(m="Failed to connect",k="One or more nodes in this set are no longer reachable. Please investigate and contact your DevOps team for assistance.",M="tw-text-red-500"):d.mostSevereStatus==="HardLimit"?(m="Hard limit reached",d.scalingState==="ScalingUp"?k="This node set is working as expected, but one or more nodes have reached their hard limit and are attempting to scale up. This might indicate sudden load or an issue occurred while provisioning new nodes. Please investigate this issue or contact your DevOps team for support.":d.scalingState==="ScalingDown"?k="This node set is working as expected but one or more nodes have reached their hard limit. The system is scaling down to reduce resource usage.":k="This node set is working as expected but one or more nodes have reached their hard limit and no more nodes can be added. Consider adjusting resources or provisioning additional nodes.",M="tw-text-red-500"):d.mostSevereStatus==="SoftLimit"?(m="Soft limit reached",d.scalingState==="ScalingUp"?k="The node set is working as expected but one or more nodes have reached their soft limit. The system is scaling up to handle increased demand.":d.scalingState==="ScalingDown"?(k="One or more nodes have reached their soft limit. The system is scaling down to reduce resource usage, this is unexpected and could cause further issues. Please investigate this issue or contact your DevOps team for support.",M="tw-text-red-500"):k="This node set is working as expected but one or more nodes have reached their soft limit.",M="tw-text-neutral-500"):d.mostSevereStatus==="Perfect"?(m="Perfect",d.scalingState==="ScalingUp"?k="All nodes in this set are working as expected and the system is scaling up to manage increased demand.":d.scalingState==="ScalingDown"?k="All nodes in this set are working as expected and the system is scaling down to reduce resource usage.":d.scalingState==="AtMaxNodeCount"?k="All nodes are working as expected, but the maximum node count has been reached. Consider adjusting resources or provisioning additional nodes.":k="All nodes in this set are working as expected and there is additional capacity available.",M="tw-text-neutral-500"):d.mostSevereStatus==="ExpectedNotConnected"?(m="Inactive",k="This node set is currently inactive.",M="tw-text-neutral-300"):(m="Unknown",k="This node set is in an unknown state. This is unexpected and should be investigated. Contact your DevOps team for support.",M="tw-text-red-500"),{title:m,description:k,textVariant:M}}function r(d){const m=d.nodeStatus,k=d.rawNodeData.clusterLocalPhase??void 0;return m==="NotConnected"?{message:"Error: This node has failed to connect.",textVariant:"tw-text-red-500"}:m==="ExpectedNotConnected"?{message:"This node is not active.",textVariant:"tw-text-neutral-300"}:k==="Terminated"?{message:"This node is no longer active.",textVariant:"tw-text-neutral-300"}:k==="Starting"?{message:"This node is starting up.",textVariant:"tw-text-neutral-500"}:m==="HardLimit"?{message:"This node has reached its hard limit.",textVariant:"tw-text-red-500"}:m==="SoftLimit"?{message:"This node has reached its soft limit.",textVariant:"tw-text-neutral-500"}:m==="Perfect"?{message:"This node is operating as expected.",textVariant:"tw-text-neutral-500"}:{message:"Error: This node is in an unknown state.",textVariant:"tw-text-red-500"}}function a(d,m){if(m.rawNodeData.clusterLocalPhase==="Running"){if(d.scalingMode==="Static")return"Running";{const k=m.rawNodeData.scalingNodeState;return k==="Working"?"Running":k==="Killing"?"Terminating":void 0}}else return m.rawNodeData.clusterLocalPhase==="Starting"?"Starting":m.rawNodeData.clusterLocalPhase?be(m.rawNodeData.clusterLocalPhase):void 0}function c(d){return Object.fromEntries(Object.entries(d).sort((m,k)=>m[0].localeCompare(k[0])))}const o=["entityKinds"],h=[new me("scalingMode",[new V("Static",d=>d.scalingMode==="Static"),new V("Dynamic",d=>d.scalingMode==="DynamicLinear")]),new me("status",[new V("Not Connected",d=>d.mostSevereStatus==="NotConnected"),new V("Inactive",d=>d.mostSevereStatus==="ExpectedNotConnected"),new V("Hard Limit",d=>d.mostSevereStatus==="HardLimit"),new V("Soft Limit",d=>d.mostSevereStatus==="SoftLimit"),new V("Perfect",d=>d.mostSevereStatus==="Perfect")])];function p(d){return d.name}const g=[ne.asUnsorted(),new ne("Name","name",fe.Ascending),new ne("Name","name",fe.Descending)],w={clusterData:n,nodeSetsData:t,getStaticNodeSetStatus:s,getDynamicNodeSetStatus:i,getNodeStatus:r,getNodePhaseText:a,sortList:c,searchFields:o,filterSets:h,getItemKey:p,sortOptions:g,get DateTime(){return qe},computed:D,get MetaListSortDirection(){return fe},get MetaListSortOption(){return ne},get MetaListFilterSet(){return me},get MetaListFilterOption(){return V},get MetaListCard(){return Ge},get MBadge(){return ue},get MClipboardCopy(){return He},get MCollapse(){return ot},get MListItem(){return ke},get camelCaseToSentenceCase(){return re},get camelCaseToTitleCase(){return be},get maybePluralPrefixString(){return lt},get useSubscription(){return N},get isEpochTime(){return Fe},get getClusterSubscriptionOptions(){return G},ManageNodeButton:on};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),cn={key:0,class:"tw-space-x-1"},un={key:1,class:"tw-space-x-1"},dn={class:"tw-flex tw-flex-col tw-space-y-1 tw-text-xs tw-text-neutral-500"},pn={key:0},hn={key:1},gn={key:0},fn={class:"bg-light rounded border tw-m3"},mn={class:"tw-my-2 tw-px-5","data-testid":"node-set-item-entities"},bn={class:"tw-grid tw-gap-x-6 tw-pt-1 tw-text-xs+ @md:tw-grid-cols-2 @lg:tw-grid-cols-3"},wn={class:"tw-break-word"},kn={class:"text-monospace tw-flex-none"},xn={key:0},yn={class:"tw-divide-y tw-divide-neutral-200 tw-border-t tw-border-neutral-200 *:*:tw-py-1"},Sn={class:"tw-text-right"},_n={key:1},vn={class:"tw-text-right"},Cn={class:"tw-text-right"};function Tn(u,e,n,t,s,i){const r=B("meta-duration");return t.clusterData?(f(),_(t.MetaListCard,{key:0,title:"All Nodes",itemList:t.nodeSetsData,searchFields:t.searchFields,searchPlaceholder:"Search by entity type...",filterSets:t.filterSets,sortOptions:t.sortOptions,getItemKey:t.getItemKey,emptyMessage:"No nodes found.","data-testid":"node-sets"},{"item-card":b(({item:a,index:c})=>[S(t.MCollapse,{extraMListItemMargin:""},{header:b(()=>[S(t.MListItem,{noLeftPadding:"","data-testid":"node-set-item"},{"bottom-left":b(()=>[a.scalingMode==="Static"?(f(),y("div",cn,[l("span",{class:L(["tw-text-xs+ tw-my-1 tw-font-semibold",t.getStaticNodeSetStatus(a).textVariant])},x(t.getStaticNodeSetStatus(a).title)+":",3),l("span",{class:L(["tw-text-xs+ tw-my-1",t.getStaticNodeSetStatus(a).textVariant])},x(t.getStaticNodeSetStatus(a).description),3)])):(f(),y("div",un,[l("span",{class:L(["tw-text-xs+ tw-my-1 tw-font-semibold",t.getDynamicNodeSetStatus(a).textVariant])},x(t.getDynamicNodeSetStatus(a).title)+":",3),l("span",{class:L(["tw-text-xs+ tw-my-1",t.getDynamicNodeSetStatus(a).textVariant])},x(t.getDynamicNodeSetStatus(a).description),3)]))]),"bottom-right":b(()=>[l("div",dn,[a.scalingMode==="Static"?(f(),y("span",pn,x(t.maybePluralPrefixString(a.connectedNodes,"Node","Nodes"))+" "+x(a.connectedNodes)+" / "+x(a.maxNodeCount),1)):(f(),y("span",hn,x(t.maybePluralPrefixString(a.connectedNodes,"Node","Nodes"))+" "+x(a.connectedNodes)+" / "+x(a.maxNodeCount),1)),l("span",null,"Entity types "+x(Object.keys(a.aggregatedLiveEntityCounts).length),1)])]),default:b(()=>[l("span",{class:L([{"tw-text-neutral-400":a.mostSevereStatus==="ExpectedNotConnected"}])},x(t.camelCaseToSentenceCase(a.name)),3)],void 0,!0),_:2},1024)]),default:b(()=>[a?(f(),y("ul",gn,[l("div",fn,[l("li",mn,[e[0]||(e[0]=l("span",{class:"tw-text-sm tw-font-semibold"},"Current Entities",-1)),l("div",bn,[(f(!0),y($,null,j(t.sortList(a.aggregatedLiveEntityCounts),(o,h)=>(f(),y("div",{key:h},[l("div",{class:L(["tw-flex tw-flex-wrap tw-justify-between tw-gap-x-2",{"tw-text-neutral-400":o===0}])},[l("span",wn,x(h),1),l("span",kn,x(o),1)],2)]))),128))])])]),a.nodes?(f(),y("div",xn,[(f(!0),y($,null,j(a.nodes,o=>(f(),_(t.MListItem,{key:o.name,"data-testid":"node-set-item-details"},{"top-right":b(()=>[l("span",{class:L([{"tw-text-neutral-300":o.nodeStatus==="ExpectedNotConnected"}])},x(a.scalingMode==="Static"?"Static":"Dynamic"),3)]),"bottom-left":b(()=>[l("div",{class:L(["tw-text-xs+",t.getNodeStatus(o).textVariant])},x(t.getNodeStatus(o).message),3),l("table",{class:L(["tw-w-full",["tw-max-w-[37rem]",{"tw-text-neutral-300":o.nodeStatus==="ExpectedNotConnected"}]])},[l("tbody",yn,[l("tr",null,[e[1]||(e[1]=l("td",{class:"tw-text-xs+"},"Uptime",-1)),l("td",Sn,[t.isEpochTime(o.serverStartedAt)?(f(),y("span",_n,"Not available")):(f(),_(r,{key:0,duration:t.DateTime.now().diff(t.DateTime.fromISO(o.serverStartedAt)),hideMilliseconds:"",showAs:"humanizedSentenceCase"},null,8,["duration"]))])]),l("tr",null,[e[2]||(e[2]=l("td",{class:"tw-text-xs+"},"Public IP",-1)),l("td",vn,[T(x(o.publicIp||"Not available")+" ",1),o.publicIp?(f(),_(t.MClipboardCopy,{key:0,contents:JSON.stringify(o.publicIp)},null,8,["contents"])):I("",!0)])]),l("tr",null,[e[3]||(e[3]=l("td",{class:"tw-text-xs+"},"Host",-1)),l("td",Cn,[T(x(o.nodeAddress)+" ",1),o.nodeAddress?(f(),_(t.MClipboardCopy,{key:0,contents:o.nodeAddress},null,8,["contents"])):I("",!0)])])])],2)]),"bottom-right":b(()=>[o.nodeStatus!=="ExpectedNotConnected"?(f(),_(t.ManageNodeButton,{key:0,nodeSetIndex:c,nodeName:o.name,"data-testid":"manage-node"},null,8,["nodeSetIndex","nodeName"])):I("",!0)]),default:b(()=>[l("p",{class:L(["tw-text-sm",{"tw-text-neutral-300":o.nodeStatus==="ExpectedNotConnected"}])},[T(x(t.camelCaseToTitleCase(o.name)),1),t.getNodePhaseText(a,o)?(f(),_(t.MBadge,{key:0,class:"tw-ml-1"},{default:b(()=>[T(x(t.getNodePhaseText(a,o)),1)],void 0,!0),_:2},1024)):I("",!0)],2)],void 0,!0),_:2},1024))),128))])):I("",!0)])):I("",!0)],void 0,!0),_:2},1024)]),_:1},8,["itemList"])):I("",!0)}const Mn=Z(ln,[["render",Tn],["__scopeId","data-v-ad594339"],["__file","NodeSetsCard.vue"]]);function xe(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let F=xe();function Qe(u){F=u}const X={exec:()=>null};function C(u,e=""){let n=typeof u=="string"?u:u.source;const t={replace:(s,i)=>{let r=typeof i=="string"?i:i.source;return r=r.replace(R.caret,"$1"),n=n.replace(s,r),t},getRegex:()=>new RegExp(n,e)};return t}const R={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:u=>new RegExp(`^( {0,3}${u})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:u=>new RegExp(`^ {0,${Math.min(3,u-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:u=>new RegExp(`^ {0,${Math.min(3,u-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:u=>new RegExp(`^ {0,${Math.min(3,u-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:u=>new RegExp(`^ {0,${Math.min(3,u-1)}}#`),htmlBeginRegex:u=>new RegExp(`^ {0,${Math.min(3,u-1)}}<(?:[a-z].*>|!--)`,"i")},Dn=/^(?:[ \t]*(?:\n|$))+/,In=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Nn=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,J=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ln=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,We=/(?:[*+-]|\d{1,9}[.)])/,Ke=C(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,We).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),ye=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Rn=/^[^\n]+/,Se=/(?!\s*\])(?:\\.|[^\[\]\\])+/,En=C(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Se).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),On=C(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,We).getRegex(),de="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",_e=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Pn=C("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",_e).replace("tag",de).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Xe=C(ye).replace("hr",J).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",de).getRegex(),An=C(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Xe).getRegex(),ve={blockquote:An,code:In,def:En,fences:Nn,heading:Ln,hr:J,html:Pn,lheading:Ke,list:On,newline:Dn,paragraph:Xe,table:X,text:Rn},Ae=C("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",J).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",de).getRegex(),zn={...ve,table:Ae,paragraph:C(ye).replace("hr",J).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ae).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",de).getRegex()},Bn={...ve,html:C(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",_e).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:X,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:C(ye).replace("hr",J).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ke).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Je=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,$n=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Ye=/^( {2,}|\\)\n(?!\s*$)/,Vn=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,pe=/[\p{P}\p{S}]/u,Ce=/[\s\p{P}\p{S}]/u,et=/[^\s\p{P}\p{S}]/u,jn=C(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Ce).getRegex(),qn=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Hn=C(/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,"u").replace(/punct/g,pe).getRegex(),Zn=C("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)","gu").replace(/notPunctSpace/g,et).replace(/punctSpace/g,Ce).replace(/punct/g,pe).getRegex(),Fn=C("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,et).replace(/punctSpace/g,Ce).replace(/punct/g,pe).getRegex(),Un=C(/\\(punct)/,"gu").replace(/punct/g,pe).getRegex(),Gn=C(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Qn=C(_e).replace("(?:-->|$)","-->").getRegex(),Wn=C("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Qn).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),oe=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Kn=C(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",oe).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),tt=C(/^!?\[(label)\]\[(ref)\]/).replace("label",oe).replace("ref",Se).getRegex(),nt=C(/^!?\[(ref)\](?:\[\])?/).replace("ref",Se).getRegex(),Xn=C("reflink|nolink(?!\\()","g").replace("reflink",tt).replace("nolink",nt).getRegex(),Te={_backpedal:X,anyPunctuation:Un,autolink:Gn,blockSkip:qn,br:Ye,code:$n,del:X,emStrongLDelim:Hn,emStrongRDelimAst:Zn,emStrongRDelimUnd:Fn,escape:Je,link:Kn,nolink:nt,punctuation:jn,reflink:tt,reflinkSearch:Xn,tag:Wn,text:Vn,url:X},Jn={...Te,link:C(/^!?\[(label)\]\((.*?)\)/).replace("label",oe).getRegex(),reflink:C(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",oe).getRegex()},we={...Te,escape:C(Je).replace("])","~|])").getRegex(),url:C(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Yn={...we,br:C(Ye).replace("{2,}","*").getRegex(),text:C(we.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},se={normal:ve,gfm:zn,pedantic:Bn},W={normal:Te,gfm:we,breaks:Yn,pedantic:Jn},es={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ze=u=>es[u];function A(u,e){if(e){if(R.escapeTest.test(u))return u.replace(R.escapeReplace,ze)}else if(R.escapeTestNoEncode.test(u))return u.replace(R.escapeReplaceNoEncode,ze);return u}function Be(u){try{u=encodeURI(u).replace(R.percentDecode,"%")}catch{return null}return u}function $e(u,e){const n=u.replace(R.findPipe,(i,r,a)=>{let c=!1,o=r;for(;--o>=0&&a[o]==="\\";)c=!c;return c?"|":" |"}),t=n.split(R.splitPipe);let s=0;if(t[0].trim()||t.shift(),t.length>0&&!t.at(-1)?.trim()&&t.pop(),e)if(t.length>e)t.splice(e);else for(;t.length<e;)t.push("");for(;s<t.length;s++)t[s]=t[s].trim().replace(R.slashPipe,"|");return t}function K(u,e,n){const t=u.length;if(t===0)return"";let s=0;for(;s<t;){const i=u.charAt(t-s-1);if(i===e&&!n)s++;else if(i!==e&&n)s++;else break}return u.slice(0,t-s)}function ts(u,e){if(u.indexOf(e[1])===-1)return-1;let n=0;for(let t=0;t<u.length;t++)if(u[t]==="\\")t++;else if(u[t]===e[0])n++;else if(u[t]===e[1]&&(n--,n<0))return t;return-1}function Ve(u,e,n,t,s){const i=e.href,r=e.title||null,a=u[1].replace(s.other.outputLinkReplace,"$1");if(u[0].charAt(0)!=="!"){t.state.inLink=!0;const c={type:"link",raw:n,href:i,title:r,text:a,tokens:t.inlineTokens(a)};return t.state.inLink=!1,c}return{type:"image",raw:n,href:i,title:r,text:a}}function ns(u,e,n){const t=u.match(n.other.indentCodeCompensation);if(t===null)return e;const s=t[1];return e.split(`
`).map(i=>{const r=i.match(n.other.beginningSpace);if(r===null)return i;const[a]=r;return a.length>=s.length?i.slice(s.length):i}).join(`
`)}class le{options;rules;lexer;constructor(e){this.options=e||F}space(e){const n=this.rules.block.newline.exec(e);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(e){const n=this.rules.block.code.exec(e);if(n){const t=n[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?t:K(t,`
`)}}}fences(e){const n=this.rules.block.fences.exec(e);if(n){const t=n[0],s=ns(t,n[3]||"",this.rules);return{type:"code",raw:t,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:s}}}heading(e){const n=this.rules.block.heading.exec(e);if(n){let t=n[2].trim();if(this.rules.other.endingHash.test(t)){const s=K(t,"#");(this.options.pedantic||!s||this.rules.other.endingSpaceChar.test(s))&&(t=s.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(e){const n=this.rules.block.hr.exec(e);if(n)return{type:"hr",raw:K(n[0],`
`)}}blockquote(e){const n=this.rules.block.blockquote.exec(e);if(n){let t=K(n[0],`
`).split(`
`),s="",i="";const r=[];for(;t.length>0;){let a=!1;const c=[];let o;for(o=0;o<t.length;o++)if(this.rules.other.blockquoteStart.test(t[o]))c.push(t[o]),a=!0;else if(!a)c.push(t[o]);else break;t=t.slice(o);const h=c.join(`
`),p=h.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");s=s?`${s}
${h}`:h,i=i?`${i}
${p}`:p;const g=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(p,r,!0),this.lexer.state.top=g,t.length===0)break;const w=r.at(-1);if(w?.type==="code")break;if(w?.type==="blockquote"){const d=w,m=d.raw+`
`+t.join(`
`),k=this.blockquote(m);r[r.length-1]=k,s=s.substring(0,s.length-d.raw.length)+k.raw,i=i.substring(0,i.length-d.text.length)+k.text;break}else if(w?.type==="list"){const d=w,m=d.raw+`
`+t.join(`
`),k=this.list(m);r[r.length-1]=k,s=s.substring(0,s.length-w.raw.length)+k.raw,i=i.substring(0,i.length-d.raw.length)+k.raw,t=m.substring(r.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:r,text:i}}}list(e){let n=this.rules.block.list.exec(e);if(n){let t=n[1].trim();const s=t.length>1,i={type:"list",raw:"",ordered:s,start:s?+t.slice(0,-1):"",loose:!1,items:[]};t=s?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=s?t:"[*+-]");const r=this.rules.other.listItemRegex(t);let a=!1;for(;e;){let o=!1,h="",p="";if(!(n=r.exec(e))||this.rules.block.hr.test(e))break;h=n[0],e=e.substring(h.length);let g=n[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,P=>" ".repeat(3*P.length)),w=e.split(`
`,1)[0],d=!g.trim(),m=0;if(this.options.pedantic?(m=2,p=g.trimStart()):d?m=n[1].length+1:(m=n[2].search(this.rules.other.nonSpaceChar),m=m>4?1:m,p=g.slice(m),m+=n[1].length),d&&this.rules.other.blankLine.test(w)&&(h+=w+`
`,e=e.substring(w.length+1),o=!0),!o){const P=this.rules.other.nextBulletRegex(m),Y=this.rules.other.hrRegex(m),ee=this.rules.other.fencesBeginRegex(m),te=this.rules.other.headingBeginRegex(m),st=this.rules.other.htmlBeginRegex(m);for(;e;){const he=e.split(`
`,1)[0];let Q;if(w=he,this.options.pedantic?(w=w.replace(this.rules.other.listReplaceNesting,"  "),Q=w):Q=w.replace(this.rules.other.tabCharGlobal,"    "),ee.test(w)||te.test(w)||st.test(w)||P.test(w)||Y.test(w))break;if(Q.search(this.rules.other.nonSpaceChar)>=m||!w.trim())p+=`
`+Q.slice(m);else{if(d||g.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||ee.test(g)||te.test(g)||Y.test(g))break;p+=`
`+w}!d&&!w.trim()&&(d=!0),h+=he+`
`,e=e.substring(he.length+1),g=Q.slice(m)}}i.loose||(a?i.loose=!0:this.rules.other.doubleBlankLine.test(h)&&(a=!0));let k=null,M;this.options.gfm&&(k=this.rules.other.listIsTask.exec(p),k&&(M=k[0]!=="[ ] ",p=p.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:h,task:!!k,checked:M,loose:!1,text:p,tokens:[]}),i.raw+=h}const c=i.items.at(-1);c&&(c.raw=c.raw.trimEnd(),c.text=c.text.trimEnd()),i.raw=i.raw.trimEnd();for(let o=0;o<i.items.length;o++)if(this.lexer.state.top=!1,i.items[o].tokens=this.lexer.blockTokens(i.items[o].text,[]),!i.loose){const h=i.items[o].tokens.filter(g=>g.type==="space"),p=h.length>0&&h.some(g=>this.rules.other.anyLine.test(g.raw));i.loose=p}if(i.loose)for(let o=0;o<i.items.length;o++)i.items[o].loose=!0;return i}}html(e){const n=this.rules.block.html.exec(e);if(n)return{type:"html",block:!0,raw:n[0],pre:n[1]==="pre"||n[1]==="script"||n[1]==="style",text:n[0]}}def(e){const n=this.rules.block.def.exec(e);if(n){const t=n[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),s=n[2]?n[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:t,raw:n[0],href:s,title:i}}}table(e){const n=this.rules.block.table.exec(e);if(!n||!this.rules.other.tableDelimiter.test(n[2]))return;const t=$e(n[1]),s=n[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=n[3]?.trim()?n[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],r={type:"table",raw:n[0],header:[],align:[],rows:[]};if(t.length===s.length){for(const a of s)this.rules.other.tableAlignRight.test(a)?r.align.push("right"):this.rules.other.tableAlignCenter.test(a)?r.align.push("center"):this.rules.other.tableAlignLeft.test(a)?r.align.push("left"):r.align.push(null);for(let a=0;a<t.length;a++)r.header.push({text:t[a],tokens:this.lexer.inline(t[a]),header:!0,align:r.align[a]});for(const a of i)r.rows.push($e(a,r.header.length).map((c,o)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:r.align[o]})));return r}}lheading(e){const n=this.rules.block.lheading.exec(e);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(e){const n=this.rules.block.paragraph.exec(e);if(n){const t=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:t,tokens:this.lexer.inline(t)}}}text(e){const n=this.rules.block.text.exec(e);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(e){const n=this.rules.inline.escape.exec(e);if(n)return{type:"escape",raw:n[0],text:n[1]}}tag(e){const n=this.rules.inline.tag.exec(e);if(n)return!this.lexer.state.inLink&&this.rules.other.startATag.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(e){const n=this.rules.inline.link.exec(e);if(n){const t=n[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;const r=K(t.slice(0,-1),"\\");if((t.length-r.length)%2===0)return}else{const r=ts(n[2],"()");if(r>-1){const c=(n[0].indexOf("!")===0?5:4)+n[1].length+r;n[2]=n[2].substring(0,r),n[0]=n[0].substring(0,c).trim(),n[3]=""}}let s=n[2],i="";if(this.options.pedantic){const r=this.rules.other.pedanticHrefTitle.exec(s);r&&(s=r[1],i=r[3])}else i=n[3]?n[3].slice(1,-1):"";return s=s.trim(),this.rules.other.startAngleBracket.test(s)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?s=s.slice(1):s=s.slice(1,-1)),Ve(n,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer,this.rules)}}reflink(e,n){let t;if((t=this.rules.inline.reflink.exec(e))||(t=this.rules.inline.nolink.exec(e))){const s=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=n[s.toLowerCase()];if(!i){const r=t[0].charAt(0);return{type:"text",raw:r,text:r}}return Ve(t,i,t[0],this.lexer,this.rules)}}emStrong(e,n,t=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(!s||s[3]&&t.match(this.rules.other.unicodeAlphaNumeric))return;if(!(s[1]||s[2]||"")||!t||this.rules.inline.punctuation.exec(t)){const r=[...s[0]].length-1;let a,c,o=r,h=0;const p=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(p.lastIndex=0,n=n.slice(-1*e.length+r);(s=p.exec(n))!=null;){if(a=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!a)continue;if(c=[...a].length,s[3]||s[4]){o+=c;continue}else if((s[5]||s[6])&&r%3&&!((r+c)%3)){h+=c;continue}if(o-=c,o>0)continue;c=Math.min(c,c+o+h);const g=[...s[0]][0].length,w=e.slice(0,r+s.index+g+c);if(Math.min(r,c)%2){const m=w.slice(1,-1);return{type:"em",raw:w,text:m,tokens:this.lexer.inlineTokens(m)}}const d=w.slice(2,-2);return{type:"strong",raw:w,text:d,tokens:this.lexer.inlineTokens(d)}}}}codespan(e){const n=this.rules.inline.code.exec(e);if(n){let t=n[2].replace(this.rules.other.newLineCharGlobal," ");const s=this.rules.other.nonSpaceChar.test(t),i=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return s&&i&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:n[0],text:t}}}br(e){const n=this.rules.inline.br.exec(e);if(n)return{type:"br",raw:n[0]}}del(e){const n=this.rules.inline.del.exec(e);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(e){const n=this.rules.inline.autolink.exec(e);if(n){let t,s;return n[2]==="@"?(t=n[1],s="mailto:"+t):(t=n[1],s=t),{type:"link",raw:n[0],text:t,href:s,tokens:[{type:"text",raw:t,text:t}]}}}url(e){let n;if(n=this.rules.inline.url.exec(e)){let t,s;if(n[2]==="@")t=n[0],s="mailto:"+t;else{let i;do i=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])?.[0]??"";while(i!==n[0]);t=n[0],n[1]==="www."?s="http://"+n[0]:s=n[0]}return{type:"link",raw:n[0],text:t,href:s,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(e){const n=this.rules.inline.text.exec(e);if(n){const t=this.lexer.state.inRawBlock;return{type:"text",raw:n[0],text:n[0],escaped:t}}}}class E{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||F,this.options.tokenizer=this.options.tokenizer||new le,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:R,block:se.normal,inline:W.normal};this.options.pedantic?(n.block=se.pedantic,n.inline=W.pedantic):this.options.gfm&&(n.block=se.gfm,this.options.breaks?n.inline=W.breaks:n.inline=W.gfm),this.tokenizer.rules=n}static get rules(){return{block:se,inline:W}}static lex(e,n){return new E(n).lex(e)}static lexInline(e,n){return new E(n).inlineTokens(e)}lex(e){e=e.replace(R.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const t=this.inlineQueue[n];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],t=!1){for(this.options.pedantic&&(e=e.replace(R.tabCharGlobal,"    ").replace(R.spaceLine,""));e;){let s;if(this.options.extensions?.block?.some(r=>(s=r.call({lexer:this},e,n))?(e=e.substring(s.raw.length),n.push(s),!0):!1))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);const r=n.at(-1);s.raw.length===1&&r!==void 0?r.raw+=`
`:n.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);const r=n.at(-1);r?.type==="paragraph"||r?.type==="text"?(r.raw+=`
`+s.raw,r.text+=`
`+s.text,this.inlineQueue.at(-1).src=r.text):n.push(s);continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);const r=n.at(-1);r?.type==="paragraph"||r?.type==="text"?(r.raw+=`
`+s.raw,r.text+=`
`+s.raw,this.inlineQueue.at(-1).src=r.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title});continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length),n.push(s);continue}let i=e;if(this.options.extensions?.startBlock){let r=1/0;const a=e.slice(1);let c;this.options.extensions.startBlock.forEach(o=>{c=o.call({lexer:this},a),typeof c=="number"&&c>=0&&(r=Math.min(r,c))}),r<1/0&&r>=0&&(i=e.substring(0,r+1))}if(this.state.top&&(s=this.tokenizer.paragraph(i))){const r=n.at(-1);t&&r?.type==="paragraph"?(r.raw+=`
`+s.raw,r.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=r.text):n.push(s),t=i.length!==e.length,e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);const r=n.at(-1);r?.type==="text"?(r.raw+=`
`+s.raw,r.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=r.text):n.push(s);continue}if(e){const r="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(r);break}else throw new Error(r)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){let t=e,s=null;if(this.tokens.links){const a=Object.keys(this.tokens.links);if(a.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(t))!=null;)a.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(t=t.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+t.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.blockSkip.exec(t))!=null;)t=t.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+t.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(t))!=null;)t=t.slice(0,s.index)+"++"+t.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let i=!1,r="";for(;e;){i||(r=""),i=!1;let a;if(this.options.extensions?.inline?.some(o=>(a=o.call({lexer:this},e,n))?(e=e.substring(a.raw.length),n.push(a),!0):!1))continue;if(a=this.tokenizer.escape(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.tag(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.link(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(a.raw.length);const o=n.at(-1);a.type==="text"&&o?.type==="text"?(o.raw+=a.raw,o.text+=a.text):n.push(a);continue}if(a=this.tokenizer.emStrong(e,t,r)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.codespan(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.br(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.del(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.autolink(e)){e=e.substring(a.raw.length),n.push(a);continue}if(!this.state.inLink&&(a=this.tokenizer.url(e))){e=e.substring(a.raw.length),n.push(a);continue}let c=e;if(this.options.extensions?.startInline){let o=1/0;const h=e.slice(1);let p;this.options.extensions.startInline.forEach(g=>{p=g.call({lexer:this},h),typeof p=="number"&&p>=0&&(o=Math.min(o,p))}),o<1/0&&o>=0&&(c=e.substring(0,o+1))}if(a=this.tokenizer.inlineText(c)){e=e.substring(a.raw.length),a.raw.slice(-1)!=="_"&&(r=a.raw.slice(-1)),i=!0;const o=n.at(-1);o?.type==="text"?(o.raw+=a.raw,o.text+=a.text):n.push(a);continue}if(e){const o="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(o);break}else throw new Error(o)}}return n}}class ce{options;parser;constructor(e){this.options=e||F}space(e){return""}code({text:e,lang:n,escaped:t}){const s=(n||"").match(R.notSpaceStart)?.[0],i=e.replace(R.endingNewline,"")+`
`;return s?'<pre><code class="language-'+A(s)+'">'+(t?i:A(i,!0))+`</code></pre>
`:"<pre><code>"+(t?i:A(i,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:n}){return`<h${n}>${this.parser.parseInline(e)}</h${n}>
`}hr(e){return`<hr>
`}list(e){const n=e.ordered,t=e.start;let s="";for(let a=0;a<e.items.length;a++){const c=e.items[a];s+=this.listitem(c)}const i=n?"ol":"ul",r=n&&t!==1?' start="'+t+'"':"";return"<"+i+r+`>
`+s+"</"+i+`>
`}listitem(e){let n="";if(e.task){const t=this.checkbox({checked:!!e.checked});e.loose?e.tokens[0]?.type==="paragraph"?(e.tokens[0].text=t+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=t+" "+A(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:t+" ",text:t+" ",escaped:!0}):n+=t+" "}return n+=this.parser.parse(e.tokens,!!e.loose),`<li>${n}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let n="",t="";for(let i=0;i<e.header.length;i++)t+=this.tablecell(e.header[i]);n+=this.tablerow({text:t});let s="";for(let i=0;i<e.rows.length;i++){const r=e.rows[i];t="";for(let a=0;a<r.length;a++)t+=this.tablecell(r[a]);s+=this.tablerow({text:t})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+n+`</thead>
`+s+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const n=this.parser.parseInline(e.tokens),t=e.header?"th":"td";return(e.align?`<${t} align="${e.align}">`:`<${t}>`)+n+`</${t}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${A(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:n,tokens:t}){const s=this.parser.parseInline(t),i=Be(e);if(i===null)return s;e=i;let r='<a href="'+e+'"';return n&&(r+=' title="'+A(n)+'"'),r+=">"+s+"</a>",r}image({href:e,title:n,text:t}){const s=Be(e);if(s===null)return A(t);e=s;let i=`<img src="${e}" alt="${t}"`;return n&&(i+=` title="${A(n)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:A(e.text)}}class Me{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class O{options;renderer;textRenderer;constructor(e){this.options=e||F,this.options.renderer=this.options.renderer||new ce,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Me}static parse(e,n){return new O(n).parse(e)}static parseInline(e,n){return new O(n).parseInline(e)}parse(e,n=!0){let t="";for(let s=0;s<e.length;s++){const i=e[s];if(this.options.extensions?.renderers?.[i.type]){const a=i,c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){t+=c||"";continue}}const r=i;switch(r.type){case"space":{t+=this.renderer.space(r);continue}case"hr":{t+=this.renderer.hr(r);continue}case"heading":{t+=this.renderer.heading(r);continue}case"code":{t+=this.renderer.code(r);continue}case"table":{t+=this.renderer.table(r);continue}case"blockquote":{t+=this.renderer.blockquote(r);continue}case"list":{t+=this.renderer.list(r);continue}case"html":{t+=this.renderer.html(r);continue}case"paragraph":{t+=this.renderer.paragraph(r);continue}case"text":{let a=r,c=this.renderer.text(a);for(;s+1<e.length&&e[s+1].type==="text";)a=e[++s],c+=`
`+this.renderer.text(a);n?t+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):t+=c;continue}default:{const a='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return t}parseInline(e,n=this.renderer){let t="";for(let s=0;s<e.length;s++){const i=e[s];if(this.options.extensions?.renderers?.[i.type]){const a=this.options.extensions.renderers[i.type].call({parser:this},i);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){t+=a||"";continue}}const r=i;switch(r.type){case"escape":{t+=n.text(r);break}case"html":{t+=n.html(r);break}case"link":{t+=n.link(r);break}case"image":{t+=n.image(r);break}case"strong":{t+=n.strong(r);break}case"em":{t+=n.em(r);break}case"codespan":{t+=n.codespan(r);break}case"br":{t+=n.br(r);break}case"del":{t+=n.del(r);break}case"text":{t+=n.text(r);break}default:{const a='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return t}}class ae{options;block;constructor(e){this.options=e||F}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?E.lex:E.lexInline}provideParser(){return this.block?O.parse:O.parseInline}}class ss{defaults=xe();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=O;Renderer=ce;TextRenderer=Me;Lexer=E;Tokenizer=le;Hooks=ae;constructor(...e){this.use(...e)}walkTokens(e,n){let t=[];for(const s of e)switch(t=t.concat(n.call(this,s)),s.type){case"table":{const i=s;for(const r of i.header)t=t.concat(this.walkTokens(r.tokens,n));for(const r of i.rows)for(const a of r)t=t.concat(this.walkTokens(a.tokens,n));break}case"list":{const i=s;t=t.concat(this.walkTokens(i.items,n));break}default:{const i=s;this.defaults.extensions?.childTokens?.[i.type]?this.defaults.extensions.childTokens[i.type].forEach(r=>{const a=i[r].flat(1/0);t=t.concat(this.walkTokens(a,n))}):i.tokens&&(t=t.concat(this.walkTokens(i.tokens,n)))}}return t}use(...e){const n=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(t=>{const s={...t};if(s.async=this.defaults.async||s.async||!1,t.extensions&&(t.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const r=n.renderers[i.name];r?n.renderers[i.name]=function(...a){let c=i.renderer.apply(this,a);return c===!1&&(c=r.apply(this,a)),c}:n.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const r=n[i.level];r?r.unshift(i.tokenizer):n[i.level]=[i.tokenizer],i.start&&(i.level==="block"?n.startBlock?n.startBlock.push(i.start):n.startBlock=[i.start]:i.level==="inline"&&(n.startInline?n.startInline.push(i.start):n.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(n.childTokens[i.name]=i.childTokens)}),s.extensions=n),t.renderer){const i=this.defaults.renderer||new ce(this.defaults);for(const r in t.renderer){if(!(r in i))throw new Error(`renderer '${r}' does not exist`);if(["options","parser"].includes(r))continue;const a=r,c=t.renderer[a],o=i[a];i[a]=(...h)=>{let p=c.apply(i,h);return p===!1&&(p=o.apply(i,h)),p||""}}s.renderer=i}if(t.tokenizer){const i=this.defaults.tokenizer||new le(this.defaults);for(const r in t.tokenizer){if(!(r in i))throw new Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;const a=r,c=t.tokenizer[a],o=i[a];i[a]=(...h)=>{let p=c.apply(i,h);return p===!1&&(p=o.apply(i,h)),p}}s.tokenizer=i}if(t.hooks){const i=this.defaults.hooks||new ae;for(const r in t.hooks){if(!(r in i))throw new Error(`hook '${r}' does not exist`);if(["options","block"].includes(r))continue;const a=r,c=t.hooks[a],o=i[a];ae.passThroughHooks.has(r)?i[a]=h=>{if(this.defaults.async)return Promise.resolve(c.call(i,h)).then(g=>o.call(i,g));const p=c.call(i,h);return o.call(i,p)}:i[a]=(...h)=>{let p=c.apply(i,h);return p===!1&&(p=o.apply(i,h)),p}}s.hooks=i}if(t.walkTokens){const i=this.defaults.walkTokens,r=t.walkTokens;s.walkTokens=function(a){let c=[];return c.push(r.call(this,a)),i&&(c=c.concat(i.call(this,a))),c}}this.defaults={...this.defaults,...s}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,n){return E.lex(e,n??this.defaults)}parser(e,n){return O.parse(e,n??this.defaults)}parseMarkdown(e){return(t,s)=>{const i={...s},r={...this.defaults,...i},a=this.onError(!!r.silent,!!r.async);if(this.defaults.async===!0&&i.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));r.hooks&&(r.hooks.options=r,r.hooks.block=e);const c=r.hooks?r.hooks.provideLexer():e?E.lex:E.lexInline,o=r.hooks?r.hooks.provideParser():e?O.parse:O.parseInline;if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(t):t).then(h=>c(h,r)).then(h=>r.hooks?r.hooks.processAllTokens(h):h).then(h=>r.walkTokens?Promise.all(this.walkTokens(h,r.walkTokens)).then(()=>h):h).then(h=>o(h,r)).then(h=>r.hooks?r.hooks.postprocess(h):h).catch(a);try{r.hooks&&(t=r.hooks.preprocess(t));let h=c(t,r);r.hooks&&(h=r.hooks.processAllTokens(h)),r.walkTokens&&this.walkTokens(h,r.walkTokens);let p=o(h,r);return r.hooks&&(p=r.hooks.postprocess(p)),p}catch(h){return a(h)}}}onError(e,n){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const s="<p>An error occurred:</p><pre>"+A(t.message+"",!0)+"</pre>";return n?Promise.resolve(s):s}if(n)return Promise.reject(t);throw t}}}const q=new ss;function v(u,e){return q.parse(u,e)}v.options=v.setOptions=function(u){return q.setOptions(u),v.defaults=q.defaults,Qe(v.defaults),v};v.getDefaults=xe;v.defaults=F;v.use=function(...u){return q.use(...u),v.defaults=q.defaults,Qe(v.defaults),v};v.walkTokens=function(u,e){return q.walkTokens(u,e)};v.parseInline=q.parseInline;v.Parser=O;v.parser=O.parse;v.Renderer=ce;v.TextRenderer=Me;v.Lexer=E;v.lexer=E.lex;v.Tokenizer=le;v.Hooks=ae;v.parse=v;v.options;v.setOptions;v.use;v.walkTokens;v.parseInline;O.parse;E.lex;const rs=H({__name:"RuntimeOptionsCard",setup(u,{expose:e}){e();function n(p){const g=360/p.length,w={};for(let d=0;d<p.length;d++){const m=p[d];if(d===0)w[m.name]="rgba(0, 0, 0, 0.15)";else{const k=Math.round(30+d*g)%360;w[m.name]=`hsl(${k}, 60%, 85%)`}}return w}function t(p){return Object.assign({},...p.map(g=>({[g.name]:g.description})))}const{data:s}=N(ie()),i=D(()=>{if(s.value){let p=Re(s.value.options);p=p.sort((w,d)=>{const m=w.name.toUpperCase(),k=d.name.toUpperCase();return m<k?-1:m>k?1:0});const g=w=>{delete w.$type,Object.entries(w).forEach(d=>{d[1]!==null&&typeof d[1]=="object"&&g(d[1])})};return Object.entries(p).forEach(w=>{g(w[1].values)}),p}return null}),r=D(()=>n(s.value.allSources)),a=D(()=>t(s.value.allSources));function c(p){return p.charAt(0).toUpperCase()+p.slice(1)}function o(p){const g=v.parseInline(p);if(typeof g=="string")return g;g.then(w=>w).catch(w=>{console.error(w)})}const h={createSourceColors:n,createTooltips:t,runtimeOptionsData:s,runtimeOptions:i,sourceColors:r,tooltips:a,fixupKeyCasing:c,markdown:o,get cloneDeep(){return Re},get marked(){return v},computed:D,get MBadge(){return ue},get MCollapseCard(){return St},get MList(){return ct},get MListItem(){return ke},get useSubscription(){return N},get getRuntimeOptionsSubscriptionOptions(){return ie}};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}}),as=["innerHTML"],is={key:1,class:"tw-italic"},os={class:"tw-mb-1.5"},ls=["innerHTML"],cs={key:1,class:"tw-italic"},us={key:4},ds={key:5};function ps(u,e,n,t,s,i){const r=B("meta-raw-data");return f(),y($,null,[(f(!0),y($,null,j(t.runtimeOptions,a=>(f(),_(t.MCollapseCard,{class:"tw-mx-auto tw-mb-4 tw-max-w-2xl",key:a.name,title:a.name.replace(/([a-z])([A-Z])/g,"$1 $2"),badge:Object.keys(a.values).length,"data-testid":"runtime-option-collapse-header"},{"header-right":b(()=>[S(t.MBadge,null,{default:b(()=>[T(x(a.isStatic?"Static":"Dynamic"),1)],void 0,!0),_:2},1024)]),subtitle:b(()=>[a.description?(f(),y("span",{key:0,innerHTML:t.markdown(a.description)},null,8,as)):(f(),y("span",is,"No description available."))]),default:b(()=>[S(t.MList,null,{default:b(()=>[(f(!0),y($,null,j(a.values,(c,o)=>(f(),_(t.MListItem,{class:"tw-px-4",key:o,striped:""},{"top-right":b(()=>[l("span",null,x(a.sources[t.fixupKeyCasing(o)]),1)]),"bottom-left":b(()=>[l("div",os,[a.descriptions[t.fixupKeyCasing(o)]?(f(),y("span",{key:0,innerHTML:t.markdown(a.descriptions[t.fixupKeyCasing(o)])},null,8,ls)):(f(),y("span",cs,"No description available."))]),c===null?(f(),_(t.MBadge,{key:0,size:"large"},{default:b(()=>e[0]||(e[0]=[T("null")]),void 0,!0),_:1})):I("",!0),c===""?(f(),_(t.MBadge,{key:1,size:"large"},{default:b(()=>e[1]||(e[1]=[T("empty string")]),void 0,!0),_:1})):c===!0?(f(),_(t.MBadge,{key:2,variant:"success",size:"large"},{default:b(()=>e[2]||(e[2]=[T("true")]),void 0,!0),_:1})):c===!1?(f(),_(t.MBadge,{key:3,variant:"danger",size:"large"},{default:b(()=>e[3]||(e[3]=[T("false")]),void 0,!0),_:1})):Array.isArray(c)||typeof c=="object"?(f(),y("pre",us,x(c),1)):(f(),y("span",ds,x(c),1))]),default:b(()=>[l("span",{class:"tw-rounded tw-px-1.5 tw-py-0.5 tw-text-xs tw-text-neutral-700",style:ut(`background: ${t.sourceColors[a.sources[t.fixupKeyCasing(o)]]||"lightgrey"}`)},x(t.fixupKeyCasing(o)),5)],void 0,!0),_:2},1024))),128))],void 0,!0),_:2},1024)],void 0,!0),_:2},1032,["title","badge"]))),128)),S(r,{kvPair:t.runtimeOptions,name:"runtimeOptions"},null,8,["kvPair"])],64)}const hs=Z(rs,[["render",ps],["__file","RuntimeOptionsCard.vue"]]),gs=H({__name:"EnvironmentView",setup(u,{expose:e}){e();const n=Ee(),{data:t,error:s}=N(Oe()),{data:i,error:r}=N(Pe()),{data:a,error:c}=N(G()),{data:o,error:h}=N(U()),{data:p,error:g}=N(ie()),w=[{label:"Servers"},{label:"Database",permission:"api.database.status"},{label:"Runtime Options",permission:"api.runtime_options.view"}],d=D(()=>p.value?.options?.find(k=>k.name==="Deployment")?.values?.chartVersion||"Null"),m={staticInfos:n,backendStatusData:t,backendStatusError:s,databaseItemCountsData:i,databaseItemCountsError:r,clusterData:a,clusterError:c,databaseStatusData:o,databaseStatusError:h,runtimeOptionsData:p,runtimeOptionsError:g,tabOptions:w,chartVersion:d,computed:D,get useStaticInfos(){return Ee},get MPageOverviewCard(){return pt},get MSingleColumnLayout(){return gt},get MTwoColumnLayout(){return mt},get MViewContainer(){return ht},get MTabLayout(){return ft},get MErrorCallout(){return dt},get MBadge(){return ue},get MTextButton(){return Ze},get useSubscription(){return N},DatabaseItemsCard:Et,DatabaseShardsCard:Bt,NodeSetsCard:Mn,RuntimeOptionsCard:hs,get getDatabaseStatusSubscriptionOptions(){return U},get getClusterSubscriptionOptions(){return G},get getRuntimeOptionsSubscriptionOptions(){return ie},get getBackendStatusSubscriptionOptions(){return Oe},get getDatabaseItemCountsSubscriptionOptions(){return Pe}};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}}),fs={class:"tw-mb-4 tw-mt-2 tw-text-xs tw-text-neutral-500"},ms={class:"tw-mb-1 tw-font-semibold"},bs={class:"tw-w-full"},ws={class:"tw-divide-y tw-divide-neutral-200 tw-border-t tw-border-neutral-200 *:*:tw-py-1"},ks={class:"tw-text-right"},xs={class:"tw-text-right"},ys={class:"tw-text-right"},Ss={class:"tw-text-right"},_s={key:0},vs={key:1};function Cs(u,e,n,t,s,i){const r=B("fa-icon"),a=B("meta-raw-data");return f(),_(t.MViewContainer,{permission:"dashboard.environment.view","full-width":""},{overview:b(()=>[S(t.MPageOverviewCard,{title:"Environment Details"},{default:b(()=>[e[9]||(e[9]=l("p",null,"Overview of the current environment this game server is running in.",-1)),l("p",fs,[e[1]||(e[1]=T("Easiest way to configure your game servers to act differently in different environments is through the runtime options system. Please have a look at the ")),S(t.MTextButton,{to:"https://docs.metaplay.io/game-server-programming/how-to-guides/working-with-runtime-options.html"},{default:b(()=>e[0]||(e[0]=[T("runtime options documentation")]),void 0,!0),_:1}),e[2]||(e[2]=T(" to get started."))]),l("div",ms,[S(r,{class:"tw-mr-1",icon:"chart-bar"}),e[3]||(e[3]=l("span",null,"Overview",-1))]),l("table",bs,[l("tbody",ws,[l("tr",null,[e[4]||(e[4]=l("td",null,"Environment Name",-1)),l("td",ks,x(t.staticInfos.projectInfo.projectName),1)]),l("tr",null,[e[5]||(e[5]=l("td",null,"Environment Type",-1)),l("td",xs,x(t.staticInfos.environmentInfo.environmentFamily),1)]),l("tr",null,[e[6]||(e[6]=l("td",null,"Chart Version",-1)),l("td",{class:L(["tw-text-right",{"tw-italic tw-text-neutral-500":t.chartVersion==="Null"}])},x(t.chartVersion==="Null"?"Not available":t.chartVersion),3)]),l("tr",null,[e[7]||(e[7]=l("td",null,"Maintenance Mode",-1)),l("td",ys,[S(t.MBadge,{variant:t.backendStatusData?.maintenanceStatus.isInMaintenance?"warning":"neutral"},{default:b(()=>[T(x(t.backendStatusData?.maintenanceStatus.isInMaintenance?"On":"Off"),1)],void 0,!0),_:1},8,["variant"])])]),l("tr",null,[e[8]||(e[8]=l("td",null,"Total Players in Database",-1)),l("td",Ss,[t.databaseItemCountsData?(f(),y("span",_s,x(t.databaseItemCountsData.totalItemCounts.Players),1)):(f(),y("span",vs,"Not available"))])])])])],void 0,!0),_:1})]),default:b(()=>[S(t.MTabLayout,{tabs:t.tabOptions},{"tab-0":b(()=>[S(t.MSingleColumnLayout,{class:"tw-mb-4"},{default:b(()=>[t.clusterError?(f(),_(t.MErrorCallout,{key:0,class:"tw-mb-3",title:"Cluster Error",error:t.clusterError},null,8,["error"])):I("",!0),t.clusterError?(f(),_(t.MErrorCallout,{key:1,class:"tw-mb-3",title:"Load Tracking Error",error:t.clusterError},null,8,["error"])):(f(),_(t.NodeSetsCard,{key:2})),S(a,{kvPair:t.clusterData,name:"cluster"},null,8,["kvPair"])],void 0,!0),_:1})]),"tab-1":b(()=>[t.databaseStatusError?(f(),_(t.MErrorCallout,{key:0,title:"Database Error",error:t.databaseStatusError},null,8,["error"])):(f(),_(t.MTwoColumnLayout,{key:1,class:"tw-mb-4"},{default:b(()=>[S(t.DatabaseShardsCard),S(t.DatabaseItemsCard)],void 0,!0),_:1})),S(a,{kvPair:t.databaseStatusData,name:"databaseStatus"},null,8,["kvPair"])]),"tab-2":b(()=>[t.runtimeOptionsError?(f(),_(t.MErrorCallout,{key:0,title:"Runtime Options Error",error:t.runtimeOptionsError},null,8,["error"])):(f(),_(t.RuntimeOptionsCard,{key:1}))]),_:1})]),_:1})}const Ys=Z(gs,[["render",Cs],["__file","EnvironmentView.vue"]]);export{Ys as default};
