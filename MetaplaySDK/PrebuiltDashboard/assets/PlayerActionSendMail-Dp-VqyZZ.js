import{d as _,x as u,f as s,c as f,ad as g,ae as M,b as x,o as k,a as w,k as i,w as d,n as A,p as V,l as N,_ as B}from"./index-B7jvAjdE.js";import{M as P}from"./MActionModalButton-CvWVuTB-.js";import{a as y}from"./players-CydHenLG.js";import{M as h}from"./MetaLanguageLabel-CAF0iIvu.js";import{M as D}from"./MetaGeneratedForm-BcVgOIy3.js";import"./MActionModal-coQLkvWs.js";import"./index-fVjXqxSF.js";import"./utils-Dwlepb3M.js";import"./MInputMultiSelectCheckbox-D_9f7ub1.js";import"./MInputCheckbox-BqateWtE.js";import"./index-B_QkKjtG.js";import"./MInputHintMessage-DbuBS4Kn.js";import"./GeneratedUiFormDynamicComponent-DrqrTIRR.js";const G=_({__name:"PlayerActionSendMail",props:{playerId:{}},setup(c,{expose:a}){a();const l=c,e=g(),{data:n,refresh:r}=u(y(l.playerId)),o=s({}),t=s(!1);function b(){o.value={},t.value=!1}const S=f(()=>o.value?t.value?void 0:"Some fields contain invalid data. Check that the fields are filled in correctly to proceed.":"Fill in the required fields to proceed."),{showSuccessNotification:m}=M();async function v(){await e.post(`/players/${n.value.id}/sendMail`,o.value),m(`In-game mail sent to ${n.value.model.playerName||"n/a"}.`),r()}const p={props:l,gameServerApi:e,playerData:n,playerRefresh:r,mail:o,isValid:t,resetModal:b,okButtonDisabledReason:S,showSuccessNotification:m,sendMail:v,ref:s,computed:f,get useGameServerApi(){return g},get MActionModalButton(){return P},get useNotifications(){return M},get useSubscription(){return u},get getSinglePlayerSubscriptionOptions(){return y},MetaLanguageLabel:h,MetaGeneratedForm:D};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),C={key:0},I={class:"tw-mr-32 tw-text-xs+ tw-text-neutral-500"};function L(c,a,l,e,n,r){const o=x("fa-icon");return e.playerData?(k(),w("div",C,[i(e.MActionModalButton,{"modal-title":"Send In-Game Mail",action:e.sendMail,"trigger-button-label":"Send Mail","ok-button-label":"Send Mail","ok-button-disabled-tooltip":e.okButtonDisabledReason,permission:"api.players.mail",onShow:e.resetModal,"data-testid":"action-mail"},{"action-button-icon":d(()=>[i(o,{class:"mr-2",icon:"paper-plane"})]),"modal-subtitle":d(()=>[A("span",I,[a[2]||(a[2]=V("Player's language: ")),i(e.MetaLanguageLabel,{language:e.playerData.model.language,variant:"badge"},null,8,["language"])])]),default:d(()=>[i(e.MetaGeneratedForm,{class:"!tw-overflow-x-hidden",modelValue:e.mail,"onUpdate:modelValue":a[0]||(a[0]=t=>e.mail=t),typeName:"Metaplay.Core.InGameMail.MetaInGameMail",forcedLocalization:e.playerData.model.language,page:"PlayerActionSendMail","logic-version":e.playerData.model.logicVersion,onStatus:a[1]||(a[1]=t=>e.isValid=t)},null,8,["modelValue","forcedLocalization","logic-version"])]),_:1},8,["ok-button-disabled-tooltip"])])):N("",!0)}const W=B(G,[["render",L],["__file","PlayerActionSendMail.vue"]]);export{W as default};
