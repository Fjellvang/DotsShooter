import{d as ut,o,a as r,n as i,l as y,_ as ct,N as x,c as _,f as D,C as N,cG as nt,aU as it,ck as Ct,M as Tt,bN as Pt,a8 as Bt,L as It,bM as Ut,b as B,e as C,w as k,k as h,p as g,t as v,F as lt,r as ot,$ as I,bd as Lt,b5 as at,b6 as rt,bY as Ft,a2 as Ot}from"./index-B7jvAjdE.js";import{M as At}from"./MInputMultiSelectCheckbox-D_9f7ub1.js";import{M as Ht}from"./MInputSingleSelectSwitch-CuptGC6e.js";import{M as Nt}from"./MInputText-CzhsT8yb.js";const Vt=ut({__name:"MetaEventStreamCardGroupLine",props:{variant:{}},setup(m,{expose:t}){t();const s={};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}}),zt={key:0,class:"h-100 d-flex justify-content-center text-success",style:{position:"relative"}},Rt={viewBox:"0 0 10 10",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",fill:"currentColor"}},jt={viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",style:{fill:"currentColor","z-index":"1"}},Kt={key:1,class:"h-100 d-flex justify-content-center text-success",style:{position:"relative"}},Gt={viewBox:"0 0 10 10",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",fill:"currentColor"}},qt={viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",style:{fill:"currentColor","z-index":"1"}},Wt={key:2,class:"h-100 d-flex justify-content-center text-success",style:{position:"relative"}},Yt={viewBox:"0 0 10 10",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",fill:"currentColor"}},Zt={viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",style:{fill:"currentColor","z-index":"1"}},Jt={key:3,class:"h-100 d-flex justify-content-center text-success",style:{position:"relative"}},Qt={viewBox:"0 0 10 10",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",fill:"currentColor"}},Xt={viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",style:{fill:"currentColor","z-index":"1"}},$t={key:4,class:"h-100 d-flex justify-content-center text-success",style:{position:"relative"}},te={viewBox:"0 0 10 10",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",fill:"currentColor"}},ee={viewBox:"0 0 10 10",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",fill:"currentColor"}},se={viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",style:{fill:"currentColor","z-index":"1"}},ne={key:5,class:"h-100 d-flex justify-content-center text-success",style:{position:"relative"}},ie={viewBox:"0 0 10 10",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",fill:"currentColor"}},le={viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",style:{fill:"currentColor","z-index":"1"}},oe={key:6,class:"h-100 d-flex justify-content-center text-success",style:{position:"relative"}},ae={viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",style:{fill:"currentColor","z-index":"1"}},re={key:7,class:"h-100 d-flex justify-content-center text-success",style:{position:"relative"}},de={viewBox:"0 0 10 10",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",top:"0",left:"32.5%",width:"35%",fill:"currentColor"}},ue={viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",style:{fill:"currentColor","z-index":"1"}},ce={key:8,class:"h-100 d-flex justify-content-center text-success",style:{position:"relative"}},he={key:9,class:"h-100 d-flex justify-content-center text-success",style:{position:"relative"}};function pe(m,t,s,e,c,a){return s.variant==="newest-terminated"?(o(),r("div",zt,[(o(),r("svg",Rt,t[0]||(t[0]=[i("rect",{x:"3.5",y:"5",width:"3",height:"1"},null,-1)]))),(o(),r("svg",jt,t[1]||(t[1]=[i("rect",{x:"4.5",y:"5",width:"1",height:"5"},null,-1)])))])):s.variant==="newest-unterminated"?(o(),r("div",Kt,[(o(),r("svg",Gt,t[2]||(t[2]=[i("rect",{x:"3.5",y:"5",width:"3",height:"1"},null,-1)]))),(o(),r("svg",qt,t[3]||(t[3]=[i("rect",{x:"4.5",y:"5",width:"1",height:"5"},null,-1)])))])):s.variant==="oldest-terminated"?(o(),r("div",Wt,[(o(),r("svg",Yt,t[4]||(t[4]=[i("rect",{x:"3.5",y:"5",width:"3",height:"1"},null,-1)]))),(o(),r("svg",Zt,t[5]||(t[5]=[i("rect",{x:"4.5",y:"0",width:"1",height:"5"},null,-1)])))])):s.variant==="oldest-unterminated"?(o(),r("div",Jt,[(o(),r("svg",Qt,t[6]||(t[6]=[i("rect",{x:"3.5",y:"5",width:"3",height:"1"},null,-1)]))),(o(),r("svg",Xt,t[7]||(t[7]=[i("rect",{x:"4.5",y:"0",width:"1",height:"5"},null,-1)])))])):s.variant==="both-terminated"?(o(),r("div",$t,[(o(),r("svg",te,t[8]||(t[8]=[i("rect",{x:"3.5",y:"0",width:"3",height:"1"},null,-1)]))),(o(),r("svg",ee,t[9]||(t[9]=[i("rect",{x:"3.5",y:"10",width:"3",height:"1"},null,-1)]))),(o(),r("svg",se,t[10]||(t[10]=[i("rect",{x:"4.5",y:"2.5",width:"1",height:"5.5"},null,-1)])))])):s.variant==="skip"?(o(),r("div",ne,[(o(),r("svg",ie,t[11]||(t[11]=[i("rect",{x:"3.5",y:"4",width:"3",height:"1",transform:"rotate(-25, 3.5, 4)"},null,-1),i("rect",{x:"3.5",y:"6",width:"3",height:"1",transform:"rotate(-25, 3.5, 6)"},null,-1)]))),(o(),r("svg",le,t[12]||(t[12]=[i("rect",{x:"4.5",y:"0",width:"1",height:"4"},null,-1),i("rect",{x:"4.5",y:"6",width:"1",height:"4"},null,-1)])))])):s.variant==="line"?(o(),r("div",oe,[(o(),r("svg",ae,t[13]||(t[13]=[i("rect",{x:"4.5",y:"0",width:"1",height:"10"},null,-1)])))])):s.variant==="grouped-event"?(o(),r("div",re,[(o(),r("svg",de,t[14]||(t[14]=[i("circle",{cx:"5",cy:"5",r:"4.5"},null,-1)]))),(o(),r("svg",ue,t[15]||(t[15]=[i("rect",{x:"4.5",y:"0",width:"1",height:"10"},null,-1)])))])):s.variant==="root-event"?(o(),r("div",ce)):s.variant==="error"?(o(),r("div",he,t[16]||(t[16]=[i("small",null,"variant error",-1)]))):y("",!0)}const we=ct(Vt,[["render",pe],["__file","MetaEventStreamCardGroupLine.vue"]]);class K{id;path;time;type;typeData;constructor(t,s,e,c,a){this.id=t,this.path=s,this.time=e,this.type=c,this.typeData=a}search(t){return this.id.toLowerCase().includes(t)}getEventDisplayType(){}getEventKeywords(){}}class Z extends K{constructor(t,s,e,c,a,u,w,f){const E={title:s??"No title.",description:e??"No description.",sourceData:a,author:u,viewMore:w,viewMoreLink:f,terminatorStyle:null};super(c,"",t,"Event",E)}search(t){return this.typeData.title.toLowerCase().includes(t)||this.typeData.description.toLowerCase().includes(t)||this.typeData.author?.toLowerCase().includes(t)||super.search(t)}getEventDisplayType(){return this.typeData.title}getEventKeywords(){return this.typeData.sourceData.payload?.keywords}}class me extends K{constructor(t,s,e,c){const a=s.typeData.sourceData?.payload.sessionToken||"Unknown",u=s.time,w=e.time,f=x.fromISO(w).diff(x.fromISO(u)),E={startTime:u,duration:f,sessionNumber:s.typeData.sourceData?.payload.sessionNumber||"Unknown",numEvents:c,deviceName:s.typeData.sourceData?.payload.deviceModel||"Unknown"};super(a,t,w,"Session",E)}search(t){return this.typeData.deviceName.toLowerCase().includes(t)||super.search(t)}}class fe extends K{constructor(t,s,e,c){const a=s.time,u=e.time,w=x.fromISO(u).diff(x.fromISO(a)),f={numEvents:c,repeatedTitle:s.typeData.title,duration:w};super("",t,u,"RepeatedEvents",f)}search(t){return this.typeData.repeatedTitle.toLowerCase().includes(t)||super.search(t)}}class ge extends K{constructor(t,s,e,c){const a=x.fromISO(s.time).toISODate()??"Unknown",u={date:s.time,numEvents:c,deviceName:s.typeData.sourceData?.payload.deviceModel||""};super(a,t,e.time,"Day",u)}search(t){return this.typeData.deviceName.toLowerCase().includes(t)||super.search(t)}}function Is(m){const t=(a,u)=>{const w=[],f=`session_${x.fromISO(a[0].time).toUnixInteger()}_${a[0].id}`;return w.push(...a.map(E=>(E.path=E.path+f,E))),w.length>1?(w[0].typeData.terminatorStyle=u?"oldest-terminated":"oldest-unterminated",w[w.length-1].typeData.terminatorStyle="newest-terminated"):w[0].typeData.terminatorStyle="both-terminated",w.push(new me(f,a[0],a[a.length-1],a.length)),w};let s=[],e=[],c=0;return m.forEach(a=>{if(a instanceof Z){const u=a.typeData.sourceData.payload.$type;u==="Metaplay.Core.Player.PlayerEventClientConnected"?(e.push(a),c++):u==="Metaplay.Core.Player.PlayerEventClientDisconnected"?c>0?(e.push(a),s.push(...t(e,!0)),e=[]):(s.push(a),s=t(s,!1)):e.length?e.push(a):s.push(a)}else s.push(a)}),e.length&&s.push(...t(e,!0)),s}function Us(m){const t=e=>{const c=[],a=`date_${x.fromISO(e[0].time).toUnixInteger()}_${e[0].id}`;return c.push(...e.map(u=>(u.path=u.path+a,u))),c.length>1?(c[0].typeData.terminatorStyle="oldest-terminated",c[c.length-1].typeData.terminatorStyle="newest-terminated"):c[0].typeData.terminatorStyle="both-terminated",c.push(new ge(a,e[0],e[e.length-1],e.length)),c},s=[];if(m.length){let e=[],c=x.fromISO(m[0].time).toISODate();m.forEach(a=>{e.push(a);const u=x.fromISO(a.time).toISODate();u!==c&&(s.push(...t(e)),e=[],c=u)}),e.length&&s.push(...t(e))}return s}function Ls(m,t=5){const s=a=>{if(a.length>=t){const u=`repeat_${x.fromISO(a[0].time).toUnixInteger()}_${a[0].id}`,w=[];return w.push(...a.map(f=>(f.path=f.path?`${f.path}.${u}`:u,f))),w.push(new fe(a[0].path,a[0],a[a.length-1],a.length)),w}else return a},e=[];let c=[];return m.forEach(a=>{typeof a==typeof Z?c.length===0?c=[a]:c[0].typeData.title===a.typeData.title?c.push(a):(e.push(...s(c)),c=[a]):e.push(a)}),e.push(...s(c)),e}function Fs(m){const t=m.reduce((a,u)=>a+(u instanceof Z?1:0),0);let s=null,e=null,c=null;return m.length&&(s=x.fromISO(m[0].time),e=x.fromISO(m[m.length-1].time),c=e.diff(s)),{numEvents:t,oldestEventTime:s,newestEventTime:e,duration:c}}function dt(m){const t=[],s=[];return m.forEach(e=>{const c=e.getEventDisplayType();c&&!t.includes(c)&&t.push(c);const a=e.getEventKeywords();a&&a.forEach(u=>{s.includes(u)||s.push(u)})}),t.sort(),s.sort(),{eventTypes:t,eventKeywords:s}}const ve=ut({__name:"MetaEventStreamCard",props:{title:{},icon:{default:""},eventStream:{default:null},eventStreamLoading:{type:Boolean},utilitiesMode:{default:"filter"},utilitiesCondition:{default:"and"},searchPreHighlight:{default:void 0},keywordPreFilters:{default:()=>[]},eventTypePreFilters:{default:()=>[]},emptyMessage:{default:"No events in this stream."},noResultsMessage:{default:"No events found. Try a different search string? 🤔"},maxHeight:{default:""},permission:{default:""},showViewMoreLink:{type:Boolean,default:!1},showTimeDeltas:{type:Boolean,default:!0},allowPausing:{type:Boolean}},setup(m,{expose:t}){t();const s=m,e=_(()=>s.eventTypePreFilters.length===0&&s.keywordPreFilters.length===0?s.eventStream:s.eventStream?.filter(n=>{if(n.type!=="Event"&&n.type!=="RepeatedEvents"||s.eventTypePreFilters.length>0&&s.eventTypePreFilters.includes(n.getEventDisplayType()??""))return!0;const d=n.getEventKeywords();return!!(s.keywordPreFilters.length>0&&d&&s.keywordPreFilters.some(p=>d.includes(p)))})),c=_(()=>dt(e.value??[])),a=D(""),u=D([]),w=D([]),f=D(s.utilitiesMode);N(()=>s.utilitiesMode,n=>{f.value=n});const E=D(s.utilitiesCondition);N(()=>s.utilitiesCondition,n=>{E.value=n});const S=_(()=>{if(A.value){let n=P.value;return(s.searchPreHighlight||M.value||T.value)&&(n=n.map(d=>{const p=l(d);let b=!1;return E.value==="and"&&(M.value||T.value)?b=(a.value?U(d):!0)&&(u.value.length>0?L(d):!0)&&(w.value.length>0?G(d):!0):b=U(d)||L(d)||G(d),d.preHighlightMatch=p,d.userHighlightMatch=b,d})),f.value==="filter"&&(M.value||T.value)&&(n=n.filter(d=>d.userHighlightMatch)),n}else return P.value}),O=_(()=>{const n=[];return M.value&&n.push("search string"),u.value.length>0&&n.push("selected event type(s)"),w.value.length>0&&n.push("selected keyword(s)"),n}),A=_(()=>M.value||T.value||!!s.searchPreHighlight),M=_(()=>a.value.length>=1),T=_(()=>u.value.length>0||w.value.length>0);function l(n){return!!s.searchPreHighlight&&n.search(s.searchPreHighlight.toLocaleLowerCase())}function U(n){return!!a.value&&n.search(a.value.toLocaleLowerCase())}function L(n){return u.value.includes(n.getEventDisplayType()??"")}function G(n){const d=n.getEventKeywords();return w.value.some(p=>d?.includes(p))}function ht(n){return n?P.value.reduce((d,p)=>p.getEventDisplayType()===n?d+1:d,0):0}function pt(n){return n?P.value.reduce((d,p)=>(p.getEventKeywords()??[]).includes(n)?d+1:d,0):0}function wt(n){return n.preHighlightMatch?"presearch-highlight":f.value==="filter"?"":n.userHighlightMatch?"user-highlight":""}N([a,u,w],q);const F=D([]);function q(){A.value&&new Set(S.value.filter(d=>d.preHighlightMatch||d.userHighlightMatch).map(d=>d.path)).forEach(d=>{let p="";d.split(".").forEach(b=>{p+=b,W(p),p+="."})})}function mt(n){if(n)if(F.value.includes(n))J(n);else{let d="";n.split(".").forEach(p=>{d+=p,W(d),d+="."})}}function W(n){F.value.includes(n)||F.value.push(n)}function J(n){const d=F.value.indexOf(n);d!==-1&&F.value.splice(d,1)}function V(n){return F.value.includes(n)}const H=D([]);function Q(n){return!!n.id}function ft(n){const{id:d}=n;if(d){const p=H.value.indexOf(d);p===-1?H.value.push(d):H.value.splice(p,1)}}function gt(n){return H.value.includes(n.id)}const P=nt([]),z=_(()=>S.value.filter(n=>{let d=n.path??"";if(n.type!=="Event"&&(d=d.substring(0,d.lastIndexOf("."))),!d)return!0;let p="",b=!0;const st=d.split(".");for(const Mt of st){if(p+=Mt,!V(p)){b=!1;break}p+="."}return b})),vt=_(()=>{let n=0;return z.value.map(d=>{const p={...d,decorations:{timeBetweenEvents:X(z.value[n],z.value[n+1]),lineVariant:tt(d)}};return V(d.path)&&(p.decorations.isPathUnfolded=!0),Q(d)&&(p.decorations.isEventExpandable=!0),++n,p})});function X(n,d){const p=n?.time,b=d?.time;return p&&b?x.fromISO(p).diff(x.fromISO(b)):null}const R=D(!1),Y=D(!1),$=D(x.now());function yt(){R.value=!R.value}let j=!1;N([e,R],([n,d],[p,b])=>{d?b&&(Y.value=!0):(P.value=n?.slice().reverse()??[],Y.value=!1,$.value=x.now()),!j&&P.value.length>0&&(j=!0,q())},{immediate:!0,deep:!1});const xt=_(()=>!!e.value),_t=D(!1),bt=_(()=>s.permission?it().doesHavePermission(s.permission):!0),kt=_(()=>{const n=P.value.length,d=S.value.length;return d!==n?`${d} / ${n}`:`${n}`}),Et=_(()=>{const n=[];return(s.keywordPreFilters.length>0||s.eventTypePreFilters.length>0)&&n.push("pre-filtered data"),s.searchPreHighlight&&n.push("pre-highlighted data"),f.value==="filter"&&(M.value||T.value)?n.push("filter active"):f.value==="highlight"&&(M.value||T.value)&&n.push("highlight active"),n.join(" & ")}),St=_(()=>P.value.length===0?"neutral":"primary");function tt(n){return n.type==="Event"?n.typeData.terminatorStyle?n.typeData.terminatorStyle:n.path?n.path.startsWith("repeat")?"none":"grouped-event":"none":n.type==="RepeatedEvents"&&n.path?n.path.startsWith("repeat")?"none":V(n.path)?"line":"skip":"error"}function Dt(n){const d=n.typeData.sourceData?.payload?.$type;if(d){const p=d.split(".").pop();if(p)return`event-${p.replace(/[^a-zA-Z0-9]/g,"-")}`}}const et={props:s,preFilteredEvents:e,filters:c,userSearchString:a,selectedEventTypes:u,selectedKeywords:w,internalUtilitiesMode:f,internalUtilitiesCondition:E,filteredOrHighlightedEventList:S,activeFilters:O,anyUtilityActive:A,userSearchActive:M,filtersActive:T,doesEventMatchPreHighlightSearch:l,doesEventMatchUserSearch:U,doesEventMatchCurrentEventTypeFilters:L,doesEventMatchCurrentKeywordFilters:G,countTypeMatches:ht,countKeywordMatches:pt,eventBackgroundClass:wt,unfoldedPaths:F,openPathsToHighlightedOrFilteredEvents:q,toggleFoldedPath:mt,openFoldedPath:W,closeFoldedPath:J,isPathUnfolded:V,expandedEvents:H,isEventExpandable:Q,toggleEventExpanded:ft,isEventExpanded:gt,eventList:P,searchedAndUnfoldedEventList:z,decoratedSearchedAndUnfoldedEventList:vt,timeBetweenEvents:X,isPaused:R,updateAvailable:Y,lastUpdated:$,togglePlayPauseState:yt,get hasReceivedEventStream(){return j},set hasReceivedEventStream(n){j=n},hasContent:xt,utilsOpen:_t,hasPermission:bt,badgeText:kt,topRightHintLabel:Et,badgeVariant:St,calculateLineVariant:tt,dataTestIdFromEvent:Dt,get DateTime(){return x},get Duration(){return Ct},computed:_,ref:D,shallowRef:nt,watch:N,get MBadge(){return Tt},get MIconButton(){return Pt},get MInputMultiSelectCheckbox(){return At},get MInputSingleSelectSwitch(){return Ht},get MInputText(){return Nt},get MTextButton(){return Bt},get MTooltip(){return It},get MTransitionCollapse(){return Ut},get usePermissions(){return it},MetaEventStreamCardGroupLine:we,get getFiltersForEventStream(){return dt}};return Object.defineProperty(et,"__isScriptSetup",{enumerable:!1,value:!0}),et}}),ye={key:2,class:"tw-pointer-events-none tw-ml-2 tw-w-5 tw-h-5 tw-fill-blue-500 tw-animate-spin",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512","aria-hidden":"true"},xe={style:{"margin-top":"-1rem"}},_e={class:"text-muted tw-italic small mr-2"},be={key:0,class:"small text-muted tw-text-center mb-4 pt-4"},ke={key:1,class:"tw-w-full card-manual-content-padding pt-2"},Ee={class:"text-muted"},Se={key:3},De=["id"],Me={key:0,class:"tw-border-b tw-border-neutral-200 tw-mb-3"},Ce={key:0},Te={key:1},Pe={class:"sm:tw-flex tw-items-center sm:tw-space-x-2"},Be={key:2,class:"text-muted small tw-italic"},Ie={key:4,class:"text-muted small tw-italic"},Ue={key:5,class:"tw-text-sm tw-mt-3"},Le={class:"tw-font-semibold"},Fe={key:0,class:"tw-font-semibold"},Oe={key:0,class:"tw-text-center tw-text-neutral-500 tw-text-xs+ tw-pb-2 tw-space-x-1"},Ae={key:1,class:"group-element-borders group-element-stripes tw-mb-3"},He=["data-testid"],Ne=["onClick"],Ve={class:"tw-grow"},ze={class:"tw-flex tw-justify-between"},Re={class:"tw-text-sm text-muted tw-ml-1"},je={class:"tw-text-sm"},Ke={class:"tw-flex tw-justify-between"},Ge={class:"tw-text-sm text-muted"},qe={class:"tw-text-sm"},We=["onClick"],Ye={class:"tw-grow"},Ze={class:"tw-flex tw-justify-between"},Je={class:"tw-text-sm"},Qe={class:"tw-text-sm text-muted"},Xe=["onClick"];const $e={class:"py-1 pr-2 text-right"},ts={key:0},es={key:0,class:"small text-muted"},ss={key:0},ns={key:1},is={key:0},ls={class:"pl-2"},os={key:0,class:"py-2"},as={class:"font-weight-bold"},rs={key:1},ds={class:"text-muted small"},us={class:"py-1 pr-2 text-right"},cs={key:0,class:"small text-muted"},hs={key:0},ps={key:1},ws={key:0},ms={class:"!tw-overflow-x-hidden"},fs=["onClick"],gs={class:"tw-w-full"},vs={class:"d-flex justify-content-between"},ys={class:"font-weight-bold"},xs={class:"font-weight-normal small text-muted tw-ml-1"},_s={class:"small",style:{"padding-top":"0.2rem"}},bs={class:"text-muted small text-break-word"},ks={key:0,class:"tw-my-1"},Es={class:"tw-bg-neutral-100 tw-text-xs tw-p-3 tw-border-neutral-200 tw-border tw-rounded-md"},Ss={class:"tw-text-neutral-600"},Ds={key:2,class:"small text-muted tw-text-center mb-4 pt-4"};function Ms(m,t,s,e,c,a){const u=B("fa-icon"),w=B("b-card-title"),f=B("b-skeleton"),E=B("b-row"),S=B("meta-time"),O=B("meta-duration"),A=B("meta-username"),M=B("meta-lazy-loader"),T=B("b-card");return o(),C(T,{class:I(["shadow-sm",{"bg-light":!e.hasContent||!e.hasPermission}]),style:{"min-height":"12rem"},"no-body":""},{default:k(()=>[i("div",{class:"tw-cursor-pointer tw-px-4 tw-flex tw-justify-between tw-items-center tw-pt-4 tw-cursor-pointer",onClick:t[1]||(t[1]=l=>e.utilsOpen=!e.utilsOpen)},[h(w,{class:"tw-flex tw-items-center"},{default:k(()=>[s.icon?(o(),C(u,{key:0,class:"mr-2",icon:s.icon},null,8,["icon"])):y("",!0),g(v(s.title),1),e.hasContent&&e.hasPermission?(o(),C(e.MBadge,{key:1,class:"tw-ml-1",shape:"pill",variant:e.badgeVariant,"data-testid":"badge-text"},{default:k(()=>[g(v(e.badgeText),1)],void 0,!0),_:1},8,["variant"])):y("",!0),s.eventStreamLoading?(o(),r("svg",ye,t[7]||(t[7]=[i("path",{d:"M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"},null,-1)]))):y("",!0)],void 0,!0),_:1}),i("span",xe,[i("span",_e,v(e.topRightHintLabel),1),h(e.MIconButton,{"disabled-tooltip":!e.hasContent||!e.eventList.length?"There are no events to search.":void 0,"aria-label":"Toggle the utilities menu",onClick:t[0]||(t[0]=l=>e.utilsOpen=!e.utilsOpen)},{default:k(()=>[h(u,{class:"tw-mr-1",icon:"angle-right",size:"sm"}),h(u,{icon:"search",size:"sm"})],void 0,!0),_:1},8,["disabled-tooltip"])])]),e.hasPermission?e.hasContent?e.eventList.length?(o(),r("div",Se,[h(e.MTransitionCollapse,null,{default:k(()=>[e.eventList.length&&e.utilsOpen?(o(),r("div",{key:0,class:"tw-bg-neutral-100 tw-w-full tw-border-t tw-border-b tw-border-neutral-200 tw-px-4 tw-py-3",id:s.title},[s.keywordPreFilters.length>0||s.eventTypePreFilters.length>0||s.searchPreHighlight?(o(),r("div",Me,[s.keywordPreFilters.length>0||s.eventTypePreFilters.length>0?(o(),r("div",Ce,[t[11]||(t[11]=i("div",{class:"tw-text-sm tw-leading-6 tw-font-bold"},"Event Data Filters",-1)),i("p",null,[t[10]||(t[10]=g("Event data has been pre-filtered down to events that match the following types OR keywords: ")),i("span",null,v(s.eventTypePreFilters.concat(s.keywordPreFilters).join(", ")),1)])])):y("",!0),s.searchPreHighlight?(o(),r("div",Te,[t[14]||(t[14]=i("div",{class:"tw-text-sm tw-leading-6 tw-font-bold"},"Pre-Highlight",-1)),i("p",null,[t[12]||(t[12]=g("Events matching the search string ")),h(e.MBadge,null,{default:k(()=>[g(v(s.searchPreHighlight),1)],void 0,!0),_:1}),t[13]||(t[13]=g(" are highlighted."))])])):y("",!0)])):y("",!0),i("div",Pe,[t[15]||(t[15]=i("div",{class:"tw-text-sm tw-leading-6 tw-font-bold"},"Utilities Mode",-1)),h(e.MInputSingleSelectSwitch,{"model-value":e.internalUtilitiesMode,options:[{label:"Highlight",value:"highlight"},{label:"Filter",value:"filter"}],size:"small","onUpdate:modelValue":t[2]||(t[2]=l=>e.internalUtilitiesMode=l)},null,8,["model-value"]),t[16]||(t[16]=i("div",{class:"tw-text-sm tw-leading-6 tw-font-bold"},"Logic Condition",-1)),h(e.MInputSingleSelectSwitch,{"model-value":e.internalUtilitiesCondition,options:[{label:"And",value:"and"},{label:"Or",value:"or"}],size:"small","onUpdate:modelValue":t[3]||(t[3]=l=>e.internalUtilitiesCondition=l)},null,8,["model-value"])]),t[19]||(t[19]=i("div",{class:"tw-text-sm tw-leading-6 tw-font-bold"},"Search",-1)),h(e.MInputText,{class:"tw-mb-2","model-value":e.userSearchString,placeholder:"Type your search here...",variant:e.userSearchActive?"success":"default",debounce:300,showClearButton:"","onUpdate:modelValue":t[4]||(t[4]=l=>e.userSearchString=l)},null,8,["model-value","variant"]),t[20]||(t[20]=i("div",{class:"tw-text-sm tw-leading-6 tw-font-bold"},"Event Types",-1)),e.filters.eventTypes.length>0?(o(),C(e.MInputMultiSelectCheckbox,{key:1,"model-value":e.selectedEventTypes,options:e.filters.eventTypes.map(l=>({label:`${l} (${e.countTypeMatches(l)})`,value:l})),size:"small","onUpdate:modelValue":t[5]||(t[5]=l=>e.selectedEventTypes=l)},null,8,["model-value","options"])):(o(),r("div",Be,"None available for this event stream.")),t[21]||(t[21]=i("div",{class:"tw-text-sm tw-leading-6 tw-font-bold"},"Keywords",-1)),e.filters.eventKeywords.length>0?(o(),C(e.MInputMultiSelectCheckbox,{key:3,"model-value":e.selectedKeywords,options:e.filters.eventKeywords.map(l=>({label:`${l} (${e.countKeywordMatches(l)})`,value:l})),size:"small","onUpdate:modelValue":t[6]||(t[6]=l=>e.selectedKeywords=l)},null,8,["model-value","options"])):(o(),r("div",Ie,"None available for this event stream.")),e.userSearchActive||e.filtersActive?(o(),r("div",Ue,[i("span",Le,v(e.internalUtilitiesMode==="filter"?"Only showing":"Highlighting"),1),t[17]||(t[17]=g(" events that match the")),(o(!0),r(lt,null,ot(e.activeFilters,(l,U)=>(o(),r("span",{class:I({"tw-ml-1":U>0})},[U>0?(o(),r("span",Fe,v(e.internalUtilitiesCondition==="or"?"OR":"AND"),1)):y("",!0),g(" "+v(l),1)],2))),256)),t[18]||(t[18]=i("span",null,".",-1))])):y("",!0)],8,De)):y("",!0)],void 0,!0),_:1}),i("div",{class:"d-flex flex-column justify-content-between h-100",style:Lt(`max-height: ${s.maxHeight}; overflow-y: auto;`)},[i("div",null,[s.allowPausing?(o(),r("div",Oe,[at(i("span",null,[t[22]||(t[22]=g("Last update ")),h(S,{date:e.lastUpdated},null,8,["date"]),t[23]||(t[23]=g("."))],512),[[rt,!e.isPaused]]),at(i("span",null,[t[24]||(t[24]=g("Updates paused ")),h(S,{date:e.lastUpdated},null,8,["date"]),t[25]||(t[25]=g("."))],512),[[rt,e.isPaused]]),h(e.MTextButton,{onClick:e.togglePlayPauseState,"data-testid":"play-pause-button"},{default:k(()=>[g(v(e.isPaused?"Resume":"Pause")+" updates",1)],void 0,!0),_:1}),i("div",null,[e.updateAvailable?(o(),C(e.MBadge,{key:0,shape:"pill",variant:"primary"},{default:k(()=>t[26]||(t[26]=[g("New data available")]),void 0,!0),_:1})):y("",!0)])])):y("",!0),e.decoratedSearchedAndUnfoldedEventList.length>0?(o(),r("div",Ae,[(o(!0),r(lt,null,ot(e.decoratedSearchedAndUnfoldedEventList,(l,U)=>(o(),r("div",{class:"group","data-testid":e.dataTestIdFromEvent(l)},[(o(),C(M,{key:U,class:I(e.eventBackgroundClass(l)),placeholderEventHeight:50},{default:k(()=>[l.type==="Session"?(o(),r("div",{key:0,class:I(["card-manual-content-padding tw-flex clickable-list-group-item tw-py-3 tw-gap-2",{"group-open":l.decorations.isPathUnfolded}]),onClick:L=>e.toggleFoldedPath(l.path)},[h(u,{class:"tw-mt-1 tw-text-sm",icon:"angle-right"}),i("div",Ve,[i("div",ze,[i("div",null,[h(e.MTooltip,{class:"font-weight-bold",content:`Session ID: ${l.id}`,noUnderline:""},{default:k(()=>[g("Session #"+v(l.typeData.sessionNumber),1)],void 0,!0),_:2},1032,["content"]),i("span",Re,v(l.typeData.numEvents)+" events",1)]),i("div",je,[h(S,{date:l.typeData.startTime},null,8,["date"])])]),i("div",Ke,[i("div",Ge,v(l.typeData.deviceName),1),i("div",qe,[t[27]||(t[27]=g("Lasted for ")),h(O,{duration:l.typeData.duration},null,8,["duration"])])])])],10,Ne)):y("",!0),l.type==="Day"?(o(),r("div",{key:1,class:I(["card-manual-content-padding tw-flex clickable-list-group-item tw-py-3 tw-gap-2",{"group-open":l.decorations.isPathUnfolded}]),onClick:L=>e.toggleFoldedPath(l.path)},[h(u,{class:"tw-mt-1 tw-text-sm",icon:"angle-right"}),i("div",Ye,[i("div",Ze,[i("div",null,[h(S,{class:"font-weight-bold",date:l.typeData.date,showAs:"date"},null,8,["date"])]),i("div",Je,[h(S,{date:l.typeData.date},null,8,["date"])])]),i("div",Qe,v(l.typeData.numEvents)+" events",1)])],10,We)):l.type==="RepeatedEvents"?(o(),r("div",{key:2,class:I(["card-manual-content-padding clickable-list-group-item",{"group-open":l.decorations.isPathUnfolded}]),onClick:L=>e.toggleFoldedPath(l.path)},[(o(),r("div",{key:1,class:I(`${l.decorations.lineVariant!=="none"?"three":"two"}-column-layout`)},[i("div",$e,[l.decorations.isPathUnfolded?y("",!0):(o(),r("div",ts,[i("div",null,[h(S,{date:l.time,showAs:"time"},null,8,["date"])]),s.showTimeDeltas?(o(),r("div",es,[l.decorations.timeBetweenEvents?(o(),r("span",ss,[t[30]||(t[30]=g("+ ")),h(O,{duration:l.decorations.timeBetweenEvents,showAs:"top-two"},null,8,["duration"])])):(o(),r("span",ns,"Oldest event"))])):y("",!0)]))]),l.decorations.lineVariant!=="none"?(o(),r("div",is,[h(e.MetaEventStreamCardGroupLine,{variant:l.decorations.lineVariant},null,8,["variant"])])):y("",!0),i("div",ls,[l.decorations.isPathUnfolded?(o(),r("div",rs,[i("span",ds,[g(v(l.typeData.numEvents)+" repeating events. ",1),t[33]||(t[33]=i("span",{class:"tw-text-xs tw-text-blue-500 hover:tw-underline"},"Collapse",-1))])])):(o(),r("div",os,[h(u,{class:"mr-2",icon:"angle-right"}),i("span",null,[g(v(l.typeData.numEvents)+" x ",1),i("span",as,v(l.typeData.repeatedTitle),1),t[31]||(t[31]=g()),t[32]||(t[32]=i("span",{class:"tw-text-xs tw-text-blue-500 hover:tw-underline"},"Expand",-1))])]))])],2))],10,Xe)):l.type==="Event"?(o(),r("div",{key:3,class:I(["card-manual-content-padding",`${l.decorations.lineVariant!=="none"?"three":"two"}-column-layout`]),ref_for:!0,ref:"event-item"},[i("div",us,[i("div",null,[h(S,{date:l.time,showAs:"time"},null,8,["date"])]),s.showTimeDeltas?(o(),r("div",cs,[l.decorations.timeBetweenEvents?(o(),r("span",hs,[t[34]||(t[34]=g("+ ")),h(O,{duration:l.decorations.timeBetweenEvents,showAs:"top-two"},null,8,["duration"])])):(o(),r("span",ps,"Oldest event"))])):y("",!0)]),l.decorations.lineVariant!=="none"?(o(),r("div",ws,[h(e.MetaEventStreamCardGroupLine,{variant:l.decorations.lineVariant},null,8,["variant"])])):y("",!0),i("div",ms,[i("div",{class:"clickable-list-group-item d-flex rounded-sm py-1 pr-1",onClick:L=>e.toggleEventExpanded(l)},[(l.decorations.isEventExpandable,o(),r("div",{key:0,class:I({"not-collapsed":e.isEventExpanded(l)})},[h(u,{class:"tw-text-sm mx-2",icon:"angle-right"})],2)),i("div",gs,[i("div",vs,[i("div",null,[i("span",ys,v(l.typeData.title),1),i("span",xs,[l.typeData.author?(o(),C(A,{key:0,username:l.typeData.author},null,8,["username"])):y("",!0)])]),i("div",_s,[s.showViewMoreLink&&l.typeData.viewMoreLink?(o(),C(e.MTextButton,{key:0,to:l.typeData.viewMoreLink,"data-testid":"view-more-link"},{default:k(()=>[g("View "+v(l.typeData.viewMore),1)],void 0,!0),_:2},1032,["to"])):y("",!0)])]),i("div",bs,v(l.typeData.description),1)])],8,fs),h(Ft,{name:"collapse-transition"},{default:k(()=>[e.isEventExpanded(l)?(o(),r("div",ks,[Ot(m.$slots,"event-details",{event:l},()=>[i("pre",Es,[t[35]||(t[35]=i("div",{class:"tw-text-neutral-500"},"// raw_event_payload",-1)),i("div",Ss,v(l.typeData.sourceData),1)])],!0)])):y("",!0)],void 0,!0),_:2},1024)])],2)):y("",!0)],void 0,!0),_:2},1032,["class"]))],8,He))),256))])):(o(),r("div",Ds,v(s.noResultsMessage),1))])],4)])):(o(),C(E,{key:2,class:"tw-px-4 tw-text-center my-auto mb-4 pb-4","align-h":"center","no-gutters":""},{default:k(()=>[i("span",Ee,v(s.emptyMessage),1)],void 0,!0),_:1})):(o(),r("div",ke,[h(f,{width:"85%"}),h(f,{width:"55%"}),h(f,{width:"70%"}),h(f,{class:"tw-mt-4",width:"80%"}),h(f,{width:"65%"})])):(o(),r("div",be,[t[8]||(t[8]=g("You need the ")),h(e.MBadge,null,{default:k(()=>[g(v(s.permission),1)],void 0,!0),_:1}),t[9]||(t[9]=g(" permission to view this card."))]))],void 0,!0),_:3},8,["class"])}const Os=ct(ve,[["render",Ms],["__scopeId","data-v-288a9538"],["__file","MetaEventStreamCard.vue"]]);export{Z as E,Os as M,Is as a,Us as b,K as c,Fs as g,Ls as w};
