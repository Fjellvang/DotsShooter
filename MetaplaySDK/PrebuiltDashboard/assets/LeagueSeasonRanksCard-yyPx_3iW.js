import{d as j,ab as V,x as h,c as D,f as M,ad as N,L as z,v as U,a8 as q,a9 as H,b as I,o as c,a as C,e as R,w as d,k as o,n as b,p as n,t as f,l as J,F as K,_ as Q}from"./index-B7jvAjdE.js";import{M as W}from"./MActionModal-coQLkvWs.js";import{M as X}from"./MInputNumber-BOzPEn49.js";import{M as u,a as v}from"./metaListUtils-B-xQ0HnD.js";import{b as T}from"./leagues-DnPkib1L.js";import"./index-fVjXqxSF.js";import"./index-DZuvHjnn.js";import"./index-B_QkKjtG.js";import"./MInputHintMessage-DbuBS4Kn.js";const Y=j({__name:"LeagueSeasonRanksCard",props:{leagueId:{},seasonId:{}},setup(L,{expose:i}){i();const l=L,e=V(),y=N(),{data:S}=h(T(l.leagueId,l.seasonId)),r=D(()=>{const{ranks:m}=S.value;return m.map((s,P)=>{const w={name:s.rankName,description:s.description,id:P,totalParticipants:s.totalParticipants,totalDivisions:s.numDivisions};return S.value.isCurrent||(w.historicalData={numPromotions:s.numPromotions,numDemotions:s.numDemotions,numDropped:s.numDropped}),w})}),p=[new u("Rank","id",v.Descending),new u("Rank","id",v.Ascending),new u("Name","name",v.Ascending),new u("Name","name",v.Descending),new u("Participants","totalParticipants",v.Ascending),new u("Participants","totalParticipants",v.Descending)],a=M(),t=D(()=>{if(a.value!==void 0)return r.value[a.value].name}),k=M();function A(m){a.value=m,k.value?.open(m)}function O(){g.value=void 0}async function B(){a.value!==void 0&&g.value!==void 0&&await _(a.value,g.value)}const E=D(()=>r.value[a.value??0].totalDivisions),g=M(),F=D(()=>g.value!==void 0),_=async(m,s)=>{const w=(await y.get(`/divisions/id/${l.leagueId}/${l.seasonId}/${m}/${s}/`)).data,G=`/leagues/${l.leagueId}/${l.seasonId}/${w}`;await e.push(G)},x={props:l,router:e,gameServerApi:y,singleLeagueSeasonData:S,rankDisplayData:r,sortOptions:p,selectedRankId:a,selectedRankName:t,viewDivisionModal:k,onViewDivisionClick:A,onViewDivisionModalShow:O,onViewDivisionModalOk:B,divisionsInCurrentlySelectedRank:E,selectedDivision:g,selectedDivisionValid:F,viewDivision:_,computed:D,ref:M,get useRouter(){return V},get useGameServerApi(){return N},get MetaListSortDirection(){return v},get MetaListSortOption(){return u},get MActionModal(){return W},get MTooltip(){return z},get MListItem(){return U},get MInputNumber(){return X},get MTextButton(){return q},get maybePluralString(){return H},get useSubscription(){return h},get getSingleLeagueSeasonSubscriptionOptions(){return T}};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}}),Z={key:0},$={key:1};function ee(L,i,l,e,y,S){const r=I("meta-abbreviate-number"),p=I("meta-plural-label"),a=I("meta-list-card");return c(),C(K,null,[e.singleLeagueSeasonData?(c(),R(a,{key:0,title:"All Ranks",itemList:e.rankDisplayData,searchFields:["name","description"],sortOptions:e.sortOptions,pageSize:10,"data-testid":"league-season-ranks-card"},{"item-card":d(({item:t})=>[o(e.MListItem,null,{"top-right":d(()=>[b("span",null,[o(r,{value:t.totalParticipants},null,8,["value"]),i[1]||(i[1]=n()),o(p,{value:t.totalParticipants,label:"participant",hideCount:""},null,8,["value"])])]),"bottom-left":d(()=>[b("div",null,f(t.description),1),t.historicalData?(c(),C("div",Z,[o(r,{value:t.historicalData.numPromotions},null,8,["value"]),i[2]||(i[2]=n()),o(p,{value:t.historicalData.numPromotions,label:"promotion",hideCount:""},null,8,["value"]),i[3]||(i[3]=n(" | ")),o(r,{value:t.historicalData.numDemotions},null,8,["value"]),i[4]||(i[4]=n()),o(p,{value:t.historicalData.numDemotions,label:"demotion",hideCount:""},null,8,["value"]),i[5]||(i[5]=n(" | ")),o(r,{value:t.historicalData.numDropped},null,8,["value"]),i[6]||(i[6]=n(" dropped"))])):(c(),C("div",$,"Statistics not available yet."))]),"bottom-right":d(()=>[t.totalDivisions>0?(c(),R(e.MTextButton,{key:0,"disabled-tooltip":e.divisionsInCurrentlySelectedRank===0?"There are no divisions available to view for this rank.":void 0,onClick:k=>e.onViewDivisionClick(t.id),"data-testid":"view-division-button-"+t.id},{default:d(()=>[n(f(e.maybePluralString(t.totalDivisions,"division")),1)],void 0,!0),_:2},1032,["disabled-tooltip","onClick","data-testid"])):(c(),R(e.MTooltip,{key:1,content:"There are no divisions available to view for this rank."},{default:d(()=>i[7]||(i[7]=[n("View division")]),void 0,!0),_:1}))]),default:d(()=>[n(f(t.name),1)],void 0,!0),_:2},1024)]),_:1},8,["itemList"])):J("",!0),o(e.MActionModal,{ref:"viewDivisionModal",title:"View Division",action:e.onViewDivisionModalOk,"ok-button-label":"View Division","ok-button-disabled-tooltip":e.selectedDivisionValid?void 0:"Select a division to view.","disable-safety-lock":"",onShow:e.onViewDivisionModalShow,"data-testid":"view-division-modal"+e.selectedRankId},{default:d(()=>[b("div",null,[i[8]||(i[8]=n("Select a division to view from ")),b("strong",null,f(e.selectedRankName),1),i[9]||(i[9]=n(" of ")),b("strong",null,f(e.singleLeagueSeasonData.displayName),1),o(e.MInputNumber,{label:"Division Index","model-value":e.selectedDivision,placeholder:"Enter division index...",min:0,max:e.divisionsInCurrentlySelectedRank-1,"hint-message":e.divisionsInCurrentlySelectedRank===1?"There is only one division available in this rank, with the index 0.":`There are a total of ${e.divisionsInCurrentlySelectedRank} divisions available, indexed from 0 to ${e.divisionsInCurrentlySelectedRank-1}.`,"onUpdate:modelValue":i[0]||(i[0]=t=>e.selectedDivision=t),"data-testid":"division-index-input"+e.selectedRankId},null,8,["model-value","max","hint-message","data-testid"])])],void 0,!0),_:1},8,["ok-button-disabled-tooltip","data-testid"])],64)}const ue=Q(Y,[["render",ee],["__file","LeagueSeasonRanksCard.vue"]]);export{ue as default};
