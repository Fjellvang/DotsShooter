import{ar as W,as as J,ay as u,dJ as Y,dU as x,aP as $,at as Q,au as X,aK as ee,aE as f,aN as V,aO as te,aS as U,d as re,an as S,c as F,h as _,ao as P,ap as N,aq as A,o as w,a as E,$ as C,t as v,l as ie,n as y,b7 as z,b8 as k,m as O,b4 as ae,k as ne,w as le,p as oe,_ as se}from"./index-B7jvAjdE.js";import{M as de}from"./MInputHintMessage-DbuBS4Kn.js";function ce(e){const i=new Map;return function(r,n){const o=r+(n?Object.entries(n).sort((d,a)=>d[0]<a[0]?-1:1).join():"");if(i.has(o))return i.get(o);let s=new e(r,n);return i.set(o,s),s}}var ue=ce(Intl.NumberFormat);function pe(e,i,t={}){return ue(i,t).format(e)}var ge=["","kilo","mega","giga","tera"],fe=["","kilo","mega","giga","tera","peta"],me=(e,i="en-US",t={})=>{if(isNaN(e))return"";if(e===0)return"0 B";const{unit:r="byte",unitDisplay:n="short"}=t,o=r==="bit"?ge:fe,s=Math.max(0,Math.min(Math.floor(Math.log10(e)/3),o.length-1)),d=o[s]+r,a=n||"short",l=parseFloat((e/Math.pow(1e3,s)).toPrecision(3));return pe(l,i,{style:"unit",unit:d,unitDisplay:a})};function Fe(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function we(e){return/^.*\.[\w]+$/.test(e)}var M=e=>Fe(e)||we(e);function Ee(e){if(e)return typeof e=="string"?e:Array.isArray(e)?e.filter(M).join(","):Object.entries(e).reduce((i,[t,r])=>[...i,t,...r],[]).filter(M).join(",")}var be=(e,i)=>e.name===i.name&&e.size===i.size&&e.type===i.type,I=e=>e!=null;function Ie(e,i,t){if(I(e.size))if(I(i)&&I(t)){if(e.size>t)return[!1,"FILE_TOO_LARGE"];if(e.size<i)return[!1,"FILE_TOO_SMALL"]}else{if(I(i)&&e.size<i)return[!1,"FILE_TOO_SMALL"];if(I(t)&&e.size>t)return[!1,"FILE_TOO_LARGE"]}return[!0,null]}function ve(e,i){if(e&&i){const t=Array.isArray(i)?i:i.split(","),r=e.name||"",n=(e.type||"").toLowerCase(),o=n.replace(/\/.*$/,"");return t.some(s=>{const d=s.trim().toLowerCase();return d.charAt(0)==="."?r.toLowerCase().endsWith(d):d.endsWith("/*")?o===d.replace(/\/.*$/,""):n===d})}return!0}function he(e,i){const t=e.type==="application/x-moz-file"||ve(e,i);return[t,t?null:"FILE_INVALID_TYPE"]}var Z=W("file-upload").parts("root","dropzone","item","itemDeleteTrigger","itemGroup","itemName","itemPreview","itemPreviewImage","itemSizeText","label","trigger","clearTrigger"),p=Z.build(),c=J({getRootId:e=>e.ids?.root??`file:${e.id}`,getDropzoneId:e=>e.ids?.dropzone??`file:${e.id}:dropzone`,getHiddenInputId:e=>e.ids?.hiddenInput??`file:${e.id}:input`,getTriggerId:e=>e.ids?.trigger??`file:${e.id}:trigger`,getLabelId:e=>e.ids?.label??`file:${e.id}:label`,getItemId:(e,i)=>e.ids?.item?.(i)??`file:${e.id}:item:${i}`,getItemNameId:(e,i)=>e.ids?.itemName?.(i)??`file:${e.id}:item-name:${i}`,getItemSizeTextId:(e,i)=>e.ids?.itemSizeText?.(i)??`file:${e.id}:item-size:${i}`,getItemPreviewId:(e,i)=>e.ids?.itemPreview?.(i)??`file:${e.id}:item-preview:${i}`,getHiddenInputEl:e=>c.getById(e,c.getHiddenInputId(e)),getDropzoneEl:e=>c.getById(e,c.getDropzoneId(e))});function j(e){const i=te(e);return e.dataTransfer?e.dataTransfer.types.some(t=>t==="Files"||t==="application/x-moz-file"):!!i&&"files"in i}function Pe(e,i){return!e.multiple&&i>1?!1:!e.multiple&&i+e.acceptedFiles.length===2?!0:!(i+e.acceptedFiles.length>e.maxFiles)}function ye(e,i){const t=[],r=[];return i.forEach(n=>{const[o,s]=he(n,e.acceptAttr),[d,a]=Ie(n,e.minFileSize,e.maxFileSize),l=e.validate?.(n),g=l?l.length===0:!0;if(o&&d&&g)t.push(n);else{const m=[s,a];g||m.push(...l??[]),r.push({file:n,errors:m.filter(Boolean)})}}),Pe(e,t.length)||(t.forEach(n=>{r.push({file:n,errors:["TOO_MANY_FILES"]})}),t.splice(0)),{acceptedFiles:t,rejectedFiles:r}}function B(e,i,t){const r=e.context.disabled,n=e.context.allowDrop,o=e.context.translations,s=e.matches("dragging"),d=e.matches("focused")&&!r;return{dragging:s,focused:d,openFilePicker(){i("OPEN")},deleteFile(a){i({type:"FILE.DELETE",file:a})},acceptedFiles:e.context.acceptedFiles,rejectedFiles:e.context.rejectedFiles,setFiles(a){const l=a.length;i({type:"FILES.SET",files:a,count:l})},clearRejectedFiles(){i({type:"REJECTED_FILES.CLEAR"})},clearFiles(){i({type:"FILES.CLEAR"})},getFileSize(a){return me(a.size,e.context.locale)},createFileUrl(a,l){const g=c.getWin(e.context),m=g.URL.createObjectURL(a);return l(m),()=>g.URL.revokeObjectURL(m)},getRootProps(){return t.element({...p.root.attrs,dir:e.context.dir,id:c.getRootId(e.context),"data-disabled":u(r),"data-dragging":u(s)})},getDropzoneProps(){return t.element({...p.dropzone.attrs,dir:e.context.dir,id:c.getDropzoneId(e.context),tabIndex:r?void 0:0,role:"button","aria-label":o.dropzone,"aria-disabled":r,"data-invalid":u(e.context.invalid),"data-disabled":u(r),"data-dragging":u(s),onKeyDown(a){a.defaultPrevented||Y(a)&&(a.key!=="Enter"&&a.key!==" "||i({type:"DROPZONE.CLICK",src:"keydown"}))},onClick(a){a.currentTarget.localName==="label"&&a.preventDefault(),i("DROPZONE.CLICK")},onDragOver(a){if(!n)return;a.preventDefault(),a.stopPropagation();try{a.dataTransfer.dropEffect="copy"}catch{}if(!j(a))return;const g=a.dataTransfer.items.length;i({type:"DROPZONE.DRAG_OVER",count:g})},onDragLeave(a){!n||r||x(a.currentTarget,a.relatedTarget)||i({type:"DROPZONE.DRAG_LEAVE"})},onDrop(a){n&&(a.preventDefault(),a.stopPropagation());const l=j(a);r||!l||i({type:"DROPZONE.DROP",files:Array.from(a.dataTransfer.files)})},onFocus(){i("DROPZONE.FOCUS")},onBlur(){i("DROPZONE.BLUR")}})},getTriggerProps(){return t.button({...p.trigger.attrs,dir:e.context.dir,id:c.getTriggerId(e.context),disabled:r,"data-disabled":u(r),"data-invalid":u(e.context.invalid),type:"button",onClick(a){r||(x(c.getDropzoneEl(e.context),a.currentTarget)&&a.stopPropagation(),i("OPEN"))}})},getHiddenInputProps(){return t.input({id:c.getHiddenInputId(e.context),tabIndex:-1,disabled:r,type:"file",required:e.context.required,capture:e.context.capture,name:e.context.name,accept:e.context.acceptAttr,webkitdirectory:e.context.directory?"":void 0,multiple:e.context.multiple||e.context.maxFiles>1,onClick(a){a.stopPropagation(),a.currentTarget.value=""},onChange(a){if(r)return;const{files:l}=a.currentTarget;i({type:"FILES.SET",files:l?Array.from(l):[]})},style:$})},getItemGroupProps(){return t.element({...p.itemGroup.attrs,dir:e.context.dir,"data-disabled":u(r)})},getItemProps(a){const{file:l}=a;return t.element({...p.item.attrs,dir:e.context.dir,id:c.getItemId(e.context,l.name),"data-disabled":u(r)})},getItemNameProps(a){const{file:l}=a;return t.element({...p.itemName.attrs,dir:e.context.dir,id:c.getItemNameId(e.context,l.name),"data-disabled":u(r)})},getItemSizeTextProps(a){const{file:l}=a;return t.element({...p.itemSizeText.attrs,dir:e.context.dir,id:c.getItemSizeTextId(e.context,l.name),"data-disabled":u(r)})},getItemPreviewProps(a){const{file:l}=a;return t.element({...p.itemPreview.attrs,dir:e.context.dir,id:c.getItemPreviewId(e.context,l.name),"data-disabled":u(r)})},getItemPreviewImageProps(a){const{file:l,url:g}=a;if(!l.type.startsWith("image/"))throw new Error("Preview Image is only supported for image files");return t.img({...p.itemPreviewImage.attrs,alt:o.itemPreview?.(l),src:g,"data-disabled":u(r)})},getItemDeleteTriggerProps(a){const{file:l}=a;return t.button({...p.itemDeleteTrigger.attrs,dir:e.context.dir,type:"button",disabled:r,"data-disabled":u(r),"aria-label":o.deleteFile?.(l),onClick(){r||i({type:"FILE.DELETE",file:l})}})},getLabelProps(){return t.label({...p.label.attrs,dir:e.context.dir,id:c.getLabelId(e.context),htmlFor:c.getHiddenInputId(e.context),"data-disabled":u(r)})},getClearTriggerProps(){return t.button({...p.clearTrigger.attrs,dir:e.context.dir,type:"button",disabled:r,hidden:e.context.acceptedFiles.length===0,"data-disabled":u(r),onClick(a){a.defaultPrevented||r||i({type:"FILES.CLEAR"})}})}}}function H(e){const i=Q(e);return X({id:"fileupload",initial:"idle",context:{minFileSize:0,maxFileSize:1/0,maxFiles:1,allowDrop:!0,...i,acceptedFiles:f([]),rejectedFiles:f([]),translations:{dropzone:"dropzone",itemPreview:t=>`preview of ${t.name}`,deleteFile:t=>`delete file ${t.name}`,...i.translations}},computed:{acceptAttr:t=>Ee(t.accept),multiple:t=>t.maxFiles>1},on:{"FILES.SET":{actions:["setFilesFromEvent"]},"FILE.DELETE":{actions:["removeFile"]},"FILES.CLEAR":{actions:["clearFiles"]},"REJECTED_FILES.CLEAR":{actions:["clearRejectedFiles"]}},states:{idle:{on:{OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.FOCUS":"focused","DROPZONE.DRAG_OVER":{target:"dragging"}}},focused:{on:{"DROPZONE.BLUR":"idle",OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.DRAG_OVER":{target:"dragging"}}},dragging:{on:{"DROPZONE.DROP":{target:"idle",actions:["setFilesFromEvent","syncInputElement"]},"DROPZONE.DRAG_LEAVE":{target:"idle"}}}}},{actions:{syncInputElement(t){const r=c.getHiddenInputEl(t);if(!r)return;const n=c.getWin(t),o=new n.DataTransfer;t.acceptedFiles.forEach(s=>{o.items.add(s)}),r.files=o.files},openFilePicker(t){ee(()=>{c.getHiddenInputEl(t)?.click()})},setFilesFromEvent(t,r){const n=ye(t,r.files),{acceptedFiles:o,rejectedFiles:s}=n;if(t.multiple){const d=f([...t.acceptedFiles,...o]);D.files(t,d,s);return}if(o.length){const d=f([o[0]]);D.files(t,d,s)}else s.length&&D.files(t,t.acceptedFiles,s)},removeFile(t,r){const n=t.acceptedFiles.filter(o=>o!==r.file);t.acceptedFiles=f(n),b.change(t)},clearRejectedFiles(t){t.rejectedFiles=f([]),b.change(t)},clearFiles(t){t.acceptedFiles=f([]),t.rejectedFiles=f([]),b.change(t)}},compareFns:{acceptedFiles:(t,r)=>t.length===r.length&&t.every((n,o)=>be(n,r[o]))}})}var b={change:e=>{e.onFileChange?.({acceptedFiles:e.acceptedFiles,rejectedFiles:e.rejectedFiles})},accept:e=>{e.onFileAccept?.({files:e.acceptedFiles})},reject:e=>{e.onFileReject?.({files:e.rejectedFiles})}},D={files:(e,i,t)=>{e.acceptedFiles=f(i),b.accept(e),t&&(e.rejectedFiles=f(t),b.reject(e)),b.change(e)}},G=V()(["accept","allowDrop","capture","dir","directory","disabled","getRootNode","id","ids","locale","maxFiles","maxFileSize","minFileSize","name","invalid","onFileAccept","onFileReject","onFileChange","required","translations","validate"]),Oe=U(G),K=V()(["file"]),De=U(K);const Le=Object.freeze(Object.defineProperty({__proto__:null,anatomy:Z,connect:B,itemProps:K,machine:H,props:G,splitItemProps:De,splitProps:Oe},Symbol.toStringTag,{value:"Module"})),Te=re({inheritAttrs:!1,__name:"MInputSingleFile",props:{modelValue:{default:void 0},validationFunction:{type:Function,default:void 0},minFileSize:{default:void 0},maxFileSize:{default:void 0},label:{default:void 0},disabled:{type:Boolean},variant:{default:"default"},hintMessage:{default:void 0},placeholder:{default:void 0},acceptedFileTypes:{default:void 0}},emits:["update:modelValue"],setup(e,{expose:i,emit:t}){i();const r=e,{internalDisabled:n}=S(F(()=>r.disabled)),o=t;_(()=>{r.modelValue&&o("update:modelValue",void 0)});const s=P("file-input"),d=P("file-input-hint"),a=F(()=>{if(n.value)return"tw-bg-neutral-50 tw-ring-neutral-200 tw-cursor-not-allowed";switch(r.variant){case"danger":return"tw-cursor-pointer tw-ring-red-400";case"success":return"tw-cursor-pointer tw-ring-green-500";default:return"tw-cursor-pointer tw-ring-neutral-300"}}),l=F(()=>{if(n.value)return"tw-text-neutral-400";switch(r.variant){case"danger":return"tw-text-red-400";case"success":return"tw-text-green-500";default:return"tw-text-neutral-400"}});function g(){h.value.deleteFile(h.value.acceptedFiles[0]),o("update:modelValue",void 0)}const m=F(()=>({disabled:n.value,validate:r.validationFunction,accept:r.acceptedFileTypes,minFileSize:r.minFileSize,maxFileSize:r.maxFileSize})),[L,T]=N(H({id:s,maxFiles:1,accept:r.acceptedFileTypes,onFileAccept:q=>{o("update:modelValue",q.files[0])}}),{context:m}),h=F(()=>B(L.value,T,A)),R={props:r,internalDisabled:n,emit:o,id:s,hintId:d,containerVariantClasses:a,placeholderLabelVariantClasses:l,removeFile:g,transientContext:m,state:L,send:T,api:h,computed:F,onMounted:_,get makeIntoUniqueKey(){return P},get fileUpload(){return Le},get normalizeProps(){return A},get useMachine(){return N},get useEnableAfterSsr(){return S},MInputHintMessage:de};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}}),Re=["for"],xe={class:"tw-px-3"},Se=["disabled"];function _e(e,i,t,r,n,o){return w(),E("div",z(k(r.api.getRootProps())),[t.label?(w(),E("label",{key:0,for:r.id,class:C(["tw-block tw-text-sm tw-font-bold tw-leading-6 tw-mb-1",{"tw-text-neutral-400":r.internalDisabled,"tw-text-neutral-900":!r.internalDisabled}])},v(t.label),11,Re)):ie("",!0),y("div",O({...e.$attrs,...r.api.getDropzoneProps()},{class:["tw-w-full tw-rounded-md tw-shadow-sm tw-border-0 tw-py-1.5 tw-text-neutral-900 tw-ring-1 tw-ring-inset placeholder:tw-text-neutral-400 focus:tw-ring-2 focus:tw-ring-inset focus:tw-ring-blue-600 sm:tw-text-sm sm:tw-leading-6 disabled:tw-cursor-not-allowed disabled:tw-bg-neutral-50 disabled:tw-text-neutral-500 disabled:ring-neutral-200 tw-select-none tw-flex tw-justify-between",r.containerVariantClasses]}),[y("input",z(k(r.api.getHiddenInputProps())),null,16),y("div",xe,[r.api.acceptedFiles.length?(w(),E("span",O({key:1},r.api.getItemNameProps({file:r.api.acceptedFiles[0]}),{class:{"tw-text-red-500":t.variant==="danger"}}),v(r.api.acceptedFiles[0].name),17)):(w(),E("span",{key:0,class:C(r.placeholderLabelVariantClasses)},v(t.placeholder??"Drag your file here"),3))]),r.api.acceptedFiles.length?(w(),E("button",{key:1,class:"tw-mr-2 tw-rounded tw-bg-neutral-200 tw-px-2 hover:tw-bg-neutral-300 active:tw-bg-neutral-400",onClick:i[0]||(i[0]=ae(s=>r.removeFile(),["stop"]))},"Remove")):(w(),E("button",O({key:0},r.api.getTriggerProps(),{class:"tw-mr-2 tw-rounded tw-bg-neutral-200 tw-px-2 hover:tw-bg-neutral-300 active:tw-bg-neutral-400 disabled:tw-bg-neutral-100 disabled:tw-text-neutral-500"},{disabled:t.disabled}),"Browse",16,Se))],16),ne(r.MInputHintMessage,{id:r.hintId,variant:t.variant},{default:le(()=>[oe(v(t.hintMessage),1)],void 0,!0),_:1},8,["id","variant"])],16)}const Ce=se(Te,[["render",_e],["__file","MInputSingleFile.vue"]]);export{Ce as M};
