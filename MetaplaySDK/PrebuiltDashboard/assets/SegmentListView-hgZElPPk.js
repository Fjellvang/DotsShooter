import{d as C,x as S,cn as v,c as g,v as E,a8 as P,b as w,o as M,e as x,w as n,k as s,n as m,p as a,a as b,t as d,l as z,_ as L}from"./index-B7jvAjdE.js";import{M as h,a as D}from"./MViewContainer-BTeE2xDT.js";import{M as V}from"./MSingleColumnLayout-B4K0ZAFA.js";import{M as l,a as u}from"./metaListUtils-B-xQ0HnD.js";import{M as N}from"./MetaAudienceSizeEstimate-CCTh_xY2.js";const O=C({__name:"SegmentListView",setup(_,{expose:e}){e();const{data:r,error:t}=S(v()),c=g(()=>r.value?.segments),f=[l.asUnsorted(),new l("Name","info.displayName",u.Ascending),new l("Name","info.displayName",u.Descending),new l("Audience Size Estimate","sizeEstimate",u.Ascending),new l("Audience Size Estimate","sizeEstimate",u.Descending)],i=g(()=>r.value?.playerScanErrorCount&&r.value?.scannedPlayersCount?r.value?.playerScanErrorCount/r.value?.scannedPlayersCount*100:0),p=g(()=>{const y=[];return i.value>5&&y.push({variant:"warning",title:`Warning: ${i.value.toFixed(2)}% errors encountered`,message:`The segment size estimator encountered ${i.value.toFixed(2)}% error rate while scanning for players (${r.value?.playerScanErrorCount} out of ${r.value?.scannedPlayersCount} players). This can affect the accuracy of the segment size estimates. See the server logs for more information.`}),y}),o={playerSegmentsData:r,playerSegmentsError:t,allPlayerSegments:c,sortOptions:f,segmentSizeEstimatorErrorRate:i,alerts:p,computed:g,get MetaListSortDirection(){return u},get MetaListSortOption(){return l},get MListItem(){return E},get MPageOverviewCard(){return h},get MSingleColumnLayout(){return V},get MTextButton(){return P},get MViewContainer(){return D},get useSubscription(){return S},MetaAudienceSizeEstimate:N,get getPlayerSegmentsSubscriptionOptions(){return v}};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}}),A={class:"small text-muted"},B={key:0,class:"small text-muted"},T={class:"font-weight-bold"},k={class:"font-weight-bold"},F={class:"font-weight-bold"};function I(_,e,r,t,c,f){const i=w("meta-list-card"),p=w("meta-raw-data");return M(),x(t.MViewContainer,{permission:"api.segmentation.view","is-loading":!t.playerSegmentsData,error:t.playerSegmentsError,alerts:t.alerts},{overview:n(()=>[s(t.MPageOverviewCard,{title:"View Player Segments","data-testid":"player-segment-list-overview-card"},{default:n(()=>[e[7]||(e[7]=m("p",{class:"tw-mb-1"},"Player segments are dynamic sets of players based on their game state.",-1)),m("p",A,[e[1]||(e[1]=a("Players can enter and leave segments as their play the game and belong to multiple segments at once. You can define your own properties to segment players with and then create the actual segments in your ")),s(t.MTextButton,{to:"/gameConfigs"},{default:n(()=>e[0]||(e[0]=[a("game configs")]),void 0,!0),_:1}),e[2]||(e[2]=a("."))]),t.playerSegmentsData.playerScanErrorCount&&t.playerSegmentsData.playerScanErrorCount>0?(M(),b("p",B,[e[3]||(e[3]=a("The segment size estimator encountered (")),m("span",T,d(t.segmentSizeEstimatorErrorRate?.toFixed(2)||0),1),e[4]||(e[4]=a(")% error rate while scanning for players (")),m("span",k,d(t.playerSegmentsData.playerScanErrorCount||0),1),e[5]||(e[5]=a(" out of ")),m("span",F,d(t.playerSegmentsData.scannedPlayersCount||0),1),e[6]||(e[6]=a(" players scanned). See the server logs for more information."))])):z("",!0)],void 0,!0),_:1})]),default:n(()=>[s(t.MSingleColumnLayout,null,{default:n(()=>[s(i,{title:"All Segments",itemList:t.allPlayerSegments,searchFields:["info.displayName","info.description"],sortOptions:t.sortOptions,pageSize:20,emptyMessage:"No player segments. Set them up in your game configs to start using the feature!","data-testid":"player-segment-list-all-segments-card"},{"item-card":n(({item:o})=>[s(t.MListItem,null,{"top-right":n(()=>[s(t.MetaAudienceSizeEstimate,{sizeEstimate:o.sizeEstimate},null,8,["sizeEstimate"])]),"bottom-left":n(()=>[a(d(o.info.description),1)]),"bottom-right":n(()=>[s(t.MTextButton,{to:`/segments/${o.info.segmentId}`,"data-testid":"view-segment"},{default:n(()=>e[8]||(e[8]=[a("View segment")]),void 0,!0),_:2},1032,["to"])]),default:n(()=>[a(d(o.info.displayName),1)],void 0,!0),_:2},1024)]),_:1},8,["itemList"])],void 0,!0),_:1}),s(p,{kvPair:t.playerSegmentsData.segments,name:"segments"},null,8,["kvPair"])],void 0,!0),_:1},8,["is-loading","error","alerts"])}const q=L(O,[["render",I],["__file","SegmentListView.vue"]]);export{q as default};
